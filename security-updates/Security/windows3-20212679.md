---
TOCTitle: 'Фундаментальное руководство по расследованию компьютерных происшествий для Windows. Глава 3: Анализ данных'
Title: 'Фундаментальное руководство по расследованию компьютерных происшествий для Windows. Глава 3: Анализ данных'
ms:assetid: 'ac7d2cc4-6cd9-4525-898c-613cf8a53fd6'
ms:contentKeyID: 20212679
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc162856(v=TechNet.10)'
---

Фундаментальное руководство по расследованию компьютерных происшествий для Windows
==================================================================================

### Глава 3: Анализ данных

Опубликовано 11 января 2007

В этой главе обсуждаются различные подходы и общепринятые приемы анализа доказательств, собранных на этапе сбора данных внутреннего расследования. Этот процесс разделяется на три этапа, как это показано на рисунке ниже.

![](/security-updates/images/Cc162856.3418ca95-8ff6-443f-9690-d85ed84a0e98(ru-ru,TechNet.10).gif)

**Рис. 3.1. Этап анализа данных расследования компьютерных происшествий**

![](/security-updates/images/Cc162856.important(ru-ru,TechNet.10).gif) **Важно!**

Зачастую возникает необходимость в оперативном анализе данных, при котором компьютер исследуется непосредственно в процессе его работы. Как правило, к оперативному анализу прибегают, если расследование необходимо провести в сжатые сроки, или же для анализа переменных данных. При проведении оперативного анализа следует проявлять максимальную осторожность, с тем, чтобы не повредить прочие доказательства.

##### На этой странице

[](#edaa)[Анализ данных сети](#edaa)
[](#ecaa)[Анализ данных узла](#ecaa)
[](#ebaa)[Анализ хранилищ](#ebaa)

### Анализ данных сети

Анализ данных сети при расследовании нужен не всегда. Чаще основное внимание уделяется исследованию образов данных. В тех случаях, когда анализ данных сети необходим, следует придерживаться следующей процедуры.

1.  Поиск интересующих записей в журналах событий сетевых служб. Как правило, это подразумевает обзор значительных объемов данных, поэтому в таких случаях следует сосредоточиться на поиске событий по конкретному критерию, например имени пользователя, дате и времени или названии ресурса, к которому происходило обращение.

2.  Исследование журналов служб брандмауэра, прокси-сервера, системы обнаружения вторжения и удаленного доступа. Во многих из этих журналов содержится информация мониторинга входящих и исходящих соединений и присутствуют данные для идентификации, такие, как IP-адрес, время события и сведения, относящиеся к проверке подлинности. Иногда удобнее исследовать данные журналов событий в соответствующем инструменте анализа данных, к примеру, в Microsoft® SQL Server™ 2005.

3.  Поиск данных, которые могут оказаться полезными для определения действий, имевших место в сети, в журналах анализатора пакетов или сетевого монитора. Кроме того, следует определить, не являются ли соединения, подлежащие исследованию, зашифрованными — данные зашифрованных сеансов прочитать не удастся. Тем не менее, даже и в таких случаях можно определить время соединения и тот факт, что подозреваемый установил соединение с конкретным сервером.

[](#mainsection)[К началу страницы](#mainsection)

### Анализ данных узла

К данным узла относятся сведения о таких компонентах, как операционная система и приложения. При анализе копии данных узла, полученной на этапе сбора данных, следует придерживаться следующей процедуры.

1.  Определение объекта поиска. Как правило, для данных узла характерны большие объемы, при этом отношение к расследуемому происшествию может иметь лишь часть этих данных. Поэтому следует попытаться определить критерий поиска интересующих событий. Например, для поиска в файлах в папке \\Windows\\Prefetch можно использовать средство Microsoft Windows® Sysinternals Strings. В данной папке находится информация о времени и месте запуска приложений. Сведения об использовании средства Strings и направлении вывода результатов в текстовый файл см. в [главе 5: Пример практического сценария](https://technet.microsoft.com/ru-ru/library/959c31cd-216b-47fe-b821-7bb40d4156ae(v=TechNet.10)) настоящего руководства.

2.  Исследование данных операционной системы, в том числе отклонения системного времени и данных в оперативной памяти узла, с целью определения, не запущены ли какие-либо вредоносные программы или процессы и не запланирован ли их запуск. Например, средство Windows Sysinternals AutoRuns можно использовать для отображения списка программ, запускающихся в процессе загрузки или входа в систему.

3.  Исследование запущенных приложений, процессов и сетевых соединений. Например, можно произвести поиск выполняющихся процессов, имеющих соответствующие имена, но запущенных из нестандартных местоположений. Для выполнения таких задач следует использовать такие средства, как Windows Sysinternals ProcessExplorer, LogonSession и PSFile. Сведения об этих средствах см. в разделе «Инструменты» [приложения Ресурсы](https://technet.microsoft.com/ru-ru/library/a9a5c2a9-cce3-4edb-a92c-10983899240a(v=TechNet.10)) настоящего руководства.

[](#mainsection)[К началу страницы](#mainsection)

### Анализ хранилищ

На носителях хранилищ, собранных на этапе сбора данных, будет находиться множество файлов. Чтобы определить, имеют ли эти файлы отношение к расследуемому происшествию, их необходимо проанализировать, а это может оказаться непростой задачей, так как носители хранилищ, такие, как жесткие диски и ленточные накопители зачастую содержат сотни тысяч файлов.

Вначале следует определить файлы, имеющие отношение к происшествию, а затем подвергнуть их более тщательному анализу. Для извлечения и анализа данных с носителей собранной информации следует придерживаться следующей процедуры.

1.  При возможности следует провести автономный анализ побитовой копии исходных доказательств.

2.  Выяснить, использовалось ли шифрование данных, например шифрованной файловой системы (EFS) в Microsoft Windows. Чтобы определить, использовалась ли когда-либо на данном компьютере файловая система EFS, следует обратиться к нескольким ключам реестра. Список конкретных ключей реестра см. в разделе «Determining If EFS is Being Used on a Machine (Определение факта использования на компьютере файловой системы EFS)» в статье «[Encrypting File System in Windows XP and Windows Server 2003 (Шифрованная файловая система в операционных системах Windows XP и Windows Server 2003](http://www.microsoft.com/technet/prodtechnol/winxppro/deploy/cryptfs.mspx)"» на веб-узле Microsoft TechNet. Если возникают подозрения, что шифрование данных все же применялось, следует определить, возможно ли восстановить и прочитать зашифрованные данные. Это зависит от ряда обстоятельств, в том числе от версии Windows и от того, подключен ли данный компьютер к домену и каким образом файловая система EFS была развернута. Более подробные сведения о файловой системе EFS см. в статье «[The Encrypting File System (Шифрованная файловая система)](http://www.microsoft.com/technet/security/guidance/cryptographyetc/efs.mspx)» на веб-узле Microsoft TechNet. Существуют также сторонние средства восстановления файловой системы EFS, например [Advanced EFS Data Recovery](http://www.elcomsoft.com/aefsdr.html) компании Elcomsoft.

3.  Распаковать, в случае необходимости, все сжатые файлы и архивы. Несмотря на то, что большинство приложений для расследования происшествий могут считывать сжатые файлы с образов дисков, для исследования всех файлов на анализируемом носителе может возникнуть необходимость распаковать файлы архивов.

4.  Создать схему структуры каталогов. Иногда для эффективного анализа файлов может оказаться удобным создать графическое представление структуры каталогов и файлов.

5.  Определить файлы, представляющие интерес. Если известно, на какие именно файлы повлияло данное нарушение безопасности, основное внимание при расследовании можно в первую очередь уделить этим файлам. Для сравнения известных файлов (например, файлов операционной системы и приложений) с их исходными версиями можно использовать наборы хэшей, созданные [Национальной библиотекой программного обеспечения](http://www.nsrl.nist.gov/). Как правило, можно исключить из расследования файлы, не отличающиеся от исходных версий. Для поиска сведений о систематизации и сборе сведений о существующих форматах файлов, а также для определения форматов файлов, можно также воспользоваться следующими информационными веб-узлами [filext.com](http://filext.com/), [Wotsit's Format](http://www.wotsit.org/), [ProcessLibrary.com](http://www.processlibrary.com/) и веб-узлом корпорации Майкрософт [DLL Help](http://support.microsoft.com/dllhelp/default.aspx).

6.  Произвести поиск сведений о процессе загрузки компьютера, установленных приложениях (включая те из них, которые загружаются при включении компьютера), а также сведений о входе в систему, включая имя пользователя и домен, в реестре — базе данных, содержащей сведения о конфигурации Windows. Сведения о реестре и подробное описание его содержимого см. в статье [Windows Server 2003 Resource Kit Registry Reference (Справочник по реестру Windows Server 2003 Resource Kit)](http://technet2.microsoft.com/windowsserver/en/library/56a33a88-a7b2-4f21-ab5e-5c62d728619f1033.mspx?mfr=true). Для анализа данных реестра применяются различные инструменты, в том числе поставляемое с операционной системой Windows средство RegEdit, а также средства [Windows Sysinternals RegMon для Windows](http://go.microsoft.com/?linkid=6013256) и [Registry Viewer](http://www.accessdata.com/products/) от компании AccessData.

7.  Провести поиск в содержимом всех собранных файлов с целью определения файлов, представляющих интерес для расследования. Для расширенного поиска с возможностью выбора параметров можно воспользоваться инструментами, описанными в разделе «Инструменты» в [приложении Ресурсы](https://technet.microsoft.com/ru-ru/library/a9a5c2a9-cce3-4edb-a92c-10983899240a(v=TechNet.10)) настоящего руководства. Например, инструмент Windows Sysinternals Streams можно использовать, чтобы выяснить, используются ли для файлов или папок альтернативные потоки данных NTFS. С помощью альтернативных потоков NTFS в файлах может быть сокрыта информация таким образом, что при просмотре этих файлов с помощью проводника Windows будет создаваться видимость нулевого размера файла, несмотря на то, что в действительности в данном файле содержаться скрытые данные.

8.  Изучить метаданные файлов, представляющих интерес для расследования, используя такие инструменты, как Encase компании [Guidance Software](http://www.guidancesoftware.com/), The Forensic Toolkit (FTK) компании [AccessData](http://www.accessdata.com/) и ProDiscover компании [Technology Pathways](http://www.techpathways.com/). Зачастую при расследовании происшествия может быть полезна информация, хранящаяся в атрибутах файлов, например время создания, последнего доступа и последнего изменения.

9.  Чтобы просматривать содержимое определенных типов файлов без исходных приложений, в которых эти файлы были созданы, следует применять программы просмотра файлов конкретного типа. Таким образом обеспечивается защита файлов от случайного повреждения, к тому же это зачастую требует меньших затрат, чем использование исходных приложений. Следует иметь в виду, что для каждого типа файлов существуют свои программы просмотра, если же для каких-либо типов файлов они отсутствуют, следует использовать исходные приложения.

После того, как вся доступная информация проанализирована, могут быть сделаны определенные выводы. На этом этапе, однако, крайне важно проявить максимальную осторожность и не в коем случае не допустить ошибки при определении виновника нарушения безопасности. Если же результаты расследования представляются достаточно убедительными, можно приступать к этапу отчета о расследовании.

**Загрузка**

[Загрузить фундаментальное руководство по расследованию компьютерных происшествий для Windows.](http://go.microsoft.com/fwlink/?linkid=80345)

**Уведомления об обновлениях**

[Подписаться на уведомления об обновлениях и новых выпусках](http://go.microsoft.com/fwlink/?linkid=54982)

**Обратная связь**

[Отправить замечания или пожелания](mailto:secwish@microsoft.com?subject=fundamental%20computer%20investigation%20guide%20for%20windows)

[](#mainsection)[К началу страницы](#mainsection)
