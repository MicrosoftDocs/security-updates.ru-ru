---
TOCTitle: 'Фундаментальное руководство по исследованию компьютерных происшествий для Windows. Глава 5. Пример ситуации'
Title: 'Фундаментальное руководство по исследованию компьютерных происшествий для Windows. Глава 5. Пример ситуации'
ms:assetid: '959c31cd-216b-47fe-b821-7bb40d4156ae'
ms:contentKeyID: 20212677
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc162849(v=TechNet.10)'
---

Фундаментальное руководство по исследованию компьютерных происшествий для Windows
=================================================================================

### Глава 5. Пример ситуации

Опубликовано 11 января 2007

Ниже описан случай несанкционированного доступа к внутренней конфиденциальной информации в крупном финансовом учреждении, банке Woodgrove Bank. Это вымышленный случай, так же, как и упоминаемые в его описании люди и организации.

Случай приведен с целью предоставления общих сведений об инструментах и технологиях, применяемых для сбора и анализа данных. В реальной ситуации нарушения безопасности следует обратиться к руководству, юристам и в правоохранительные органы за консультацией по применению соответствующих приемов расследования. Кроме того, хотя авторы признают важность создания образа диска подозреваемого для расследования, сведения об этом выходят за пределы данного руководства, приводится лишь краткое упоминание этой задачи при описании этапа получения данных в приведенной ситуации.

##### На этой странице

[](#eiaa)[Ситуация](#eiaa)
[](#ehaa)[Оценка обстановки](#ehaa)
[](#egaa)[Получение доказательств доступа к конфиденциальным данным](#egaa)
[](#efaa)[Удаленный сбор доказательств](#efaa)
[](#eeaa)[Локальный сбор доказательств](#eeaa)
[](#edaa)[Анализ собранных доказательств](#edaa)
[](#ecaa)[Доклад о доказательствах](#ecaa)
[](#ebaa)[Моделирование прикладного сценария в лаборатории](#ebaa)

### Ситуация

Рэй Чоу, администратор систем предприятия банка Woodgrove National Bank узнал, что некто хвастался знанием размера заработной платы многих сотрудников банка. Рэй узнал имя сотрудника, который заявлял о том, что обладает такими сведениями, это был Майк Данселио. Майк работает в кредитном отделе и не должен иметь доступ к файлам отдела кадров.

В банке Woodgrove National Bank имеется собственная политика использования компьютеров организации. Данная политика предполагает, что использование компьютеров организации в любых целях, включая доступ к электронной почте и веб-узлам, не предполагает конфиденциальности. Данной политикой запрещается загружать какие бы то ни было программы на какие бы то ни было компьютеры без письменного разрешения директора по ИТ, а также обусловливается, что любые попытки обхода паролей или получения несанкционированного доступа к файлам банка могут служить основанием для увольнения или судебного преследования. Данная политика также позволяет ИТ-специалистам устанавливать любые устройства сетевого мониторинга, в том числе анализаторы пакетов или другие устройства записи пакетов, для обеспечения безопасности сети или расследования возможных нарушений.

Рэй хочет убедиться, что применяемые им процедуры расследования компьютерных происшествий для расследования данного случая и предоставления отчета о результатах являются общепринятыми. По мнению Рэя, изначально данные сведения могли быть получены с файлового сервера отдела кадров, поэтому он планирует использовать модель расследования компьютерных происшествий, состоящую из четырех этапов, которая показана на следующем рисунке.

![](/security-updates/images/Cc162849.80e07bd9-28f1-4bc8-b541-bc821af9f2a7(ru-ru,TechNet.10).gif)

**Рис. 5.1. Обзор модели расследования компьютерных происшествий**

![](/security-updates/images/Cc162849.important(ru-ru,TechNet.10).gif) **Важно!**

Сведения о том, как воссоздать данную ситуацию и выполнить его с использованием приведенных инструментов см. в разделе «Моделирование прикладного сценария в лаборатории» в конце данной главы.

[](#mainsection)[К началу страницы](#mainsection)

### Оценка обстановки

Для оценки обстановки Рэй проводит встречу с руководством. Представители руководства утверждают, что несанкционированный доступ и распространение конфиденциальных сведений о заработной плате будет служить основанием для увольнения, но судебное преследование сотрудника за эти действия проводится не будет.

Политика Woodgrove National Bank предусматривает проведение консультаций руководства организации с внутренним юридическим отделом с целью уточнить детали местного законодательства и определить, не затрагивают ли другие политики организации проведение расследования несанкционированного доступа сотрудника к закрытым компьютерным системам.

В юридическом отделе банка Woodgrove National Bank составляются письменные разрешения для Рэя на проверку содержимого рабочего компьютера Майка Данселио. Группы юристов и представителей руководства просят информировать их о результатах расследования. Кроме того, они просят Рэя принять необходимые меры для более надежной защиты конфиденциальных данных в будущем, в том случае, если им будет обнаружен факт нарушения безопасности.

Первой задачей Рэя является определение компьютеров, которые необходимо задействовать в расследовании, и документирование конфигурации оборудования каждого из них. После выполнения этой задачи Рэй составляет логическую схему задействованных компьютеров, представленную на следующем рисунке.

![](/security-updates/images/Cc162849.1010ca24-547f-4899-9ad1-19ede8e19b12(ru-ru,TechNet.10).gif)

**Рис. 5.2. Логическая схема компьютеров, задействованных в расследовании**

Затем Рэй рассматривает различные варианты дальнейшего расследования. Поскольку часть сведений, которые необходимо получить, представляют собой временные данные, Рэй принимает решение начать внутреннее расследование компьютерного происшествия с анализа актуальных данных. Затем он создаст образ диска Майка Данселио и рассмотрит статические доказательства.

Рай создает USB-диск, содержащий соответствующие инструменты для проведения расследования. (Описание инструментов, упоминаемых в данной главе, приведены в разделе «Инструменты» в [приложении «Ресурсы»](http://www.microsoft.com/rus/technet/security/guidance/disasterrecovery/computer_investigation/a9a5c2a9-cce3-4edb-a92c-10983899240a.mspx) данного руководства).

Следующей задачей Рэя будет создание копии жесткого диска подозреваемого таким образом, чтобы обезопасить и сохранить доказательства на случай, если будет обнаружены сведения, требующие передачи дела в правоохранительные органы.

Рэй отмечает потенциально интересующие его элементы, описывает, что именно необходимо для определения и подтверждения подлинности собранных доказательств далее в ходе расследования и создает журнал аудита действий, выполняемых в ходе расследования.

[](#mainsection)[К началу страницы](#mainsection)

### Получение доказательств доступа к конфиденциальным данным

Представители руководства банка Woodgrove National Bank санкционировали исследование Реем структуры каталогов файлового сервера отдела кадров (WNB-HQ-FS1) и файлов, относящихся к начислению и выплате заработной платы с целью выявления факта несанкционированного доступа к этим файлам. Рэй мог немедленно приступить к поиску доказательств на компьютере Майка Данселио или же попытаться найти доказательства в журналах аудита на сервере. Рэй также хочет выяснить, какими правами пользователя обладает Майк Данселио по отношению к папкам отдела кадров.

Рэй принимает решение собирать доказательства в два этапа.

1.  Изучение файлового сервера отдела кадров с целью поиска доказательств несанкционированного доступа к конфиденциальным файлам и папкам. В результате данного исследования подозрения руководства относительно несанкционированного доступа Майка Данселио к этим папкам могут подтвердиться или не подтвердиться.

2.  Локальное и удаленное изучение содержимого диска Майка Данселио с целью поиска любых конфиденциальных данных. Рэй планирует использовать как встроенные средства Microsoft® Windows® (включая Ipconfig, Systeminfo и Netstat), так и средства Windows Sysinternals (включая AccessChk, PsLoggedOn и PsFile).

Рэй проводит собеседования с сотрудниками отдела кадров и исследует содержимое файлового сервера. Он отмечает, что итоговые данные по файлам начисления заработной платы ежемесячно сводятся в файлы электронных таблиц, которые хранятся в папке HR\\Internal\\Payroll. Права на запись и чтения этой папки должны быть только у членов группы HR MGRS, и Майк Данселио в нее не входит. Рэю необходимо определить, возможен ли доступ постороннего к папке отдела кадров, содержащей информацию о зарплате сотрудников банка.

Он просматривает журналы событий файлового сервера отдела кадров. Ранее он настроил аудит папки HR\\Internal таким образом, чтобы отслеживать как случаи успешного доступа, так и случаи отказа в доступе. Рэй отмечает все действия, предпринимаемые им для открытия и просмотра журнала событий безопасности.

Некоторые записи в журнале событий выделяются на общем фоне, как показано на снимке экрана, приведенном ниже. Несколько записей указывают на то, что пользователь учетной записи mdanseglio обращался к файлу **HR\\Internal\\Payroll\\090806PR-A139.xls**.

![](/security-updates/images/Cc162849.2185f010-221f-41b9-bbf4-25c2591ef44d(ru-ru,TechNet.10).gif)

**Рис. 5.3. Записи журнала событий безопасности, указывающие на то, что пользователь учетной записи mdanseglio обращался к файлу 090806PR-A139.xls в папке HR\\Internal\\Payroll**

Сначала Рэй создает на USB-диске папки \\evidence и \\tools. Чтобы обеспечить целостность создаваемых файлов, Рэй создает криптографический хэш MD-5 для всех файлов, скопированных с компьютера Майка в папку доказательств evidence.

Криптографический хэш MD-5 создается посредством применения к файлу определенного алгоритма действий, который создает уникальный 128-разрядный ключ, однозначно идентифицирующий содержимое файла. Если у кого-либо возникнут вопросы по поводу целостности собранных Реем данных (к примеру, предположение, что конкретный файл мог быть впоследствии изменен), Рэй сможет представить оригинальное значение контрольной сумы MD-5 для сравнения и проверки.

Рэй экспортирует фрагмент журнала на USB-диск с меткой HR01. Этот же USB-диск будет использоваться для всех собираемых доказательств.

![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

При подключении USB-диска к компьютеру под управлением Windows добавляется запись в файл журнала **Setupapi.log**, а также изменяется значение следующего ключа реестра: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictAnonymous**

        ```
![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

Необходимо установить средство Sysinternals AccessChk, при этом на локальном диске остается след в виде следующего ключа реестра: **HKEY\_CURRENT\_USER\\Software\\Sysinternals\\AccessChk**

Рэй замечает, что пользователь учетной записи mdanseglio имеет разрешение на чтение и запись вложенных папок \\Benefits, \\Payroll и \\Reviews в папке \\HR\\Internal, как показано на следующем снимке экрана:

![](/security-updates/images/Cc162849.89107cc0-71e0-4b6d-83d1-24e22c3e1521(ru-ru,TechNet.10).gif)

**Рис. 5.4. Результаты работы средства AccessChk, показывающие разрешения пользователю учетной записи mdanseglio на чтение и запись вложенных папок папки HR\\Internal**

Рэй подозревает, что ошибки в конфигурации разрешений сервера отдела кадров позволили Майку Данселио получить доступ к папке HR\\Internal. После нескольких минут, проведенных за установлением прав пользователя Майка Данселио Рэй замечает, что данный пользователь является членом группы branch01mgrs. Данная группа имеет разрешения на чтение и запись папок в папке HR\\Internal.

        ```
Результаты выполнения этой команды, показанные на следующем снимке экрана, указывают на то, что Майк Данселио в настоящее время подключен к компьютеру WNB-HQ-FS1.

![](/security-updates/images/Cc162849.0e12a08e-1f27-4852-81b2-6feb53b61773(ru-ru,TechNet.10).gif)

**Рис. 5.5. Результаты работы средства Psloggedon, указывающие на то, что пользователь учетной записи mdanseglio подключен к компьютеру WNB-HQ-FS1**

Рэй удаляет Майка Данселио из группы branch01mgrs и повторно проверяет его права доступа к папке HR\\Internal.

После дальнейшего рассмотрения журнала событий безопасности и результатов работы средства AccessChk с целью обнаружить другие возможные ошибки конфигурации разрешений на операции с папкой HR\\Internal Рэй приступает к исследованию содержимого компьютера Майка Данселио, применяя методы удаленного расследования.

[](#mainsection)[К началу страницы](#mainsection)

### Удаленный сбор доказательств

Рэй решает собрать сведения с компьютера Майка Данселио удаленно, прежде чем попытаться сделать это локально, поэтому он выходит на работу в выходной с целью сделать копию жесткого диска Майка, которая могла бы служить доказательством в суде. В реальной ситуации Рэй мог бы провести все расследование на образе жесткого диска компьютера подозреваемого. В рамках данного случая, однако, описываются средства и методы как локального, так и удаленного сбора переменных данных, могущих служить доказательством.

Рэй использует USB-диск, подключенный к своему компьютеру и содержащий множество различных инструментов. На этом USB-диске будут храниться все собранные доказательства, а также текстовые файлы с записью всех вводимых команд.

Для того чтобы отметить время начала исследования, собрать доказательства с компьютера Майка Данселио удаленно по сети, записать все действия в процессе расследования и создать хэш MD5 собранных доказательств, Рэй использует следующую базовую процедуру.

![](/security-updates/images/Cc162849.important(ru-ru,TechNet.10).gif) **Важно!**

Стандартная конфигурация брандмауэра Windows не позволяет использовать некоторые из средств Sysinternals, в том числе PsExec, PsFile и PsLogList. Чтобы действовать в рамках данного примера и установить, какие сведения могут быть получены удаленно с применением данных средств, необходимо открыть вкладку **Исключения** брандмауэра Windows и включить **Общий доступ к файлам и принтерам**. При этом предоставлять общий доступ к каким бы то ни было ресурсам не обязательно.

На конечных компьютерах с включенным брандмауэром Windows и отключенным общим доступом к файлам и принтерам (настройки по умолчанию), инструменты Systeminfo, Ipconfig, Arp, Netstat, Schtasks, PsFile, PsList и PsLogList необходимо запускать локально. В таком случае каждое средство следует запустить непосредственно на исследуемой системе, перенаправив вывод результатов в файл **evidence2.txt**, который создается в разделе «Локальный сбор доказательств» далее в этой главе.

1.  Работа с USB-диском.

    Рэй работает с USB-диском и папкой \\tools, в которой находятся инструменты командной строки (в том числе PsExec и инструмент проверки целостности контрольной суммы файла (File Checksum Integrity Validator, FCIV).

    
        ```
2.  Запись даты и времени начала исследования.

    Чтобы записать время начала расследования, Рэй направляет вывод команд даты и времени в новый файл **mdevidence.txt**, который создается в папке \\evidence USB-диска. (Системное время на компьютере Майка Данселио будет получено на этапе 3). Кроме того, Рэй ищет возможное несоответствие между датой и временем в BIOS и действительными значениями даты и времени.

    
        ```
3.  Получение основных сведений о конечном компьютере.

    Для получения сведений о компьютере Майка Рэй выполняет последовательность встроенных команд Windows.

    
        ```
    ![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

    Средство PsExec применяется для удаленного сбора информации с использованием служб, которые уже присутствуют на конечном компьютере, таких как Cmd и Ipconfig. Средство PsExec также может использоваться для загрузки служб по сети и выполнения их на конечном компьютере. Рэй не хочет устанавливать на компьютере Майка какие-либо приложения, он запускает на нем только службы, поддерживающиеся операционной системой Windows XP.

4.  Запуск средств удаленной работы, использующих локальные прикладные программные интерфейсы (API).

    Теперь Рэй применяет инструменты, с помощью которых можно определить запущенные на компьютере процессы, получить журналы событий системы и безопасности компьютера, а также определить, есть ли на компьютере Майка файлы, открытые на других компьютерах.

    
        ```
    -   Средство PsFile отображает файлы, открытые удаленно. Данное средство использует интерфейс Remote API операционной системы Windows, поэтому его не нужно загружать на конечный компьютер.

    -   Средство PsList отображает сведения о запущенных на компьютере процессах и потоках. Данное средство использует интерфейс Remote API операционной системы Windows, поэтому его не нужно загружать на конечный компьютер.

    -   Средство PsLogList по умолчанию создает копию журнала регистрации событий компьютера, никакие дополнительные параметры при этом не требуются. Для получения журнала событий безопасности Рэй выполняет эту команду с параметром **sec**.

5.  Создание списка всех выполнявшихся задач.

    Операционная система Windows автоматически отслеживает все команды, выполняющиеся в командной строке. Для записи этого списка команд Рэй использует команду Doskey и записывает историю команд в файл **mdevidence-doskey.txt**.

    
        ```
6.  Создание контрольной суммы MD5 для файлов, являющихся доказательствами.

    Для создания контрольной суммы MD5 для файлов, являющихся доказательствами, Рэй применяет средство FCIV.

    
        ```
![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

Из-за ограничения ширины экрана предыдущая команда может отображаться на нескольких строках. В командной строке ее следует вводить одной строкой.

Средство FCIV вычисляет и проверяет значения криптографического хэша. Ссылка для загрузки данного средства приведена в статье базы знаний Майкрософт 841290.

        ```
Несмотря на то, что всем пользователям предписано хранить документы на сетевом сервере, Рэй замечает на компьютере Майка Данселио папку Personal (Личное). В данной папке находится файл электронной таблицы и вложенная папка \\xxxpixset.

После удаленного просмотра папок на компьютере Майка Рэй готов отчитаться о результатах и перейти к локальному исследованию компьютера Майка.

Начальник отдела кадров Джил Шрейдер звонит Рэю на мобильный телефон и спрашивает о ходе расследования. Рэй объясняет, что им собрана следующая информация.

-   У учетной записи Майка Данселио были разрешения на чтение и запись папки HR\\Internal, поскольку он был по ошибке внесен в группу branch01mgrs, у которой есть соответствующие разрешения доступа к данной папке и вложенным папкам.

-   На жестком диске компьютера Майка находится папка Personal, содержащая по меньшей мере один файл электронной таблицы.

-   На компьютере Майка обнаружено две запрещенные программы, позволяющие ему отслеживать сетевой трафик и производить поиск служб и компьютеров в сети.

-   На жестком диске компьютера Майка обнаружена большая коллекция файлов изображений, которые, по мнению Рэя, могут представлять собой порнографические изображения.

[](#mainsection)[К началу страницы](#mainsection)

### Локальный сбор доказательств

В идеале расследование компьютерных происшествий должно проводиться на образах жестких дисков. Однако в данном примере Рэй запустит несколько программ непосредственно на компьютере Майка Данселио. Эти программы выполняются с USB-диска и не требуют установки на локальный компьютер. Тем не менее, как уже отмечалось ранее, подключение USB-диска оставит след в реестре.

![](/security-updates/images/Cc162849.important(ru-ru,TechNet.10).gif) **Важно!**

Если бы на компьютере Майка Данселио был включен брандмауэр Windows и отключен общий доступ к файлам и принтерам, Рэю пришлось бы запускать инструменты Systeminfo, Ipconfig, Arp, Netstat, Schtasks, PsFile, PsList и PsLogList локально. Рэй ввел бы команды, перечисленные в разделе «Удаленный сбор доказательств» ранее, но удалил бы ссылки на \\\\hqloan164, прежде записывать результаты в файл **evidence2.txt**.

На компьютере Майка Рэй планирует выполнить следующие задачи.

-   Поиск доказательств присутствия конфиденциальных файлов на диске.

-   Создание копий всех подозрительных файлов.

-   Исследование файлов.

Для доступа к папке с личной информацией Майка Рэй входит в систему на его компьютере с помощью учетной записи администратора. После подключения USB-диска для сбора доказательств к компьютеру Майка Рэй выполняет следующую процедуру.

1.  Доступ к папке Personal Майка Данселио.

    Рэй переходит к папке Personal Майка с помощью следующих команд.

    
        ```
2.  Запись даты и времени начала исследования.

    Рэй перенаправляет вывод команд Date и Time, чтобы записать время начала расследования. Он направляет вывод результатов в новый файл **mdevidence2.txt**, который создается в папке \\evidence на USB-диске.

    
        ```
    ![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

    USB-диску назначена буква диска F: на компьютере Майка.

3.  Получение информации о структуре каталогов.

    С помощью команды Dir Рэй исследует содержимое папки Personal на компьютере Майка. Сначала Рэй направляет вывод результатов на экран, чтобы просмотреть их, и замечает файл электронной таблицы и папку \\xxxpixset. Затем Рэй направляет вывод результатов выполнения команды Dir в файл записи доказательств с помощью трех разных параметров: /tc для вывода времени создания, /ta для вывода времени последнего обращения к файлу и /tw вывода времени записи.

    
        ```
4.  Работа с USB-диском.

    Рэй работает с USB-диском и папкой \\tools, в которой находятся инструменты командной строки.

    
        ```
5.  Сбор информации о файлах Майка Данселио.

    Рэй исследует содержимое папки Мои документы Майка Данселио и всех вложенных папок с помощью служебной программы Du. С помощью параметра –l 5 он ограничивает поиск глубиной вложенности в пять папок. Сначала, прежде чем направить вывод результатов в файл **mdevidence2.txt**, Рэй просматривает результаты поиска на экране (который приводится на следующем снимке экрана).

    
        ```
    ![](/security-updates/images/Cc162849.e08dd6a3-ffd8-41a9-bd1e-8f487f69508b(ru-ru,TechNet.10).gif)

    **Рис. 5.6. Результаты работы служебной программы Du**

6.  Копирование подозрительных файлов в папку \\evidence\_files.

    Несмотря на то, что Рэй уже создал полный образ диска Майка Данселио, он решает скопировать файлы из его папки Personal в новую папку с именем **evidence\_files**, которая создается на USB-диске. Он исследует эту папку и файлы в ней в процессе анализа.

    ![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

    Копию исходного файла Рэй получил в процессе создания образа. Он может создать хэш исходного файла с рабочего диска, если нужно сравнить этот файл с копией файла на USB-диске.

    Рэй использует команду Xcopy с параметром /s для копирования вложенных папок, параметром /e для копирования вложенных папок, даже если они не содержат файлов, параметром /k для сохранения атрибута «только чтение» у конечных файлов, если он присутствовал у исходных файлов, и параметром /v для проверки записи каждого файла при копировании, чтобы гарантировать идентичность конечных файлов исходным файлам.

    
        ```
7.  Исследование содержимого корзины.

    Рэй бегло просматривает содержимое корзины на компьютере Майка Данселио, содержащей различные удаленные файлы (см. рис. 5.7). Рэй знает, что в процессе создания образа диска были созданы копии и этих файлов, поэтому их можно просмотреть и позже. После просмотра содержимого корзины Рэй готов к рассмотрению доказательств, собранных им локально и удаленно.

    ![](/security-updates/images/Cc162849.1947d37b-f6aa-45d5-8899-e0de76cdb382(ru-ru,TechNet.10).gif)

    **Рис. 5.7. Несколько файлов изображений в корзине**

[](#mainsection)[К началу страницы](#mainsection)

### Анализ собранных доказательств

У Рэя есть два файла, содержащие доказательства: **mdevidence.txt** и **mdevidence2.txt**. У него также есть копия личной папки Personal Майка Данселио. Для анализа сведений, содержащихся в этих файлах, Рэй использует на своем компьютере следующую процедуру.

1.  Анализ сведений о процессах.

    Рэй рассматривает файл **mdevidence.txt**. Результаты работы средства PsList представляют большой интерес, поскольку указывают на то, что Майк Данселио запускает запещенные приложения, включая Wireshark и nMapWin, как показано на следующем снимке экрана.

    Рэю известно, что при изучении содержимого компьютера подозреваемого зачастую можно обнаружить и прочие нарушения, не связанные с предметом расследования. Рэй также осознает, что не все приложения легко распознать (как те, что перечислены в нашем примере), а также вероятность того, что они могли быть установлены без ведома Майка.

    ![](/security-updates/images/Cc162849.defe0f97-b28f-4300-9df3-d6fa832d1c59(ru-ru,TechNet.10).gif)

    **Рис. 5.8. Результаты работы средства Pslist на компьютере Майка Данселио**

2.  Работа с USB-диском.

    Рэй переходит в папку \\tools на USB-диске, в которой находятся инструменты командной строки.

    
        ```
3.  Поиск подозрительных строк в файле электронной таблицы.

    Рэй выполняет поиск строки «confidential» (конфиденциально) в копиях файлов из папки Personal Майка. Для этого он использует команду Find с параметрами /I (игнорирование регистра символов при поиске строки) и /c (вывод количества строк, содержащих строку поиска).

    Сначала Рэй выводит результаты поиска на экран. Оказывается, что в файле **090806PR-A139.xls** найдено совпадение, как показано на следующем снимке экрана. Поэтому Рэй выполняет данную команду еще раз, записывая результаты поиска в файл **mdevidence-review.txt**.

    
        ```
    ![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

    Из-за ограничения ширины экрана предыдущая команда может отображаться на нескольких строках. В командной строке ее следует вводить одной строкой.

    ![](/security-updates/images/Cc162849.2a056bdd-f29e-4327-b88c-add5b50ef92b(ru-ru,TechNet.10).gif)

    **Рис. 5.9. Результаты поиска строки «confidential» в файле 090806PR-A139.XLS**

4.  Сначала Рэй копирует файл **090806PR-A139.xls** в папку \\evidence\_files, а затем использует инструмент Strings для вывода списка строк в кодировках ASCII и Юникод, содержащихся в файле таблицы.

    
        ```
    Результаты (показанные на следующем снимке экрана) указывают на то, что файл электронной таблицы содержит сведения о заработной плате. Рэй выполняет команду Strings еще раз, записывая результаты в файл **mdevidence-review.txt**.

    
        ```
    ![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

    Из-за ограничения ширины экрана предыдущая команда может отображаться на нескольких строках. В командной строке ее следует вводить одной строкой.

    ![](/security-updates/images/Cc162849.ad4cc4e5-9d54-47f3-99cb-694d01db0e66(ru-ru,TechNet.10).gif)

    **Рис. 5.10. Результаты выполнения служебной программы Strings для файла таблицы**

    Рэй убежден, что на компьютере Майка Данселио им обнаружена несанкционированная копия файла отдела кадров с данными о заработной плате.

[](#mainsection)[К началу страницы](#mainsection)

### Доклад о доказательствах

Рэй анализирует и сопоставляет обнаруженные доказательства, после чего составляет отчет с итоговыми сведениями о результатах расследования. Пример такого отчета включен в состав материалов, прилагающихся к данному руководству, которые приведены в разделе «Рабочие материалы» документа [Приложение: Ресурсы](http://www.microsoft.com/rus/technet/security/guidance/disasterrecovery/computer_investigation/a9a5c2a9-cce3-4edb-a92c-10983899240a.mspx). В свой отчет Рэй включает рекомендации по обеспечению безопасности конфиденциальных данных в будущем. Рэй также проверяет целостность данных файлов доказательств и сохраняет их должным образом, записав их и окончательный отчет на компакт-диск.

В его отчете содержится следующая информация.

-   **Цель отчета.** Целью отчета является предоставление руководству банка Woodgrove Bank информации о данном происшествии и указаний по поводу возможного использования результатов расследования для предотвращения нарушений безопасности в будущем.

-   **Автор отчета.** Рэй указывает свои имя и должность и отмечает, что им была проведена работа ведущего технического специалиста.

-   **Общие сведения о происшествии.** В данном разделе указаны первоначальные подозрения и влияние данного происшествия на работу организации.

-   **Доказательства.** В данном разделе перечисляются запущенные процессы, личный каталог, обнаруженный на компьютере Майка Данселио, обнаруженные откровенные изображения, список выполнявшихся недопустимых приложений и расположение файла, содержащего конфиденциальную информацию о заработной плате.

-   **Анализ.** В данном разделе приводятся результаты локального и удаленного расследований, которые доказывают факты загрузки файлов откровенно сексуального содержания, неверной конфигурации разрешений и доступа к конфиденциальному файлу, содержащему информацию о заработной плате.

-   **Заключение.** В данном разделе подводится итог результатов расследования и приводятся рекомендации по предотвращению подобных происшествий в будущем.

-   **Сопутствующие документы.** В данном разделе приводятся схемы сети и список применявшихся в ходе данного расследования процедур и технологий расследования компьютерных происшествий.

После подачи отчета Рэй ожидает разрешения на проведение дополнительных процедур расследования или других действий, выполнения которых может потребовать руководство.

![](/security-updates/images/Cc162849.note(ru-ru,TechNet.10).gif) **Примечание.**

Каждое расследование уникально. Следует применять средства, наиболее подходящие для решения конкретной задачи, с помощью которых можно получить искомые сведения, однако в любой ситуации полезно будет собрать больше доказательств, чем может понадобиться.

[](#mainsection)[К началу страницы](#mainsection)

### Моделирование прикладного сценария в лаборатории

Чтобы воссоздать условия данного происшествия в экспериментальной среде необходимо выполнить следующие действия.

1.  Провести развертывание компьютеров и создать домен службы каталогов Active Directory®.

2.  Создать пользователей и группы пользователей в службе каталогов Active Directory.

3.  Создать папки и файлы на определенных компьютерах.

4.  Установить общий доступ и разрешения.

5.  Настроить аудит.

#### Развертывание компьютеров и создание домена

В следующей таблице перечислены компьютеры и операционные системы, которые могут понадобиться для работы в рамках данного происшествия:

**Таблица 5.1. Компьютеры и операционные системы, использующиеся при анализе прикладного сценария данного происшествия в экспериментальной среде**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Имя компьютера</th>
<th style="border:1px solid black;" >Операционная система</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">WNB-HQ-DC</td>
<td style="border:1px solid black;">Windows Server® 2003 R2</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">WNB-HQ-FS1</td>
<td style="border:1px solid black;">Windows Server 2003 R2</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HQ-IT-PC10</td>
<td style="border:1px solid black;">Windows XP Professional с пакетом обновления 2</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HQLOAN164</td>
<td style="border:1px solid black;">Windows XP Professional с пакетом обновления 2</td>
</tr>
</tbody>
</table>
  
После установки операционной системы на всех компьютерах необходимо запустить на компьютере WNB-HQ-DC мастер установки Dcpromo и установить службы Active Directory и DNS.
  
#### Создание пользователей и групп
  
В следующей таблице перечислены пользователи и группы, которые необходимо определить в оснастке «Active Directory – пользователи и компьютеры» консоли управления (MMC).
  
**Таблица 5.2. Группы и пользователи, задействованные в исследовании прикладного сценария**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Группы</th>
<th style="border:1px solid black;" >Пользователи</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Администратор систем предприятия</td>
<td style="border:1px solid black;">Рэй Чоу</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Администраторы домена</td>
<td style="border:1px solid black;">Рэй Чоу</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HR MGRS (Менеджеры отдела кадров)</td>
<td style="border:1px solid black;">Дженни Готфрид, Роланд Уинклер, Джил Шрейдер</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Branch01Mgrs (менеджеры отдела 01)</td>
<td style="border:1px solid black;">Майк Данселио, Нурия Гонсалес</td>
</tr>
</tbody>
</table>
  
Группа «Администраторы домена» добавляется в локальную группу «Администраторы» на файловом сервере WNB-HQ-FS1.
  
#### Создание папок и файлов
  
В следующей таблице перечислены названия устройств, структура каталогов и необходимые файлы.
  
**Таблица 5.3. Устройства, папки и файлы, использующиеся в исследовании прикладного сценария**

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Устройство (компьютер или USB-диск)</th>
<th style="border:1px solid black;" >Папки</th>
<th style="border:1px solid black;" >Файлы</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">WNB-HQ-FS1 (файловый сервер)</td>
<td style="border:1px solid black;">\HR\Internal\Benefits
\HR\Internal\Payroll
\HR\Internal\Review
\Tools</td>
<td style="border:1px solid black;">090806PR-A139.xls
(В данной папке находятся все инструменты SysInternal и инструмент FCIV, перечисленные в разделе «Инструменты» в документе <a href="http://www.microsoft.com/rus/technet/security/guidance/disasterrecovery/computer_investigation/a9a5c2a9-cce3-4edb-a92c-10983899240a.mspx">Приложение: ресурсы</a>.)</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HQLOAN164 (Компьютер Майка Данселио)</td>
<td style="border:1px solid black;">\Documents and Settings\mdanseglio\My Documents\Personal
\Documents and Settings\mdanseglio\My Documents\Personal\xxxpixset</td>
<td style="border:1px solid black;">090806PR-A139.xls
(В данной папке находятся несколько файлов jpg, в именах которых содержится xxx. Несколько файлов шаблона xxx*.* были удалены из этой папки и находятся в корзине).</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HQ-IT-PC10 (Компьютер Рэя Чоу)</td>
<td style="border:1px solid black;">\Tools</td>
<td style="border:1px solid black;">(В данной папке находятся все инструменты SysInternal и инструмент FCIV, перечисленные в разделе «Инструменты» в документе <a href="http://www.microsoft.com/rus/technet/security/guidance/disasterrecovery/computer_investigation/a9a5c2a9-cce3-4edb-a92c-10983899240a.mspx">Приложение: ресурсы</a>.)</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">USB-диск (USB-диск Рэя Чоу)</td>
<td style="border:1px solid black;">\Evidence
\Evidence_Files
\Tools</td>
<td style="border:1px solid black;">(В данной папке находятся все инструменты SysInternal и инструмент FCIV, перечисленные в разделе «Инструменты» в документе <a href="http://www.microsoft.com/rus/technet/security/guidance/disasterrecovery/computer_investigation/a9a5c2a9-cce3-4edb-a92c-10983899240a.mspx">Приложение: ресурсы</a>.)</td>
</tr>
</tbody>
</table>
  
#### Установка общего доступа и разрешений
  
В следующей таблице перечислены папки с файлами и разрешения на доступ, необходимые для файлового сервера WNB-HQ-FS1.
  
**Таблица 5.4. Папки и разрешения доступа в исследовании прикладного сценария**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Папка</th>
<th style="border:1px solid black;" >Разрешения для общего ресурса</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">\HR</td>
<td style="border:1px solid black;">Branch01Mgrs (полный доступ, изменение, чтение)
HR MGRS (полный доступ, изменение, чтение)</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">\Tools</td>
<td style="border:1px solid black;">Общий доступ не включен; только локальное использование пользователями с правами администратора на сервере.</td>
</tr>
</tbody>
</table>
  
#### Настройка аудита
  
Политика контроллера домена WNB-HQ-DC **Доступ к объекту аудита** настроена на ведение аудита как успешного, так и неудачного доступа. Такая настройка производится с помощью оснасток «Политика безопасности домена» и «Политика безопасности контроллера домена» консоли управления.
  
На файловом сервере WNB-HQ-FS1 аудит настраивается для группы «Пользователи домена» для папки \\HR\\Internal. Чтобы произвести такую настройку, щелкните правой кнопкой папку и выберите **Свойства, Безопасность, Дополнительно,** а затем**Аудит**. Затем введите группу **Пользователи домена**.
  
[](#mainsection)[К началу страницы](#mainsection)
  
**Загрузка**
  
[Загрузить фундаментальное руководство по исследованию компьютерных происшествий для Windows.](http://go.microsoft.com/fwlink/?linkid=80345)
  
**Уведомления об обновлениях**
  
[Подписаться на уведомления об обновлениях и новых выпусках](http://go.microsoft.com/fwlink/?linkid=54982)
  
**Обратная связь**
  
[Отправить замечания или предложения](mailto:secwish@microsoft.com?subject=fundamental%20computer%20investigation%20guide%20for%20windows)
  
[](#mainsection)[К началу страницы](#mainsection)
