---
TOCTitle: 'Руководство по безопасности для системы Windows Vista, глава 4. Совместимость приложений'
Title: 'Руководство по безопасности для системы Windows Vista, глава 4. Совместимость приложений'
ms:assetid: 'd11f3fd0-b74e-4e77-bff9-4e1b8e5d1d68'
ms:contentKeyID: 20219131
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Bb629463(v=MSDN.10)'
---

Руководство по безопасности для системы Windows Vista
=====================================================

### Глава 4. Совместимость приложений

Опубликовано 7 февраля 2007 г.

Обеспечение совместимости приложений — это всегда критически важная задача, которую должны решать организации при развертывании новой операционной системы. При разработке Windows Vista™ большое внимание уделялось обеспечению высокого уровня функциональности новых возможностей и служб операционной системы, а также их совместимости с программами предыдущих версий. Во время разработки группа Microsoft Application Experience Team протестировала большое количество приложений различных сторонних поставщиков.

Параметры безопасности, рекомендуемые в этом руководстве для усиления безопасности Windows Vista, были тщательно протестированы на совместимость с основной операционной системой, а также с набором приложений Microsoft® Office. Приложения, которые работают в Windows Vista, должны правильно работать на клиентских компьютерах, к которым применены рекомендуемые параметры этого руководства.

Тем не менее существует возможность, что более ранние приложения не будут правильно поддерживаться новыми технологиями безопасности Windows Vista. Такие технологии, как контроль учетных записей и защита ресурсов Windows, могут мешать работе более старых приложений.

Решение Microsoft Solution Accelerator for Business Desktop Deployment (BDD) 2007 содержит полные рекомендации по обеспечению совместимости приложений, которые позволяют ИТ-специалистам протестировать приложения на совместимость с Windows Vista и устранить обнаруженные при этом проблемы. Дополнительные сведения см. в [*руководстве по совместимости приложений*](http://go.microsoft.com/fwlink/?linkid=74194) на веб-узле Microsoft TechNet® (на английском языке).

В этой главе рассмотрены простые процедуры, которые можно использовать для тестирования уровня совместимости приложений с Windows Vista, описаны наиболее распространенные причины проблем с совместимостью приложений, а также приведены ссылки на доступные ресурсы, которые помогут в решении этих проблем.

##### На этой странице

[](#edaa)[Проверка совместимости за 30 минут](#edaa)
[](#ecaa)[Известные проблемы с совместимостью приложений](#ecaa)
[](#ebaa)[Средства и ресурсы](#ebaa)
[](#eaaa)[Дополнительные сведения](#eaaa)

### Проверка совместимости за 30 минут

В этом разделе приведены рекомендации по тестированию и оценке совместимости приложений с Windows Vista. Он включает два сценария, которые можно использовать для тестирования совместимости приложений с операционной системой. Сценарии позволяют выполнить следующие задачи:

-   протестировать приложение при чистой установке Windows Vista;

-   протестировать приложение при обновлении Microsoft Windows® XP с пакетом обновления 2 (SP2) до Windows Vista.

**Тестирование приложения при чистой установке Windows Vista**

1.  Установите Windows Vista на тестовый компьютер.

2.  Войдите в систему тестового компьютера под управлением Windows Vista с учетной записью администратора.

3.  Установите приложение, которое необходимо протестировать в Windows Vista. Если появится запрос разрешения на установку приложения, нажмите кнопку **Разрешить** для продолжения установки. Если установка завершится успешно, перейдите к действию 6.

4.  Если при установке приложения происходит сбой и не выводится запрос разрешения на установку, щелкните правой кнопкой мыши EXE-файл установщика, выберите пункт **Запуск от имени администратора** и переустановите приложение. Если установка завершится успешно, перейдите к действию 7.

    **Примечание**.   Это действие не является обязательным, если для установки приложения используется MSI-файл установщика Microsoft.

5.  При возникновении ошибок, связанных с версией операционной системы, регистрацией приложения или копированием файлов, щелкните правой кнопкой мыши EXE-файл установщика **Совместимость** и выберите режим совместимости с Windows XP с пакетом обновления 2 (SP2).

6.  Повторите действие 2. Если приложение все же не удается установить, перейдите к действию 8.

7.  Войдите в систему тестового компьютера под управлением Windows Vista с учетной записью пользователя без административных привилегий.

8.  Запустите приложение. Если приложение не запускается или выводятся ошибки, включите режим совместимости Windows XP с пакетом обновления 2 (SP2) для EXE-файла приложения, а затем повторите попытку его установки в операционной системе.

9.  Если приложение запускается успешно, выполните все тесты, которые используются для его проверки на компьютере под управлением Windows XP. Проверьте функциональность приложения, чтобы убедиться в том, что оно правильно работает. Если приложение успешно пройдет все основные тесты функциональности, оно успешно работает в Windows Vista.

10. Если приложение не устанавливается или не запускается, перестает отвечать на запросы, вызывает любые ошибки или не проходит любой их основных тестов функциональности, возможно, оно является одним из небольшого числа приложений, несовместимых с Windows Vista. Для дополнительного анализа и тестирования приложения просмотрите другие справочные ресурсы, указанные в этой главе.

**Тестирование приложения при обновлении Windows XP с пакетом обновления 2 (SP2) до Windows Vista**

1.  Установите Windows XP с пакетом обновления 2 (SP2) на тестовый компьютер, а затем установите приложение, которое необходимо протестировать. Перед продолжением проверьте все функции приложения.

2.  Обновите систему тестового компьютера до Windows Vista. Выполните инструкции по установке и обновлению для Windows Vista. После завершения обновления войдите в систему тестового компьютера так же, как при работе с Windows XP.

3.  Запустите приложение. Если приложение не запускается или выводятся ошибки, включите режим совместимости с Windows XP с пакетом обновления 2 (SP2) для EXE-файла приложения и повторите установку.

4.  Если приложение запускается успешно, выполните все тесты, которые используются для его проверки на компьютере под управлением Windows XP. Проверьте функциональность приложения, чтобы убедиться в том, что оно правильно работает. Если приложение успешно пройдет все основные тесты функциональности, оно успешно работает в Windows Vista.

5.  Если приложение не устанавливается или не запускается, перестает отвечать на запросы, вызывает любые ошибки или не проходит любой их основных тестов функциональности, возможно, оно является одним из небольшого числа приложений, несовместимых с Windows Vista. Для дополнительного анализа и тестирования приложения просмотрите другие справочные ресурсы, указанные в этой главе.

Если приложение правильно работает в этих сценариях, можно утверждать, что оно поддерживается Windows Vista.

[](#mainsection)[К началу страницы](#mainsection)

### Известные проблемы с совместимостью приложений

В этом разделе описаны некоторые наиболее распространенные новые технологии, улучшения и изменения в Windows Vista, которые приводят к проблемам с совместимостью приложений. В разделе также указаны способы устранения таких проблем (если это возможно).

**Внимание**!   Протестируйте все приложения сторонних производителей, которые планируется использовать в среде с Windows Vista, чтобы гарантировать, что они правильно поддерживаются этой операционной системой.

#### Улучшения системы безопасности

Следующие новые улучшения системы безопасности в Windows Vista могут вызывать проблемы совместимости с приложениями сторонних производителей:

-   **Контроль учетных записей**. Эта новая возможность позволяет отделить обычные привилегии пользователей и задачи от задач, которые требуют доступа с правами администратора. Контроль учетных записей повышает безопасность и при этом улучшает работу с компьютером для пользователей с обычными учетными записями. Пользователи клиентских компьютеров могут выполнять больше задач и использовать преимущества улучшенной совместимости приложений без необходимости входить в систему с административными привилегиями. Это позволяет снизить воздействие вредоносных программ, несанкционированной установки программного обеспечения и неразрешенных изменений системы.

    Контроль учетных записей может вызвать проблемы с приложениями, которые не соответствуют этому усовершенствованию технологии. По этой причине важно протестировать приложения с включенным контролем учетных записей до их развертывания. Дополнительные сведения о тестировании совместимости приложений см. в [*руководстве по совместимости приложений*](http://go.microsoft.com/fwlink/?linkid=74194) BDD на веб-узле TechNet (на английском языке).

-   **Защита ресурсов Windows**. Эта новая возможность Windows Vista позволяет защитить системные файлы и защищенные местоположения реестра для улучшения общей безопасности и стабильности операционной системы. Большинство приложений, которые ранее получали доступ к этим местоположениям, автоматически перенаправляются во временные местоположения, при работе с которыми не будут возникать проблемы.

    Тем не менее приложения, которым необходим полный доступ к этим защищенным областям и которые не поддерживают автоматическое перенаправление, не будут правильно работать в Windows Vista. В таком случае потребуется изменить приложения таким образом, чтобы они работали, как предусмотрено. Дополнительные сведения об этой новой возможности и ее влиянии на совместимость приложений см. в статье [Защита ресурсов Windows](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wfp/setup/about_windows_file_protection.asp) на веб-узле Microsoft MSDN® (на английском языке).

-   **Защищенный режим**. Эта новая возможность обозревателя Microsoft Internet Explorer® 7 позволяет защитить компьютеры под управлением Windows Vista от установки вредоносных программ и другого нежелательного программного обеспечения благодаря использованию более низких и безопасных прав для работы с операционной системой. Когда Internet Explorer находится в защищенном режиме, обозреватель может взаимодействовать только с определенными областями файловой системы и реестра.

    Хотя защищенный режим позволяет обеспечить целостность систем клиентских компьютеров под управлением Windows Vista, он может влиять на работу более старых веб-приложений для Интернета и интрасети. Возможно, придется изменить такие веб-приложения для работы в более ограниченной среде.

#### Изменения и новшества в операционной системе

Следующие изменения и новшества в операционной системе Windows Vista могут вызывать проблемы совместимости с приложениями сторонних производителей.

-   **Новые системные API**. Прикладные программные интерфейсы (API) предоставляют уровни операционной системы Windows Vista иначе, чем в предыдущих версиях Windows. Примерами приложений, которые используют новые API для отслеживания и защиты Windows Vista, являются антивирусные программы и брандмауэры. Необходимо обновить приложения, которые выполняют эти функции, до версий, совместимых с Windows Vista.

-   **64-разрядная система Windows** **Vista**. В 64-разрядной среде Windows Vista не поддерживаются 16-разрядные приложения и 32-разрядные драйверы. Автоматическое перенаправление для реестра и системных файлов недоступно в 64-разрядной среде. По этой причине новые 64-разрядные приложения должны соответствовать всем стандартам приложений для Windows Vista.

-   **Версии операционной системы**. Многие более старые приложения проверяют наличие определенной версии Windows. Когда приложения сторонних производителей не могут определить нужную версию операционной системы, многие из них перестают отвечать на запросы.

    Большинство проблем совместимости, связанных с требованиями к версиям операционной системы, устраняются благодаря новым функциям Windows Vista. Такие возможности, как помощник по совместимости программ, обычно разрешают проблемы данного типа автоматически. Дополнительные сведения о помощнике по совместимости программ, а также о других средствах и ресурсах см. в следующем разделе этой главы.

Статья [История разработчика Windows Vista: секреты совместимости приложений](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnlong/html/appcomp.asp) (на английском языке) на веб-узле MSDN содержит дополнительные сведения об этих улучшениях безопасности, а также изменениях и новшествах в Windows Vista. Кроме того, в статье перечислены подходы к тестированию и возможные методы исправления большинства проблем с совместимостью.

[](#mainsection)[К началу страницы](#mainsection)

### Средства и ресурсы

В этом разделе представлены обзоры некоторых возможностей и технологий Windows Vista, которые разработаны для устранения проблем совместимости приложений, а также соответствующие ссылки.

#### Помощник по совместимости программ

Автоматически задает надлежащий "режим совместимости" для приложений, разработанных для предыдущих версий Windows. Когда Windows Vista обнаруживает приложения, которые должны запускаться в режиме совместимости с Windows XP, Windows 2000 или более поздними версиями Windows, операционная система требует автоматического обновления приложений для работы в Windows Vista без дальнейшего вмешательства пользователя.

Дополнительные сведения см. на странице [Помощник по совместимости программ: вопросы и ответы](http://windowshelp.microsoft.com/windows/en-us/help/82c0440d-553e-47e9-b4bd-6c2d10df4de71033.mspx) на веб-узле Центра справки и поддержки Windows Vista (на английском языке).

#### Мастер совместимости программ

Мастер совместимости программ, который входит в состав Windows Vista, используется в случаях, когда программа, созданная для предыдущей версии Windows, не работает надлежащим образом. Мастер поможет установить параметры совместимости для программы, что устранит проблему совместимости для многих старых программ.

Чтобы получить доступ к мастеру совместимости программ, дважды щелкните значок **Мастер совместимости программ** на рабочем столе.

Дополнительные сведения см. на странице [Запуск более старых программ в данной версии Windows](http://windowshelp.microsoft.com/windows/en-us/help/bf416877-c83f-4476-a3da-8ec98dcf5f101033.mspx) на веб-узле Центра справки и поддержки Windows Vista (на английском языке).

![](/security-updates/images/Bb629463.warning(ru-ru,MSDN.10).gif) **Предупреждение.**

Не запускайте мастер совместимости программ для более старых антивирусных программ, программ для дисков или других системных программ, так как это может привести к потере данных или создать угрозу безопасности. Используйте только те версии таких программ, которые разработаны специально для Windows Vista.

#### Microsoft Standard User Analyzer

Это средство для обеспечения совместимости приложений позволяет разработчикам и ИТ-специалистам диагностировать проблемы, которые будут препятствовать надлежащей работе программы без административных привилегий. При тестировании приложения с помощью Standard User Analyzer можно определить проблемы с доступом к файлам и реестру, маркерами и другими защищенными областями операционной системы.

В Windows Vista даже администраторы по умолчанию запускают большинство программ с обычными привилегиями пользователя. Это средство позволяет гарантировать, что административный доступ не будет являться обязательным для приложения. Результаты проверки отображаются в простом графическом интерфейсе.

Это средство можно загрузить со страницы [Microsoft Standard User Analyzer](http://www.microsoft.com/downloads/details.aspx?familyid=df59b474-c0b7-4422-8c70-b0d9d3d2f575&displaylang=en) центра загрузки Microsoft (на английском языке).

#### Набор средств для обеспечения совместимости приложений

Корпорация Майкрософт разработала набор средств и документации, который помогает организациям определять свой комплект приложений и управлять им. Набор средств для обеспечения совместимости приложений Windows (ACT) предназначен для снижения затрат средств и времени на разрешение проблем с совместимостью приложений. Он обеспечивает быстрое развертывание Windows Vista.

Набор ACT позволяет подготовиться к использованию Windows Vista благодаря инвентаризации существующих приложений, управлению критически важными приложениями и определению той части среды приложений, которой следует уделить особое внимание при подготовке к развертыванию Windows** **Vista.

В настоящее время доступен набор ACT 4.1, который предназначен для облегчения развертывания Windows** **XP с пакетом обновления 2 (SP2). ACT 4.1 анализирует интерфейсы DCOM, параметры брандмауэра и проблемы с Internet Explorer. ACT определяет приложения, которые требуют дополнительного тестирования, устарели или уже совместимы с пакетом обновления 2 (SP2), что дает возможность расставить приоритеты.

Обновленный набор ACT 5.0 поддерживает функции безопасности Windows Vista.

К улучшениям этого набора средств относятся:

-   новые средства оценки совместимости с Windows Vista;

-   обновленный интерфейс пользователя, который позволяет централизованно управлять параметрами средства оценки;

-   новые возможности упорядочения данных, которые позволяют классифицировать приложения и расставлять приоритеты;

-   возможности анализа данных, позволяющие просматривать полные отчеты о совместимости;

-   Интернет-сообщество, которое дает клиентам и независимым поставщикам программных продуктов возможность обмениваться информацией о собственных результатах тестирования совместимости приложений.

Дополнительные сведения об этом наборе средств см. на странице [Совместимость приложений Windows](http://www.microsoft.com/technet/prodtechnol/windows/appcompatibility/default.mspx) на веб-узле TechNet.

##### Временные решения

Кроме средств и ресурсов для обеспечения совместимости приложений, для решения проблем с совместимостью приложений, полное устранение которых займет значительное время, можно использовать дополнительные технологии Майкрософт. Эти технологии разработаны для обеспечения миграции на Windows Vista и поддержки важных приложений, несовместимых с Windows Vista. Эти возможности перечислены ниже.

-   **Virtual PC**. Virtual PC можно использовать для запуска в Windows Vista приложений, которые правильно работают только в предыдущих версиях Windows. Virtual PC позволяет использовать предыдущую версию Windows для запуска несовместимых приложений в среде Windows Vista до разработки их обновленных версий. Дополнительные сведения см. на веб-узле [Microsoft Virtual PC](http://www.microsoft.com/windows/virtualpc/default.mspx) узла Microsoft.com (на английском языке).

-   **Службы терминалов для размещения приложений**. Размещение более старых приложений с помощью служб терминалов позволяет использовать приложения для системы Windows или сам рабочий стол Windows практически на всех вычислительных устройствах в сети. Для доступа к старым приложениям клиенты Windows Vista могут подключаться к средам, в которых они размещены, с помощью удаленного рабочего стола. Дополнительные сведения см. в статье [Технический обзор служб терминала Windows Server 2003](http://www.microsoft.com/windowsserver2003/techinfo/overview/termserv.mspx) на веб-узле Microsoft Windows Server 2003 R2 (на английском языке).

-   **Виртуальный сервер для размещения приложений**. Среда виртуального сервера позволяет размещать приложения прежних версий и поддерживает удаленные подключения конечных пользователей, которым требуется доступ к этим приложениям. В сочетании с Windows Server 2003 виртуальный сервер Virtual Server 2005 R2 предоставляет платформу виртуализации, которая позволяет выполнять большинство основных операционных систем *x*86 в гостевой среде и поддерживается корпорацией Майкрософт для размещения операционных систем Windows Server и приложений Microsoft Windows Server System™. Дополнительные сведения см. в статье [Virtual Server 2005 R2: обзор продукта](http://www.microsoft.com/windowsserversystem/virtualserver/evaluation/vsoverview.mspx) на веб-узле Microsoft Virtual Server (на английском языке).

[](#mainsection)[К началу страницы](#mainsection)

### Дополнительные сведения

Ниже приведены ссылки на дополнительные сведения по вопросам, связанным с совместимостью приложений.

-   [Защита ресурсов Windows](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wfp/setup/about_windows_file_protection.asp) на веб-узле Microsoft MSDN® (на английском языке).

-   [*Руководство по совместимости приложений*](http://go.microsoft.com/fwlink/?linkid=74194) на веб-узле TechNet (на английском языке).

-   [Введение в API защищенного режима](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/protmode/overviews/pmie_intro.asp) на веб-узле MSDN (на английском языке).

-   [Запуск более старых программ в данной версии Windows](http://windowshelp.microsoft.com/windows/en-us/help/bf416877-c83f-4476-a3da-8ec98dcf5f101033.mspx) на веб-узле Центра справки и поддержки Windows Vista (на английском языке).

-   [Набор средств для обеспечения совместимости приложений 5.0](http://www.microsoft.com/technet/windowsvista/appcompat/act5feat.mspx) на веб-узле TechNet (на английском языке).

-   [Microsoft Standard User Analyzer](http://www.microsoft.com/downloads/details.aspx?familyid=df59b474-c0b7-4422-8c70-b0d9d3d2f575&displaylang=en) на веб-узле центра загрузки Microsoft (на английском языке).

-   [Решения Майкрософт для виртуализации](http://www.microsoft.com/windowsserversystem/virtualization/default.mspx) на веб-узле Microsoft.com (на английском языке).

-   [Помощник по совместимости программ: вопросы и ответы](http://windowshelp.microsoft.com/windows/en-us/help/82c0440d-553e-47e9-b4bd-6c2d10df4de71033.mspx) на веб-узле Центра справки и поддержки Windows Vista (на английском языке).

-   [Технический обзор служб терминала Windows Server 2003](http://www.microsoft.com/windowsserver2003/techinfo/overview/termserv.mspx) на веб-узле Microsoft.com (на английском языке).

-   Статья [История разработчика Windows Vista: секреты совместимости приложений](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnlong/html/appcomp.asp)на веб-узле MSDN (на английском языке).

-   [Совместимость приложений Windows](http://www.microsoft.com/technet/prodtechnol/windows/appcompatibility/default.mspx) на веб-узле TechNet (на английском языке).

**Загрузить**

[Получите руководство по безопасности системы Windows Vista](http://go.microsoft.com/fwlink/?linkid=74028)

**Уведомления об обновлении**

[Подпишитесь, чтобы вовремя узнавать об обновлениях и новых выпусках](http://go.microsoft.com/fwlink/?linkid=54982)

**Обратная связь**

[Отправляйте свои комментарии и предложения](mailto:secwish@microsoft.com?subject=windows%20vista%20security%20guide)

[](#mainsection)[К началу страницы](#mainsection)
