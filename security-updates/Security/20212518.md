---
TOCTitle: 'Управление идентификаторами и доступом: платформа и инфраструктура'
Title: 'Управление идентификаторами и доступом: платформа и инфраструктура'
ms:assetid: 'bb00bbf8-72ad-4d90-a44b-44fe89d6e508'
ms:contentKeyID: 20212518
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Dd546904(v=TechNet.10)'
---

Платформа и инфраструктура
==========================

### Глава 5: Реализация инфраструктуры

Опубликовано 5 ноября 2004 | Обновлено 26/06/2006

В предыдущих главах этого документа были приведены сведения о типичных проблемах, требованиях и проекте инфраструктуры управления идентификаторами и доступом. В данной главе содержатся рекомендации по подготовке инфраструктуры Contoso Pharmaceuticals. В ней также представлены средства и шаблоны, которые можно использовать для создания базовой среды, что является обязательным условием реализации для остальных документов этой серии.

Это руководство было создано, чтобы помочь консультантам и клиентам в создании сценариев решений по управлению идентификаторами и доступом от Майкрософт в экспериментальных условиях.

##### На этой странице

[](#ecaa)[Средства и шаблоны](#ecaa)
[](#ebaa)[Обзор служб инфраструктуры](#ebaa)
[](#eaaa)[Базовая реализация](#eaaa)

### Средства и шаблоны

Пакет инструментов «Identity and Access Management» (Управление идентификаторами и доступом), доступный для загрузки, содержит файл **Identity and Access Management Tools and Templates.msi** — программу установки средств и шаблонов. Полученная в результате выполнения программы установки структура папок будет выглядеть примерно так, как изображенная на следующем рисунке (в зависимости от того, куда была выполнена установка).

![](/security-updates/images/Dd546904.Plat5-1(ru-ru,TechNet.10).gif)

**Рис. 5.1. Структура папок «Средства и шаблоны»**

**Примечание**   В процессе установки пакета Tools and Templates MSI может произойти ошибка. Дополнительные сведения см. в файле Readme.htm серии статей по управлению идентификаторами и доступом.

В число средств и шаблонов, являющихся частью этого пакета, включены сценарии на основе текста, образцы кода и файлы конфигурации, связанные с управлением идентификаторами и доступом, однако выполняемые файлы или скомпилированный код в этот список не входят.

**Примечание**   Образцы представлены только в качестве примеров. Прежде чем использовать эти средства и шаблоны в производственной среде, обязательно изучите, настройте и протестируйте их.

#### Папка: Baseline

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Имя файла</th>
<th style="border:1px solid black;" >Назначение</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">ADBaseline.vbs</td>
<td style="border:1px solid black;">Сценарий Microsoft® Visual Basic®, с помощью которого создается несколько организационных элементов (OU) компании Contoso Pharmaceuticals и пользователей в лесу службы каталогов Microsoft Active Directory®, что потребуется для использования в следующих документах этой серии статей.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ExchangeBaseline.vbs</td>
<td style="border:1px solid black;">Сценарий Microsoft Visual Basic, с помощью которого создаются необходимые группы хранилищ Contoso Exchange и хранилища Mailbox для поддержки пользователей Contoso в интрасети.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">IntranetADData.txt</td>
<td style="border:1px solid black;">Файл, содержащий имена основных организационных элементов, групп и пользователей внутреннего каталога Active Directory в виде списка, разделенного точками с запятой. Этот файл используется сценариями ADBaseline.vbs и ExchangeBaselin.vbs.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ExtranetADData.txt</td>
<td style="border:1px solid black;">Файл, содержащий имена основных организационных элементов, групп и пользователей внешнего каталога Active Directory в виде списка, разделенного точками с запятой. Этот файл используется сценарием ADBaseline.vbs.</td>
</tr>
</tbody>
</table>
  
[](#mainsection)[К началу страницы](#mainsection)
  
### Обзор служб инфраструктуры
  
Инфраструктура управления идентификаторами и доступом компании Contoso Pharmaceuticals построена в соответствии с рекомендациями концептуальных проектов служб, приведенными на странице [Эталонная архитектура серверных систем Windows](http://go.microsoft.com/fwlink/?linkid=67370) (WSSRA).
  
В частности, компанией Contoso для поддержки своих инициатив в области управления идентификаторами и доступом реализованы следующие службы Microsoft.
  
-   Сетевые службы, включая службу доменных имен (DNS) и протокол динамической конфигурации сетевого узла (DHCP), поставляемые с Microsoft Windows Server™ 2003.
  
-   Службы каталогов, включая лес Active Directory в интрасети и лес Active Directory во внешней сети, предоставляемые Windows Server 2003.
  
-   Службы сертификатов, включая трехзвенную инфраструктуру открытого ключа (PKI), поставляемые с Windows Server 2003.
  
-   Службы веб-приложений, предоставленные службами IIS 6.0, входящими в поставку Windows Server 2003.
  
-   Службы промежуточного программного обеспечения, предоставленные Microsoft .NET Framework и работающие на Windows Server 2003.
  
-   Службы прокси и брандмауэра, поставляемые с Microsoft Internet Security and Acceleration (ISA) Server 2000 и работающие на Windows Server 2003.
  
**Примечание**   Компанией Contoso Pharmaceuticals было принято решение об использовании теневых учетных записей в лесу Active Directory во внешней сети вместо реализации доверия между внешним и внутренним лесами Active Directory, как описано в руководстве по архитектуре WSSRA.
  
Кроме того, компанией Contoso были реализованы рекомендации по жизненному циклу служб сообщений, часть эталонной архитектуры Windows Server System Reference Architecture, как описано в разделе [Введение: Службы сообщений](http://go.microsoft.com/fwlink/?linkid=67371).
  
В целях проведения испытаний, службы сообщений компании Contoso выполняются на одном компьютере, работающем под управлением операционной системы Windows Server 2003 и сервера Microsoft Exchange 2003.
  
#### Безопасность инфраструктуры
  
Безопасность всех серверов Windows Server 2003 в среде Contoso обеспечена настройками согласно соответствующим рекомендациям из [*Руководства по безопасности сервера Windows Server 2003*](http://go.microsoft.com/fwlink/?linkid=14845).
  
[](#mainsection)[К началу страницы](#mainsection)
  
### Базовая реализация
  
Сценарий компании Contoso Pharmaceuticals содержит некоторое количество групп, пользователей и других базовых элементов конфигурации, наличие которых в среде компании необходимо для правильной работы последующих сценариев решений, описанных в этой серии статей.
  
В данном разделе описывается настройка базовой среды Contoso на основе служб, описанных ранее в настоящем документе, включая:
  
-   Компьютер в интрасети под управлением Exchange Server 2003, на котором расположены необходимые почтовые ящики пользователей домена интрасети и групп хранения;
  
-   лес Active Directory в интрасети, содержащий необходимые организационные элементы, группы и пользователей;
  
-   лес Active Directory во внешней сети, содержащий необходимые организационные элементы, группы и пользователей.
  
#### Наполнение среды Contoso Exchange
  
Среда Contoso Exchange является главной системой электронной почты для пользователей Contoso. Создание пользователей Contoso возможно только после создания необходимых групп хранения и хранилищ почтовых ящиков. Выполните этот сценарий из командной строки, используя файл cscript.exe в качестве сервера сценария.
  
##### Использование сценария ExchangeBaseline.vbs
  
Выполните сценарий ExchangeBaseline.vbs, используя исполняемый файл cscript в качестве сервера сценария. Убедитесь, что сценарий выполняется должным образом в командной строке, как показано ниже.
  
```  
CSCRIPT.EXE ExchangeBaseline.vbs &lt;param1&gt;   
```  
Сценарий принимает следующий аргумент:
  
**/s** — Обязательный. Обозначает целевой сервер Exchange Server, к которому необходимо подключиться.
  
Ниже приведен пример команды для выполнения этого сценария из командной строки.
  
```  
Cscript.exe ExchangeBaseline.vbs /s &lt;hostname&gt;   
```  
**Примечание**   Выполнение этого сценария может потребовать нескольких минут из-за продолжительности процесса создания хранилищ почтовых ящиков в Microsoft Exchange.
  
**Настройка среды Exchange**
  
1.  Войдите в систему на сервере Contoso Exchange Server с правами администратора.
  
2.  Щелкните кнопку **Пуск**, выберите пункт **Выполнить**, затем в строке **Открыть** введите cmd.exe и щелкните кнопку **OK**.
  
3.  Выполните файл **ExchangeBaseline.vbs**, используя cscript.exe в качестве сервера сценария.
  
4.  Убедитесь, что в командной строке при выполнении сценария вы ввели слкдующее:
  
    ```  
Cscript.exe ExchangeBaseline.vbs /s FFL-NA-MSG-01   
```
  
    **Внимание**   Замените FFL-NA-MSG-01 именем своего сервера Exchange Server.
  
5.  Убедитесь, что сценарий возвращает следующее сообщение подтверждения для всех операций:  
    Завершено успешно.
  
При возникновении каких-либо ошибок после запуска сценария, устраните проблему и запустите сценарий повторно.
  
#### Наполнение леса Active Directory в интрасети
  
Лес na.contoso.com службы Active Directory в интрасети компании Contoso является главным каталогом Contoso в интрасети. С помощью сценария ADBaseline.vbs создаются соответствующие организационные элементы, пользователи и группы, необходимые для использования в сценариях решений Contoso далее в этой серии статей.
  
##### Использование сценария ADBaseline.vbs
  
Выполните сценарий ADBaseline.vbs, используя исполняемый файл cscript в качестве сервера сценария. Убедитесь, что сценарий выполняется должным образом в командной строке, как показано ниже.
  
```  
CSCRIPT ADBaseline.vbs &lt;param1&gt; &lt;param2&gt; &lt;param3&gt; &lt;param4&gt;   
```  
Сценарий принимает следующие аргументы.
  
**/t** — Обязательный. Обозначает целевую среду, которую необходимо подготовить (для данного сценария целевой средой является интрасеть).
  
**/s** — Обязательный. Обозначает целевой контроллер домена для Active Directory.
  
**/m** — Только для интрасети. Обозначает целевой сервер Exchange Server, привязку к которому необходимо создать. Этот аргумент игнорируется для внешней сети.
  
**/f** — Дополнительный. Обозначает целевой файл данных, содержащий сведения о пользователе интрасети Contoso. По умолчанию, сценарием используется файл IntranetADData.txt.
  
Ниже приведен пример команды для выполнения этого сценария из командной строки.
  
**Примечание**   Для удобства прочтения строка была разбита на несколько строк. Однако, испытывая эту команду в системе, необходимо ввести ее всю целиком в виде одной строки, без переноса строк.
  
```  
Cscript.exe ADBaseline.vbs /t intranet /s &lt;domain controller&gt; /m &lt;Exchange Server&gt; /f IntranetADData.txt   
```  
Можно также выполнить этот сценарий удаленно. Для этого необходимо убедиться, что рабочее место относится к целевому домену, и войти в систему в качестве администратора домена.
  
**Настройка леса na.corp.contoso.com**
  
1.  Войдите в систему в домене Contoso Exchange Server с правами администратора.
  
    **Примечание**   Необходимо выполнить сценарий с сервера Exchange Server, чтобы получить доступ к соответствующим библиотекам Exchange и создать целевые почтовые ящики пользователей.
  
2.  Щелкните кнопку **Пуск**, выберите пункт **Выполнить**, затем в строке **Открыть** введите cmd.exe и щелкните кнопку **OK**.
  
3.  В командной строке выполните сценарий ADBaseline.vbs, используя следующую команду.
  
    **Примечание**   Для удобства прочтения строка была разбита на несколько строк. Однако, используя эту команду в системе, необходимо ввести ее всю целиком в виде одной строки, без переноса строк.
  
    ```  
Cscript.exe ADBaseline.vbs /t intranet /s FFL-NA-DC-01  /m FFL-NA-MSG-01 /f IntranetADData.txt  
```
  
    **Примечание**   Замените *FFL-NA-DC-01* именем своего контроллера домена интрасети и  
    *FFL-NA-MSG-01* именем своего сервера Exchange Server.
  
4.  Убедитесь, что сценарий возвращает следующее сообщение подтверждения для всех операций:  
    Завершено успешно.
  
При возникновении каких-либо ошибок после запуска сценария, устраните проблему и запустите сценарий повторно.
  
#### Наполнение леса Active Directory во внешней сети
  
Домен perimeter.contoso.com службы Active Directory компании Contoso является лесом внешней сети Contoso. Как и при выполнении предыдущей операции, используйте сценарий ADBaseline.vbs для наполнения этого леса
  
**Настройка леса perimeter.contoso.com**
  
1.  Войдите в систему на контроллере домена perimeter.contoso.com компании Contoso с правами администратора домена.
  
2.  Щелкните кнопку **Пуск**, выберите пункт **Выполнить**, затем в строке **Открыть** введите cmd.exe и щелкните кнопку **OK**.
  
3.  В командной строке выполните сценарий ADBaseline.vbs, используя следующую команду.
  
    **Примечание**   Для удобства прочтения строка была разбита на несколько строк. Однако, используя эту команду в системе, необходимо ввести ее всю целиком в виде одной строки, без переноса строк.
  
    ```  
Cscript.exe ADBaseline.vbs /t extranet /s FFL-CP-DC-01 /f ExtranetADData.txt  
```
  
    **Примечание**   Замените *FFL-CP-DC-01* именем своего контроллера домена внешней сети.
  
4.  Убедитесь, что сценарий возвращает следующее сообщение подтверждения для всех операций:  
    Завершено успешно.
  
При возникновении каких-либо ошибок после запуска сценария, устраните проблему и запустите сценарий повторно.
  
**Загрузить**
  
[Получить серию статей по управлению идентификаторами и доступом от Майкрософт](http://go.microsoft.com/fwlink/?linkid=14842)
  
**Уведомления об обновлениях**
  
[Подписаться, чтобы получать уведомления об обновлениях и новых выпусках](http://go.microsoft.com/fwlink/?linkid=54982)
  
**Обратная связь**
  
[Отправить свои замечания или предложения](mailto:secwish@microsoft.com?subject=microsoft%20identity%20and%20access%20management%20series)
  
[](#mainsection)[К началу страницы](#mainsection)
