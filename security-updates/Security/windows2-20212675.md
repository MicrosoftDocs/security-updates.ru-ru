---
TOCTitle: 'Фундаментальное руководство по расследованию компьютерных происшествий для Windows. Глава 2: сбор данных'
Title: 'Фундаментальное руководство по расследованию компьютерных происшествий для Windows. Глава 2: сбор данных'
ms:assetid: '89ae3bbe-057c-4d3e-99e1-f7356321c01f'
ms:contentKeyID: 20212675
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc162837(v=TechNet.10)'
---

Фундаментальное руководство по расследованию компьютерных происшествий для Windows
==================================================================================

### Глава 2: сбор данных

Опубликовано 11 января 2007

В этой главе описывается процесс сбора необходимых для проведения расследования данных. Некоторые данные расследований непостоянны, в значительной степени изменчивы и легко могут быть модифицированы или повреждены. Поэтому перед проведением анализа необходимо убедиться, что данные должным образом собраны и сохранены. Используйте показанную на рисунке ниже процедуру, состоящую из трех последовательных действий.

![](images/Cc162837.fff0169f-2011-4eb8-870f-f83eedaa5942(ru-ru,TechNet.10).gif)

**Рисунок 2.1. Этап сбора данных модели расследования компьютерных происшествий**

##### На этой странице

[](#edaa)[Создание набора средств для проведения расследования компьютерного происшествия](#edaa)
[](#ecaa)[Сбор данных](#ecaa)
[](#ebaa)[Хранение и архивирование](#ebaa)

### Создание набора средств для проведения расследования компьютерного происшествия

Для сбора данных в процессе проведения расследования организации необходимо подготовить набор аппаратных и программных средств. Такой набор средств может включать портативный компьютер с соответствующими программными средствами, операционные системы и исправления, носители с приложениями, защищенные от записи устройства резервного копирования, чистые носители, базовое сетевое оборудование и кабели. В идеале такой набор инструментов следует создавать заранее, чтобы члены группы могли ознакомиться с ним до проведения расследования.

![](images/Cc162837.note(ru-ru,TechNet.10).gif) **Примечание.**

Перечень рекомендуемых программных средств, которые могут быть включены в набор средств для проведения расследования компьютерного происшествия, а также рекомендации для создания такого набора средств, приведены в разделах «Подготовка организации к проведению расследования компьютерного происшествия» и «Средства» части [Приложение: ресурсы](https://technet.microsoft.com/ru-ru/library/a9a5c2a9-cce3-4edb-a92c-10983899240a(v=TechNet.10)) данного руководства.

[](#mainsection)[К началу страницы](#mainsection)

### Сбор данных

Сбор данных, являющихся цифровыми доказательствами, может производиться как локально, так и удаленно по сети. Локальный сбор данных обладает преимуществом в виде большего контроля над затронутыми компьютерами и данными. Но такой способ не всегда осуществим (например, если компьютеры находятся в запертых комнатах или в других местах или если затронуты серверы, требующие бесперебойной работы). Другие факторы, такие как секретность проводимого расследования, природа собираемых доказательств и временные рамки проведения расследования, определяют, в конечном счете, будет сбор доказательств производиться локально или по сети.

![](images/Cc162837.important(ru-ru,TechNet.10).gif) **Важно!**

При использовании средств для сбора данных сначала необходимо определить, установлены ли на компьютере скрытые программы для захвата административных прав. Такие программы получают полный контроль над компьютером и скрывают свое присутствие от стандартных средств диагностики. Из-за того что скрытые программы для захвата административных прав работают с оборудованием на низком уровне, они могут перехватывать и изменять системные вызовы. Такое приложение нельзя обнаружить простым поиском исполняемого файла, потому что оно удалит себя из списка найденных файлов. Сканирования портов также не позволяют обнаружить, что используемые такими программами порты открыты, потому что скрытые программы для захвата административных прав предотвращают обнаружение открытых портов сканерами. Убедиться в отсутствии скрытых программ очень тяжело. Одним из доступных инструментов для обнаружения таких программ является программа Microsoft® Windows® Sysinternals [RootkitRevealer](http://go.microsoft.com/?linkid=6013255).

При сборе данных по сети необходимо учитывать тип собираемых данных и затрачиваемые на это усилия. Нужно определить, с помощью каких данных можно будет выдвинуть против совершивших правонарушения сторон обвинения. Например, может потребоваться собрать данные с нескольких компьютеров через различные сетевые подключения, а может оказаться достаточным скопировать логический раздел всего с одного компьютера.

Ниже приведена рекомендуемая процедура сбора данных.

1.  Создайте точную документацию, с помощью которой в дальнейшем можно будет определить и проверить подлинность полученных доказательств. Необходимо убедиться, что перечислены все потенциально интересные вопросы и все действия, которые могут быть важны в дальнейшем в процессе расследования. Ключом к успешному расследованию является надлежащая документация, включающая в себя перечисленную ниже информацию:

    -   кто и почему совершил то или иное действие. Чего эти лица пытались добиться;

    -   как было совершено то или иное действие, включая использованные средства и процедуры;

    -   когда было совершено то или иное действие (дата и время), и его результаты.

2.  Определите используемые методы проведения расследования. Обычно используется сочетание автономного и неавтономного методов расследования:

    -   автономный метод расследования подразумевает дополнительный анализ точной (побитовой) копии исходного доказательства. (Побитовая копия является полной копией всех данных источника, включая такую информацию, как содержимое загрузочного сектора, разделов и неразмеченного дискового пространства). По возможности следует использовать автономный метод, потому что это снижает риск повреждения исходных улик. Тем не менее, этот метод подходит только для случаев, когда возможно создание образа. Он не может быть использован для сбора некоторых изменчивых данных;

    -   неавтономный метод расследования подразумевает проведение анализа настоящего, исходного доказательства. Такой метод необходимо использовать с особой осторожностью, потому что есть риск изменить доказательство, которое в дальнейшем может потребоваться при рассмотрении дела.

3.  Определите и документально оформите возможные источники данных, включая следующие источники:

    -   серверы. Информация о серверах включает их роли, журналы (например журнал событий), файлы и приложения;

    -   журналы сетевых устройств, которые подключены к внешней и внутренней сети, таких как брандмауэры, маршрутизаторы, прокси-серверы, серверы сетевого доступа (NAS) и системы обнаружения вторжения (IDS). Вторжение могло происходить именно через эти устройства;

    -   внутренние компоненты оборудования, такие как сетевые платы (содержащие информацию о MAC-адресе) и устройства PCMCIA. Также стоит принять во внимание внешние порты, такие как Firewire, USB и PCMCIA;

    -   устройства хранения данных (внутренние и внешние), включая жесткие диски, сетевые устройства хранения данных, сменные носители. Также нельзя забывать о портативных устройствах, таких как КПК, смарт-телефоны и MP3-проигрыватели (например Zune™).

4.  При сборе изменяющихся данных необходимо учитывать порядок сбора данных. Изменяющиеся доказательства легко могут быть уничтожены. Такая информация, как перечень запущенных процессов, данные в оперативной памяти, таблицы маршрутов и временные файлы могут быть безвозвратно утрачены при выключении компьютера. В разделе «Средства» части [Приложения: ресурсы](http://www.microsoft.com/rus/technet/security/guidance/disasterrecovery/computer_investigation/a9a5c2a9-cce3-4edb-a92c-10983899240a.mspx) данного руководства приводится информация о средствах и командах, с помощью которых можно осуществлять сбор таких данных.

5.  Для сбора данных с устройств хранения и записи информации о настройках этих устройств используются приведенные ниже методы:

    -   для извлечения внутреннего устройства хранения данных сначала необходимо выключить компьютер. Но перед выключением компьютера необходимо убедиться, что были собраны все возможные непостоянные данные;

    -   необходимо определить, существует ли возможность извлечь носитель из подозрительного компьютера и произвести сбор данных с этого носителя, подключив его к другому компьютеру. Из-за возможных проблем с совместимостью оборудования это не всегда возможно. К примеру, не стоит извлекать такие устройства, как RAID, устройства хранения, зависимые от оборудования (например устаревшее оборудование), или устройства сетевых систем хранения данных, таких как сети областей хранения (SAN);

    -   создайте побитовую резервную копию доказательства и убедитесь, что исходные данные защищены от записи. Последующий анализ данных нужно проводить с использованием этой копии, а не исходного доказательства. Пошаговое руководство по созданию образов выходит за рамки данного руководства, но является неотъемлемой частью сбора доказательств.

        ![](images/Cc162837.important(ru-ru,TechNet.10).gif) **Важно!**

        Для получения побитовой копии используйте признанные в сфере работы с образами инструменты, например программу EnCase компании [Guidance Software](http://www.guidancesoftware.com/) или программу FTK компании [AccessData](http://www.accessdata.com/).

    -   Документально оформите внутренние хранилища данных и не забудьте включить информацию об их настройках. К такой информации относятся, в частности, производитель и модель устройства, параметры установки перемычек и размеры устройства. Также необходимо включить в документацию тип интерфейса и состояние устройства.

6.  Проверьте собранные данные. По возможности используйте контрольные суммы и цифровую подпись данных, чтобы убедиться, что скопированные данные совпадают с исходными. При определенных обстоятельствах (например при наличии на устройстве хранения данных сбойного сектора) создание идеальной копии может оказаться невозможным. Убедитесь, что вы получили наилучшую с учетом доступных средств и ресурсов копию данных. Для вычисления криптографических хэш-значений MD5 и SHA1 для содержимого файлов можно воспользоваться программой [Средство проверки целостности контрольных сумм файлов корпорации Майкрософт](http://www.microsoft.com/downloads/details.aspx?familyid=b3c93558-31b7-47e2-a663-7365c1686c08&displaylang=en) (FCIV).

[](#mainsection)[К началу страницы](#mainsection)

### Хранение и архивирование

Когда собранные доказательства готовы для анализа, необходимо сохранить и заархивировать эти улики, чтобы обеспечить их безопасность и целостность. Необходимо следовать принятым в организации процедурам хранения и архивирования данных.

Ниже приведены рекомендации по архивированию и хранению данных:

-   физически обезопасьте доказательства и храните их в защищенном месте;

-   убедитесь в отсутствии возможности несанкционированного доступа к доказательствам по сети или иным способом. Документально оформите перечень лиц, у которых есть физический или сетевой доступ к уликам;

-   защитите оборудование, на котором хранятся доказательства, от электромагнитного воздействия. Используйте решения для защиты этого оборудования от статического электричества;

-   создайте как минимум две копии собранных доказательств и храните одну копию в безопасном месте за пределами организации;

-   убедитесь, что улики защищены физически (например помещены в сейф) и с помощью цифровых методов защиты (например с помощью установки пароля для доступа к устройству хранения);

-   четко документально оформите порядок обеспечения сохранности доказательств. Используйте журнал регистрации изъятия и возврата, в который будет заноситься такая информация, как имя лица, изучавшего доказательство, точные дата и время изъятия и возврата улики. В качестве примера в части [Приложение: ресурсы](https://technet.microsoft.com/ru-ru/library/a9a5c2a9-cce3-4edb-a92c-10983899240a(v=TechNet.10)) данного руководства приводится пример документа **Рабочий журнал — документы для регистрации цепочки обеспечения сохранности доказательств**.

[](#mainsection)[К началу страницы](#mainsection)

**Загрузка**

[Загрузить фундаментальное руководство по расследованию компьютерных происшествий для Windows.](http://go.microsoft.com/fwlink/?linkid=80345)

**Уведомления об обновлениях**

[Подписаться на уведомления об обновлениях и новых выпусках](http://go.microsoft.com/fwlink/?linkid=54982)

**Обратная связь**

[Отправить замечания или пожелания](mailto:secwish@microsoft.com?subject=fundamental%20computer%20investigation%20guide%20for%20windows)

[](#mainsection)[К началу страницы](#mainsection)
