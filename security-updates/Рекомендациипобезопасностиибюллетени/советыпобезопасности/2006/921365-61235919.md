---
TOCTitle: 921365
Title: 'Советы по безопасности (Microsoft) 921365'
ms:assetid: 921365
ms:contentKeyID: 61235919
ms:mtpsurl: 'https://technet.microsoft.com/ru-RU/library/921365(v=Security.10)'
---

Security Advisory

Советы по безопасности (Microsoft) 921365
=========================================

Уязвимость в программе Microsoft Excel делает возможным удаленное выполнение кода
---------------------------------------------------------------------------------

Дата публикации: 19 июня 2006 г. | Дата обновления: 21 июня 2006 г.

Корпорация Майкрософт изучает новые сообщения об ограниченном количестве атак типа zero-day с использованием уязвимости в приложениях Microsoft Excel 2003, Excel Viewer 2003, Excel 2002, Excel 2000, Microsoft Excel 2004 для Mac и Microsoft Excel X для Mac. Чтобы злоумышленник мог воспользоваться этой уязвимостью, пользователь должен открыть вредоносный файл Excel, вложенный в сообщение электронной почты или иным способом предоставленный злоумышленником.

Пользователям настоятельно рекомендуется проявлять особую осторожность при открытии подозрительных вложений от известных и неизвестных отправителей. Для регулярного удаления вредоносных программ, которые используют данную уязвимость, корпорация Майкрософт добавила возможность обнаружения в центр [Windows Live Safety Center](http://safety.live.com/).

Кроме того, корпорация Майкрософт активно обменивается информацией с партнерами по организации Microsoft Security Response Alliance с целью обновления функций обнаружения и устранения новых атак.

Пользователи из США и Канады, подозревающие, что их системы подвержены данной уязвимости, могут обратиться в [службу поддержки продуктов корпорации Майкрософт](http://go.microsoft.com/fwlink/?linkid=21131) по телефону 1-866-PCSAFETY. Звонки, связанные с обновлениями безопасности, обслуживаются бесплатно.

Пользователям в других странах для получения поддержки следует обращаться в местные представительства корпорации Майкрософт. Звонки, связанные с обновлениями безопасности, обслуживаются бесплатно. Для получения дополнительных сведений о службе поддержки корпорации Майкрософт посетите [веб-узел международной поддержки](http://go.microsoft.com/fwlink/?linkid=21155).

Закончив исследование, корпорация Майкрософт примет соответствующие меры для защиты пользователей. В их число может войти предоставление ежемесячного или внеочередного обновления безопасности (в зависимости от нужд пользователей).

### Общие сведения

Обзор
-----

<span></span>
**Назначение рекомендаций** Первоначальное уведомление пользователей об уязвимости, о которой сообщалось в открытых источниках. Дополнительные сведения см. в разделах «Методы обхода проблемы и факторы, снижающие опасность уязвимости» и «Предлагаемые действия».

**Состояние рекомендаций** Проблема подтверждена, планируется выпустить обновление безопасности.

**Рекомендация** Не открывайте и не сохраняйте файлы Microsoft Excel, полученные из ненадежных источников или неожиданно полученные из надежных источников. Данная уязвимость может использоваться при открытии файла.

| Ссылки                   | Определение   |
|--------------------------|---------------|
| **Характеристика в CVE** | CVE-2006-3059 |

Данные рекомендации касаются следующего программного обеспечения.

|                                    |
|------------------------------------|
| Затронутое программное обеспечение |
| Microsoft Excel 2003               |
| Microsoft Excel Viewer 2003        |
| Microsoft Excel 2002               |
| Microsoft Excel 2000               |
| Microsoft Excel 2004 для Mac       |
| Microsoft Excel X для Mac          |

Вопросы и ответы
----------------

<span></span>
**Какова область действия данных рекомендаций?**
Корпорации Майкрософт известно о новой уязвимости приложения Microsoft Excel, входящего в состав пакета Microsoft Office. Она затрагивает программное обеспечение, перечисленное в разделе «Обзор».

**Требует ли эта уязвимость безопасности выпуска обновления корпорацией Майкрософт?**
Корпорация Майкрософт завершает разработку обновления безопасности для программы Microsoft Excel, устраняющего данную уязвимость.

**В чем причина уязвимости?**
Причина уязвимости в неправильной проверке памяти приложением Microsoft Excel.

**Каким образом злоумышленник может воспользоваться уязвимостью?**
В случае атаки через Интернет на веб-узле злоумышленника должен находиться файл Excel, предназначенный для использования этой уязвимости. Злоумышленник не может заставить пользователя посетить свой веб-узел. Вместо этого он старается склонить их посетить веб-узел, убеждая, как правило, щелкнуть ссылку.
При атаке через электронную почту злоумышленник может использовать уязвимость, отправив пользователю специальное сообщение и убедив его открыть файл.

**Какие версии приложения Microsoft Office Excel связаны с этими рекомендациями?**
Эти рекомендации предназначены для приложений Microsoft Excel 2003, Excel Viewer 2003, Excel 2002, Excel 2000, Microsoft Excel 2004 для Mac и Microsoft Excel X для Mac.

Факторы, снижающие опасность уязвимости удаленного выполнения кода в приложении Microsoft Excel
-----------------------------------------------------------------------------------------------

<span></span>
-   Злоумышленник, успешно воспользовавшийся данной уязвимостью, может получить те же самые права, которые имеет локальный пользователь. Риск для пользователей, учетные записи которых имеют ограниченные права, меньше, чем для пользователей, работающих с правами администратора.
-   В приложениях Excel 2002 и Excel 2003 уязвимость нельзя использовать автоматически посредством электронной почты. Чтобы атака достигла цели, при открытии вложения в сообщении электронной почты пользователь должен нажать кнопку **Открыть**, **Сохранить** или **Отмена**.
-   Этой уязвимостью нельзя воспользоваться автоматически при атаке через Интернет. Злоумышленнику необходимо разместить на своем веб-узле файл Office, предназначенный для использования этой уязвимости. Злоумышленник не может заставить пользователя посетить свой веб-узел. Вместо этого он старается склонить их посетить веб-узел, убеждая, как правило, щелкнуть ссылку.

**Примечание.** В приложении Excel 2000 перед открытием документа не предлагается выбрать **Открыть**, **Сохранить** или **Отмена**.

Методы обхода уязвимости удаленного выполнения кода в приложении Microsoft Excel
--------------------------------------------------------------------------------

<span></span>
Корпорация Майкрософт проверила представленные ниже методы обхода проблемы. Они не устраняют уязвимость, однако позволяют блокировать известные направления проведения атак. Если методы обхода снижают функциональность, в следующем разделе это отмечено особо.

#### Для предотвращения перехода приложения Excel 2003 в режим исправления в необходимо изменить настройки списка управления доступом (ACL) в разделе реестра Excel Resiliency.

Данная уязвимость приложения Excel используется при переходе в режим исправления. Предотвращение перехода в режим исправления позволяет блокировать использование уязвимости в приложении Excel 2003. Для предотвращения перехода в режим исправления необходимо изменить настройки списков управления доступом (ACL) с помощью редактора реестра либо групповой политики, которые позволяют запретить доступ к разделу реестра со всех учетных записей пользователей. Чтобы сделать это вручную, выполните следующие действия.

**Примечание.** Неправильное использование редактора реестра может привести к серьезным проблемам, для устранения которых, возможно, потребуется переустановить операционную систему. Корпорация Microsoft не гарантирует решение проблем, возникших в результате неправильной работы с редактором реестра. Ответственность за использование редактора реестра несет пользователь. Сведения о порядке редактирования реестра см. в разделе справки «Изменение параметров и их значений» редактора реестра (Regedit.exe) или в разделах справки «Добавление и удаление данных в реестре» и «Редактирование данных реестра» программы Regedt32.exe.

**Примечание**. Корпорация Майкрософт рекомендует перед редактированием реестра сделать его резервную копию.

**Для системы Windows 2000**

**Примечание.** Запишите разрешения, которые приведены в этом диалоговом окне, чтобы позже можно было восстановить их исходные значения.

1.  Нажмите кнопку **Пуск**, выберите пункт **Выполнить**, введите **regedt32** и нажмите кнопку **OK**.
2.  Разверните разделы **HKEY\_CURRENT\_USER**, **Software,Microsoft**, **Office**, **11.0**, **Excel** и откройте раздел **Resiliency**. Если раздел не существует, создайте его.
3.  Выделите этот раздел и нажмите кнопку **Безопасность**, а затем — **Разрешения**.
4.  Снимите флажок **Разрешить наследование разрешений от родительского объекта к этому объекту**. Появится запрос с вариантами **Копировать**, **Удалить** и **Отмена**. Щелкните **Удалить**, а затем нажмите кнопку **OK**.
5.  Появится сообщение о том, что никто не будет иметь доступ к данному разделу реестра. При появлении соответствующего запроса нажмите кнопку **Да**.

**Для системы Windows XP с пакетом обновления 1 (SP1) или более поздних операционных систем**

**Примечание.** Запишите разрешения, которые приведены в этом диалоговом окне, чтобы позже можно было восстановить их исходные значения.

1.  Нажмите кнопку **Пуск**, выберите команду **Выполнить**, введите **regedit** и нажмите кнопку **ОК**.
2.  Разверните разделы **HKEY\_CURRENT\_USER**, **Software,Microsoft**, **Office**, **11.0**, **Excel** и откройте раздел **Resiliency**. Если раздел не существует, создайте его.
3.  Выберите **Правка**, а затем щелкните **Разрешения**.
4.  Нажмите кнопку **Дополнительно**.
5.  Снимите флажок **Наследовать от родительского объекта применимые к дочерним объектам разрешения, добавляя их к явно заданным в этом окне.** Появится запрос с вариантами **Копировать**, **Удалить** и **Отмена**. Щелкните **Удалить**, а затем нажмите кнопку **OK**.
6.  Появится сообщение о том, что никто не будет иметь доступ к данному разделу реестра. Чтобы закрыть диалоговое окно **Разрешения** для данного раздела реестра, нажмите на кнопку **Да**, а затем — **OK**.

**Побочные эффекты** Режим восстановления в приложении Excel предназначен для открытия поврежденных документов Excel. После применения данного метода обхода уязвимости приложение Excel перестанет восстанавливать поврежденные документы Excel и после открытия искаженного документа Excel может восстанавливаться с ошибками. Если после открытия искаженного документа Excel приложение Excel работает нестабильно, завершите все процессы Excel посредством диспетчера задач и повторно запустите приложение Excel.

#### Для предотвращения непосредственного попадания документов Excel в корпоративную сеть, заблокируйте загрузку файлов Excel на шлюзе электронной почты.

**Примечание.** Этот способ не защитит от других направлений атак, в том числе атак через Интернет.

Следующие типы файлов являются файлами Excel, которые могут использовать данную уязвимость и которые необходимо заблокировать на уровне периметра сети:

**xls, xlt, xla, xlm, xlc, xlw, uxdc, csv, iqy, dqy, rqy, oqy, xll, xlb, slk, dif, xlk, xld, xlshtml, xlthtml, xlv.**

#### Заблокируйте возможность открытия документов Excel из вложений программы Outlook, с веб-узлов и непосредственно из файловой системы путем удаления разделов реестра, обеспечивающих связь документов Excel с приложением Excel.

При открытии документов Excel двойным щелчком во вложениях электронной почты, при посещении веб-узлов, загружающих документы Excel, а также из файловой системы или общих файлов они автоматически открываются в приложении Excel. Удаление следующих разделов реестра позволит заблокировать эти направления атак благодаря предотвращению загрузки документов Excel непосредственно в приложении Excel. Чтобы удалить эти разделы, выполните следующие действия.

**Примечание.** За все время существования данной уязвимости в приложениях Excel Viewer 2003, Excel 2002, и Excel 2000 она не была использована.

**Примечание.** Неправильное использование редактора реестра может привести к серьезным проблемам, для устранения которых, возможно, потребуется переустановить операционную систему. Корпорация Microsoft не гарантирует решение проблем, возникших в результате неправильной работы с редактором реестра. Ответственность за использование редактора реестра несет пользователь. Сведения о порядке редактирования реестра см. в разделе справки «Изменение разделов и их значений» редактора реестра (Regedit.exe) или в разделах «Добавление и удаление данных реестра» и «Редактирование данных реестра» программы Regedt32.exe
.

1.  **Для системы Windows 2000**
    **Нажмите кнопку Пуск**, выберите команду **Выполнить**, введите **regedt32** и нажмите кнопку **OK**.

    **Для системы Windows XP с пакетом обновления 1 (SP1) или более поздних операционных систем**
    Нажмите кнопку **Пуск**, выберите команду **Выполнить**, введите **regedit** и нажмите кнопку **OK**.

2.  В списке ниже выделите каждый раздел реестра.
3.  Щелкните правой кнопкой мыши на каждом разделе и выберите пункт **Удалить**. Для подтверждения удаления нажмите кнопку **Да**.

    **Примечание**. В зависимости от способа установки некоторые из приведенных ниже разделов могут отсутствовать.

    **Примечание.** Для восстановления удаленных разделов реестра корпорация Майкрософт рекомендует создавать их резервные копии.

    **HKEY\_CLASSES\_ROOT\\Excel.Addin\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Backup\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Chart\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Chart.8\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.CSV\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.DIF\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Macrosheet\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Sheet.8\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.SLK\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Template\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.Workspace\\shell**
    **HKEY\_CLASSES\_ROOT\\Excel.XLL\\shell**
    **HKEY\_CLASSES\_ROOT\\Excelhtmlfile\\shell**
    **HKEY\_CLASSES\_ROOT\\Excelhtmltemplate\\shell**
    **HKEY\_CLASSES\_ROOT\\.xls**
    **HKEY\_CLASSES\_ROOT\\.xlt**
    **HKEY\_CLASSES\_ROOT\\.xla**
    **HKEY\_CLASSES\_ROOT\\.xlm**
    **HKEY\_CLASSES\_ROOT\\.xlc**
    **HKEY\_CLASSES\_ROOT\\.xlw**
    **HKEY\_CLASSES\_ROOT\\.uxdc**
    **HKEY\_CLASSES\_ROOT\\.csv**
    **HKEY\_CLASSES\_ROOT\\.iqy**
    **HKEY\_CLASSES\_ROOT\\.dqy**
    **HKEY\_CLASSES\_ROOT\\.rqy**
    **HKEY\_CLASSES\_ROOT\\.oqy**
    **HKEY\_CLASSES\_ROOT\\.xll**
    **HKEY\_CLASSES\_ROOT\\.xlb**
    **HKEY\_CLASSES\_ROOT\\.slk**
    **HKEY\_CLASSES\_ROOT\\.dif**
    **HKEY\_CLASSES\_ROOT\\.xlk**
    **HKEY\_CLASSES\_ROOT\\.xld**
    **HKEY\_CLASSES\_ROOT\\.xlshtml**
    **HKEY\_CLASSES\_ROOT\\.xlthtml**
    **HKEY\_CLASSES\_ROOT\\.xlv**
    **HKEY\_CLASSES\_ROOT\\ExcelViewer.Chart.8\\shell**
    **HKEY\_CLASSES\_ROOT\\ExcelViewer.Macrosheet\\shell**
    **HKEY\_CLASSES\_ROOT\\ExcelViewer.Sheet.8\\shell**
    **HKEY\_CLASSES\_ROOT\\ExcelViewer.Template\\shell**
    **HKEY\_CLASSES\_ROOT\\ExcelViewer.Workspace\\shell**

    **Побочные эффекты** После этого документы Excel не будут открываться извне приложения Excel. Для просмотра документов Excel необходимо будет открыть приложение Excel и загрузить в него документ, выбрав пункт **Открыть** в меню **Файл**.

#### Не открывайте и не сохраняйте файлы Microsoft Excel, полученные из ненадежных источников.

Данная уязвимость может быть использована при открытии специально созданного файла Excel. С файлами Excel, полученными из надежных источников или известными как надежные, можно продолжать работать.

Предлагаемые действия
---------------------

<span></span>
-   **Защитите свой компьютер**

    Корпорация Майкрософт рекомендует следовать указаниям «Защитите свой компьютер» по включению брандмауэра, получению обновлений безопасности и установке антивирусного программного обеспечения. Дополнительные сведения об этих указаниях можно получить на [веб-узле «Защитите свой компьютер»](http://www.microsoft.com/protect).

-   Дополнительные сведения о безопасной работе в Интернете можно найти на [домашней странице Microsoft Security](http://www.microsoft.com/security).
-   Пользователи, подозревающие, что они подверглись атаке, должны обратиться в местное представительство ФБР или оставить жалобу на веб-узле [Internet Fraud Complaint Center](http://www.ifccfbi.gov/index.asp). Пользователям за пределами США рекомендуется обращаться в местные правоохранительные органы.
    Необходимо применять самые последние обновления безопасности, выпущенные корпорацией Майкрософт, чтобы гарантировать защиту компьютера от попыток воспользоваться его уязвимостью. Пользователи, включившие функцию автоматического обновления, будут получать все обновления системы Windows автоматически. Дополнительные сведения об обновлениях безопасности см. на [веб-узле Microsoft Security](http://www.microsoft.com/security).
-   Настоятельно рекомендуется проявлять особую осторожность при открытии подозрительных вложений, пришедших как от известных, так и от неизвестных отправителей. Дополнительные сведения о мерах безопасности при использовании программы MSN Messenger см. на [веб-странице часто задаваемых вопросов о программе MSN Messenger](http://messenger.msn.com/help).

    **Обновляйте систему Windows**

-   Все пользователи системы Windows должны применять последние обновления безопасности для наилучшей защиты компьютеров. Если вы не уверены в том, что программное обеспечение обновлено, посетите [веб-узел Windows Update](http://windowsupdate.microsoft.com/), выполните поиск необходимых обновлений и установите все предложенные высокоприоритетные обновления. Если включена функция автоматического обновления, обновления будут загружаться автоматически по мере выпуска, однако следует проверять их установку.

### Прочие сведения

**Источники**

-   Чтобы отправить отзыв, заполните форму на следующем [веб-узле](https://support.microsoft.com/common/survey.aspx?scid=sw;en;1257&amp;showpage=1&amp;ws=technet&amp;sd=tech).
-   Жители США и Канады могут обратиться в [службу технической поддержки корпорации Майкрософт](http://go.microsoft.com/fwlink/?linkid=21131). Дополнительную информацию о вариантах поддержки см. на [веб-узле справки и поддержки корпорации Майкрософт](http://support.microsoft.com?ln=ru).
-   Пользователям в других странах для получения поддержки следует обращаться в местные представительства корпорации Майкрософт. Дополнительные сведения о службе международной поддержки корпорации Майкрософт см. на [веб-узле International Support](http://go.microsoft.com/fwlink/?linkid=21155).
-   Дополнительные сведения о безопасности продуктов корпорации Майкрософт см. на [веб-узле Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132).

**Отказ от гарантий**

Сведения в данном документе предоставляются «как есть», без каких-либо гарантий. Корпорация Майкрософт не предоставляет каких-либо гарантий, явных или подразумеваемых, включая любые гарантии товарности или пригодности для использования в определенных целях. Корпорация Майкрософт и ее поставщики ни при каких обстоятельствах не несут ответственности за возможный ущерб, включая косвенный, случайный, прямой, опосредованный и специальный ущерб, а также упущенную выгоду, даже если корпорация Майкрософт или ее поставщики заранее были извещены о возможности такого ущерба. Если действующее законодательство не допускает отказа от ответственности за косвенный или случайный ущерб, то описанные выше ограничения не действуют.

**Редакции:**

-   19 июня 2006 г. Рекомендации опубликованы.
-   21 июня 2006 г. Рекомендации исправлены с целью внесения ясности в вопрос о побочных эффектах метода обхода проблемы «Предотвратите переход приложения Excel 2003 в режим исправления, изменив настройки списка управления доступом (ACL) в разделе реестра Excel Resiliency» раздела «Методы обхода уязвимости удаленного выполнения кода в приложении Microsoft Excel» и обновления раздела «Состояние рекомендаций».

*Built at 2014-04-18T01:50:00Z-07:00*
