---
TOCTitle: 'MS06-050'
Title: 'Бюллетень по безопасности (Майкрософт) MS06-050 - Важное'
ms:assetid: 'ms06-050'
ms:contentKeyID: 61236042
ms:mtpsurl: 'https://technet.microsoft.com/ru-RU/library/ms06-050(v=Security.10)'
---

Security Bulletin

Бюллетень по безопасности (Майкрософт) MS06-050 - Важное
========================================================

Уязвимости в библиотеке объектов гиперссылок Microsoft Windows делают возможным удаленный запуск кода злоумышленника (920670)
-----------------------------------------------------------------------------------------------------------------------------

Дата обновления: 13 сентября 2006 г.

**Версия:** 1.1

#### Аннотация

**Для кого предназначен этот документ:** для пользователей Microsoft Windows.

**Воздействие уязвимости:** Удаленное выполнение кода

**Уровень опасности:** Важно

**Рекомендация:** Пользователи должны как можно скорее установить это обновление.

**Замена обновлений безопасности:** этот бюллетень заменяет предыдущее обновление безопасности. Полный список см. в разделе «Часто задаваемые вопросы» этого бюллетеня.

**Предупреждение:** Отсутствует

**Проверенное программное обеспечение и пути для загрузки соответствующих обновлений безопасности:**

**Подвержены уязвимости:**

-   Microsoft Windows 2000 с пакетом обновления 4 (SP4) — [загрузить обновление](http://www.microsoft.com/downloads/details.aspx?familyid=bfe3f869-08be-4f13-97a1-7274ad44c7fb)
-   Microsoft Windows XP с пакетом обновления 1 (SP1) и Microsoft Windows XP с пакетом обновления 2 (SP2) — [загрузить обновление](http://www.microsoft.com/downloads/details.aspx?familyid=2d014bac-f03d-474a-a7ab-49e8ead8edb0)
-   Microsoft Windows XP Professional x64 Edition — [загрузить обновление](http://www.microsoft.com/downloads/details.aspx?familyid=cae094e4-64a0-4577-986b-4d6c131806d9)
-   Microsoft Windows Server 2003 и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) — [загрузить обновление](http://www.microsoft.com/downloads/details.aspx?familyid=21d1e864-4517-4353-8477-b4cd3c6187c0)
-   Microsoft Windows Server 2003 для платформы Itanium и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) для платформы Itanium — [загрузить обновление](http://www.microsoft.com/downloads/details.aspx?familyid=bc60b6c3-ada8-48ab-a63d-b2f1c9320b0d)
-   Microsoft Windows Server 2003 x64 Edition — [загрузить обновление](http://www.microsoft.com/downloads/details.aspx?familyid=9d2ba5d1-6f91-47b4-8cc1-dcd44baaa6ce)

Корпорация Майкрософт проверила на наличие уязвимости продукты перечисленных выше версий. Другие версии больше не поддерживаются либо не являются уязвимыми. Для получения сведений о жизненном цикле поддержки используемой версии продукта посетите [веб-узел Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

**Примечание.** Обновления безопасности для ОС Microsoft Windows Server 2003, Windows Server 2003 с пакетом обновления 1 (SP1) и Windows Server 2003 x64 Edition можно также применить к ОС Windows Server 2003 R2.

### Общие сведения

Аннотация
---------

<span></span>
**Аннотация:**

Данное обновление предназначено для устранения двух недавно обнаруженных уязвимостей. В данном бюллетене каждая из этих уязвимостей описана в отдельном разделе «Сведения об уязвимости».

Если пользователь вошел в систему с правами администратора, то злоумышленник, которому удалось воспользоваться уязвимостью, может установить полный контроль над системой. Таким образом, злоумышленник сможет устанавливать программы, просматривать, изменять и уничтожать данные или создавать новые учетные записи с неограниченными полномочиями. Риск для пользователей, учетные записи которых имеют ограниченные права, меньше, чем для пользователей, работающих с правами администратора.

Чтобы злоумышленник смог воспользоваться данной уязвимостью, необходимо участие пользователя.

Корпорация Майкрософт рекомендует применить это обновление как можно скорее.

**Уровень опасности и идентификаторы уязвимости:**

| Идентификаторы уязвимости                                                                                                            | Воздействие уязвимости    | Windows 2000 с пакетом обновления 4 (SP4) | Windows XP с пакетом обновления 1 (SP1) или 2 (SP2) | Windows Server 2003 и Windows Server 2003 с пакетом обновления 1 (SP1) |
|--------------------------------------------------------------------------------------------------------------------------------------|---------------------------|-------------------------------------------|-----------------------------------------------------|------------------------------------------------------------------------|
| Уязвимость переполнения буфера объектов гиперссылок [CVE-2006-3086](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3086) | Удаленное выполнение кода | Важно                                     | Важно                                               | Важно                                                                  |
| Уязвимость функции объекта гиперссылки [CVE-2006-3438](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3438)              | Удаленное выполнение кода | Важно                                     | Важно                                               | Важно                                                                  |
| **Общий уровень опасности**                                                                                                          | ** **                     | **Существенный**                          | **Существенный**                                    | **Существенный**                                                       |

Данные [оценки](http://go.microsoft.com/fwlink/?linkid=21140) уровня опасности определены с учетом типов уязвимых систем, стандартных схем их развертывания и возможных результатов успешного использования описанной уязвимости.

**Примечание.** Обновления для системы безопасности операционных систем Microsoft Windows Server 2003, Windows Server 2003 с пакетом обновления 1 (SP1) и Windows Server 2003 x64 Edition можно также применить к системе Windows Server 2003 R2.

**Примечание.** Уровни опасности для операционных систем, не относящихся к группе x86, соотносятся с уровнями опасности для операционных систем версий x86 следующим образом.

-   Уровень опасности системы Microsoft Windows XP Professional x64 Edition совпадает с уровнем опасности системы Windows XP с пакетом обновления 2 (SP2).
-   Уровень опасности системы Microsoft Windows Server 2003 для платформы Itanium совпадает с уровнем опасности систем Windows Server 2003.
-   Уровень опасности системы Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) для платформы Itanium совпадает с уровнем опасности системы Windows Server 2003 с пакетом обновления 1 (SP1).
-   Уровень опасности системы Microsoft Windows Server 2003 x64 Edition совпадает с уровнем опасности системы Windows Server 2003 с пакетом обновления 1 (SP1).

Часто задаваемые вопросы о данном обновлении безопасности
---------------------------------------------------------

<span></span>
**Какие из вышедших ранее обновлений безопасности заменяет это обновление?**
Это обновление безопасности заменяет обновление безопасности, описанное в предшествующем бюллетене. Следующая таблица содержит идентификаторы бюллетеней и названия уязвимых операционных систем.

| Идентификатор бюллетеня                                                 | Windows 2000 | Windows XP с пакетом обновления 1 (SP1) или 2 (SP2) | Windows Server 2003 | Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) |
|-------------------------------------------------------------------------|--------------|-----------------------------------------------------|---------------------|------------------------------------------------------------|
| [**MS05-015**](http://technet.microsoft.com/security/bulletin/ms05-015) | Заменяет     | Заменяет                                            | Заменяет            | Не применимо                                               |

**Продленная поддержка обновлений для системы безопасности операционных систем Windows 98, Windows 98 второго издания и Windows Millennium Edition закончилась 11 июля 2006 года. Я по-прежнему пользуюсь одной из этих операционных систем. Что мне делать?**
Жизненные циклы систем Windows 98, Windows 98 второго издания и Windows Millennium Edition завершены. Пользователям операционных систем данных версий следует срочно перейти на поддерживаемые версии, чтобы уменьшить вероятность наличия в системе уязвимостей. Для получения дополнительных сведений о жизненном цикле систем Windows посетите [веб-узел Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742). Для получения дополнительных сведений о продленном периоде поддержки обновления безопасности для данных версий операционных систем посетите [веб-узел службы технической поддержки продуктов Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

**Продленная поддержка обновлений безопасности для систем Microsoft Windows NT Workstation 4.0 с пакетом обновления 6a (SP 6a) и Windows 2000 с пакетом обновления 2 (SP2) закончилась 30 июня 2004 г. Продленная поддержка обновлений безопасности для системы Microsoft Windows NT Server 4.0 с пакетом обновления 6a (SP6a) закончилась 31 декабря 2004 г. Продленная поддержка обновлений безопасности для системы Microsoft Windows 2000 с пакетом обновления 3 (SP3) закончилась 30 июня 2005 г. Я по-прежнему пользуюсь одной из этих операционных систем. Что мне делать?**
Жизненные циклы поддержки систем Windows NT Workstation 4.0 с пакетом обновления 6a (SP6a), Windows NT Server 4.0 с пакетом обновления 6a (SP6a), Windows 2000 с пакетом обновления 2 (SP2) и Windows 2000 с пакетом обновления 3 (SP3) завершены. Пользователям операционных систем данных версий следует срочно перейти на поддерживаемые версии, чтобы уменьшить вероятность наличия в системе уязвимостей. Для получения дополнительных сведений о жизненном цикле систем Windows посетите [веб-узел Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742). Для получения дополнительных сведений о продленном периоде поддержки обновления безопасности для данных версий операционных систем посетите [веб-узел службы технической поддержки продуктов Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

Для получения сведений о возможных вариантах обслуживания данных продуктов свяжитесь с представителем группы корпорации Майкрософт по работе с заказчиками, ее техническим менеджером или представителем соответствующей партнерской компании Майкрософт. Пользователи, у которых нет договора типа Alliance, Premier или Authorized, могут обратиться в местное представительство корпорации Майкрософт. Для получения контактной информации посетите [веб-узел Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329), выберите страну и затем нажмите кнопку **Go** (Переход), чтобы вывести список телефонных номеров. Дозвонившись, попросите связать вас с коммерческим менеджером службы поддержки Premiere. Дополнительную информацию можно получить в разделе[Windows Operating System Product Support Lifecycle FAQ](http://go.microsoft.com/fwlink/?linkid=33330).

**Можно ли определить необходимость установки этого обновления с помощью средства Microsoft Baseline Security Analyzer (MBSA)?**
В следующей таблице приведены сведения об обнаружении данного обновления безопасности с помощью программы MBSA.

| Продукт                                                                                                                                 | MBSA 1.2.1 | MBSA 2.0 |
|-----------------------------------------------------------------------------------------------------------------------------------------|------------|----------|
| Microsoft Windows 2000 с пакетом обновления 4 (SP4)                                                                                     | Да         | Да       |
| Microsoft Windows XP с пакетом обновления 1 (SP1) и Microsoft Windows XP с пакетом обновления 2 (SP2)                                   | Да         | Да       |
| Microsoft Windows XP Professional (версия x64)                                                                                          | Нет        | Да       |
| Microsoft Windows Server 2003 и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1)                                              | Да         | Да       |
| Microsoft Windows Server 2003 для платформы Itanium и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) для платформы Itanium: | Нет        | Да       |
| Семейство Microsoft Windows Server 2003 x64 Edition                                                                                     | Нет        | Да       |

Дополнительные сведения см. на веб-узле [MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Дополнительные сведения о программах, которые служба Microsoft Update и средство MBSA 2.0 на данный момент не обнаруживают, см. в [статье 895660 базы знаний Майкрософт](http://support.microsoft.com/kb/895660).

Дополнительные сведения см. в [статье 910723 базы знаний Майкрософт](http://support.microsoft.com/kb/910723).

**Можно ли определить необходимость установки этого обновления с помощью сервера Systems Management Server (SMS)?**
В следующей таблице приведены сведения об обнаружении данного обновления безопасности с помощью программы SMS.

| Продукт                                                                                                                                 | SMS 2.0 | SMS 2003 |
|-----------------------------------------------------------------------------------------------------------------------------------------|---------|----------|
| Microsoft Windows 2000 с пакетом обновления 4 (SP4)                                                                                     | Да      | Да       |
| Microsoft Windows XP с пакетом обновления 1 (SP1) и Microsoft Windows XP с пакетом обновления 2 (SP2)                                   | Да      | Да       |
| Microsoft Windows XP Professional (версия x64)                                                                                          | Нет     | Да       |
| Microsoft Windows Server 2003 и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1)                                              | Да      | Да       |
| Microsoft Windows Server 2003 для платформы Itanium и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) для платформы Itanium: | Нет     | Да       |
| Семейство Microsoft Windows Server 2003 x64 Edition                                                                                     | Нет     | Да       |

Сервер SMS использует средство MBSA для обнаружения. Поэтому на средство SMS налагаются те же ограничения в отношении программного обеспечения, не определяемого программой MBSA, которые были перечислены выше в данном бюллетене.

Для обнаружения обновлений безопасности сервер SMS версии 2.0 может использовать пакет SMS SUS Feature Pack, в который входит средство Security Update Inventory Tool. Средство SMS SUIT использует для обнаружения модуль MBSA 1.2.1. Дополнительные сведения о средстве Security Update Inventory Tool см. на этом [веб-узле корпорации Майкрософт](http://support.microsoft.com/kb/894154/). Дополнительные сведения об ограничениях средства Security Update Inventory Tool представлены [в статье 306460 базы знаний Майкрософт](http://support.microsoft.com/kb/306460/). Пакет SMS SUS Feature Pack также включает средство Microsoft Office Inventory Tool, которое позволяет определять необходимость обновлений для приложений Microsoft Office.

Сервер SMS 2003 может использовать средство SMS 2003 Inventory Tool for Microsoft Updates для обнаружения обновлений безопасности, предлагаемых службой [Microsoft Update](http://update.microsoft.com/microsoftupdate) и поддерживаемых службами [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Для получения дополнительной информации о средстве SMS 2003 Inventory для обновлений Майкрософт см. [веб-узел корпорации Майкрософт](http://www.microsoft.com/smserver/downloads/2003/tools/msupdates.mspx). Сервер SMS 2003 также может использовать средство Microsoft Office Inventory Tool для поиска необходимых обновлений для приложений Microsoft Office.

Для получения дополнительных сведений о SMS посетите [веб-узел SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Дополнительные сведения см. в [статье 910723 базы знаний Майкрософт](http://support.microsoft.com/kb/910723).

Сведения об уязвимости
----------------------

<span></span>
#### Уязвимость переполнения буфера объектов COM CVE-2006-3086

Уязвимость, связанная с удаленным запуском кода, существует в библиотеке объектов гиперссылок. Проблема существует из-за неконтролируемого буфера в коде, использующемся для обработки гиперссылок. Злоумышленник может воспользоваться уязвимостью, создав вредоносную ссылку, которая может привести к удаленному запуску кода, если пользователь нажмет ее на веб-узле или в сообщении электронной почты. Воспользовавшись уязвимостью, злоумышленник может захватить полный контроль над системой. Чтобы воспользоваться данной уязвимостью, необходимо участие пользователя.

#### Факторы, снижающие опасность уязвимости переполнения буфера объекта гиперссылки COM — CVE-2006-3086

-   Злоумышленник, успешно воспользовавшийся данной уязвимостью, может получить те же самые права, которые имеет локальный пользователь. Риск для пользователей, учетные записи которых имеют ограниченные права, меньше, чем для пользователей, работающих с правами администратора.
-   Уязвимость не может быть использована автоматически посредством электронной почты. Чтобы атака достигла цели, злоумышленник должен убедить пользователя щелкнуть ссылку в сообщении электронной почты или открыть файл Office и щелкнуть ссылку внутри него.

#### Методы обхода уязвимости переполнения буфера объекта гиперссылки COM — CVE-2006-3086

Корпорация Майкрософт проверила представленные ниже методы обхода проблемы. Хотя данные меры не устраняют саму уязвимость, они позволяют блокировать известные направления атак. Метод обхода может не блокировать все направления атаки. Если методы обхода снижают функциональность, в следующем разделе это отмечено особо.

-   **Измените список контроля доступа так, чтобы запретить доступ к библиотеке Hlink.dll для всех пользователей**
    Отключение раздела реестра Hlink.dll помогает защитить уязвимую систему от попыток воспользоваться этой уязвимостью. Изменение раздела реестра Hlink.dll:

    -   В меню **Пуск** выберите пункт **Выполнить**, введите **cacls "%windir%\\system32\\hlink.dll" /d everyone** и нажмите кнопку **ОК**.

    **Побочные эффекты:** Пользователи приложений Office не смогут редактировать или щелкать гиперссылки, встроенные в документы Office.

-   **Измените список контроля доступа так, чтобы отключить раздел реестра HLINK**
    Изменение вписка контроля доступа в отношении раздела реестра **HLINK** поможет защитить уязвимую систему от попыток использования уязвимости. Для изменения раздела реестра выполните следующие действия.

    **Примечание**. Неправильное использование редактора реестра может привести к серьезным проблемам, для устранения которых, возможно, потребуется переустановить операционную систему. Корпорация Microsoft не гарантирует решение проблем, возникших в результате неправильной работы с редактором реестра. Ответственность за использование редактора реестра несет пользователь. Сведения о порядке редактирования реестра см. в разделе справки «Изменение параметров и их значений» редактора реестра (Regedit.exe) или в разделах справки «Добавление и удаление данных в реестре» и «Редактирование данных реестра» программы Regedt32.exe.

    **Примечание**. Корпорация Майкрософт рекомендует перед редактированием реестра сделать его резервную копию.

    **Для системы Windows 2000**

    **Примечание.** Запишите разрешения, которые приведены в этом диалоговом окне, чтобы позже можно было восстановить их исходные значения

    1.  Нажмите кнопку **Пуск**, выберите команду **Выполнить**, введите **regedt32** и нажмите кнопку **ОК**.
    2.  Разверните разделы **HKEY\_CLASSES\_ROOT** и **CLSID**, а затем выберите пункт **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Выберите **Безопасность**, а затем щелкните **Разрешения**.
    4.  Снимите флажок **Разрешить наследование разрешений от родительского объекта к этому объекту**. Появится запрос с вариантами **Копировать**, **Удалить** и **Отмена**. Щелкните **Удалить**, а затем нажмите кнопку **OK**.
    5.  Появится сообщение о том, что никто не будет иметь доступ к данному разделу реестра. При появлении соответствующего запроса нажмите кнопку **Да**.

    **Для системы Windows XP с пакетом обновления 1 (SP1) или более поздних операционных систем**

    **Примечание.** Запишите разрешения, которые приведены в этом диалоговом окне, чтобы позже можно было восстановить их исходные значения

    1.  Нажмите кнопку **Пуск**, выберите команду **Выполнить**, введите **regedit** и нажмите кнопку **ОК**.
    2.  Разверните разделы **HKEY\_CLASSES\_ROOT** и **CLSID**, а затем выберите пункт **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Выберите **Правка**, а затем щелкните **Разрешения**.
    4.  Нажмите кнопку **Дополнительно**.
    5.  Снимите флажок **Наследовать от родительского объекта применимые к дочерним объектам разрешения, добавляя их к явно заданным в этом окне.** Появится запрос с вариантами **Копировать**, **Удалить** и **Отмена**. Щелкните **Удалить**, а затем нажмите кнопку **OK**.
    6.  Появится сообщение о том, что никто не будет иметь доступ к данному разделу реестра. Нажмите кнопку **Да**, а затем нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Разрешения для {E436EBB8-524F-11CE-9F53-0020AF0BA770}**.

    **Побочные эффекты:** Пользователи приложений Office не смогут редактировать или щелкать гиперссылки, встроенные в документы Office.

-   **Чтобы предотвратить возможные атаки через сообщения электронной почты в формате HTML, просматривайте их в формате обычного текста (для пользователей программы Outlook 2002 или более поздней версии либо Outlook Express 6 с пакетом обновления версии 1 (SP1) или более поздней версии)**.

    Пользователи Microsoft Outlook 2002, установившие пакет обновления 1 (SP1) для Office XP или более поздней версии, и пользователи Microsoft Outlook Express 6, установившие пакет обновления 1 (SP1) для Internet Explorer 6 или более поздней версии, могут включить эту настройку и просматривать сообщения электронной почты без цифровой подписи или незашифрованные сообщения только в формате обычного текста.

    Дополнительные сведения об этом параметре в программе Outlook Express 6 см. [статью 291387 базы знаний Майкрософт](http://support.microsoft.com/kb/291387).

    **Побочные эффекты:** Сообщение электронной почты в формате обычного текста не содержит рисунков, специальных шрифтов, анимации или других сложных элементов. Кроме того:

    -   изменения воздействуют на область предварительного просмотра и открытые сообщения;
    -   рисунки становятся вложениями, так что они не теряются;
    -   поскольку сообщение продолжает храниться в памяти в формате RTF или HTML, объектная модель (пользовательские приложения) может вести себя непредсказуемым образом.

-   **Не щелкайте ссылки в документах Microsoft Office, полученных из ненадежных источников.**

#### Часто задаваемые вопросы об уязвимости переполнения буфера объекта гиперссылки COM — CVE-2006-3086

**Какова область воздействия данной уязвимости?**
Уязвимость, связанная с удаленным запуском кода, существует в библиотеке объектов гиперссылок Проблема существует из-за неконтролируемого буфера в коде, использующемся для обработки гиперссылок. Злоумышленник может воспользоваться уязвимостью, создав вредоносную ссылку, которая может привести к удаленному запуску кода, если пользователь нажмет ее на веб-узле или в сообщении электронной почты. Воспользовавшись уязвимостью, злоумышленник может захватить полный контроль над системой. Чтобы воспользоваться данной уязвимостью, необходимо участие пользователя.

Если пользователь вошел в систему с правами администратора, то злоумышленник, которому удалось воспользоваться уязвимостью, может установить полный контроль над уязвимой системой. Таким образом, злоумышленник сможет устанавливать программы, просматривать, изменять и уничтожать данные или создавать новые учетные записи с неограниченными полномочиями. Риск для пользователей, учетные записи которых имеют ограниченные права, меньше, чем для пользователей, работающих с правами администратора.

**В чем причина уязвимости?**
Причиной уязвимости является отсутствие проверки буфера в библиотеке объектов гиперссылок.

**Что такое библиотека объектов гиперссылок ?**
Библиотека объектов гиперссылок - это набор программных интерфейсов приложений. Это интерфейсы, позволяющие разработчикам программного обеспечения работать с гиперссылками. Дополнительные сведения о гиперссылках можно найти в [документации по продукту](http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/hlink/overview/overview.asp).

**Что может сделать злоумышленник, воспользовавшись этой уязвимостью?**
Воспользовавшись уязвимостью, злоумышленник может получить полный контроль над системой.

**Каким образом злоумышленник может воспользоваться уязвимостью?**
Уязвимость не может быть использована автоматически посредством электронной почты. Чтобы атака достигла цели, злоумышленник должен убедить пользователя щелкнуть ссылку в сообщении электронной почты или открыть файл Office и щелкнуть ссылку внутри него.

**Какие системы в первую очередь подвергаются риску?**
В первую очередь риску воздействия подвергаются рабочие станции и серверы терминалов. Серверы могут быть подвержены большему риску, если администраторы позволяют пользователям входить в систему на сервере и запускать программы. Однако общепринятой практикой настоятельно рекомендуется не предоставлять пользователям таких полномочий.

**Как действует обновление?**
Данное обновление устраняет уязвимость посредством модификации метода, который библиотека объектов гиперссылок использует для проверки длины сообщения, прежде чем передать сообщение в выделенный буфер.

**Было ли объявлено об этой уязвимости до выпуска этого бюллетеня безопасности?**
Да. О данной уязвимости сообщалось в открытых источниках. Данной уязвимости присвоен классификационный номер CVE-2006-3086. Данный бюллетень описывает уязвимость, о которой сообщалось в частном порядке и в открытых источниках, а также дополнительные проблемы, обнаруженные в результате внутреннего исследования

**Получала ли корпорация Майкрософт к моменту выпуска этого бюллетеня безопасности какие-либо сообщения о том, что эта уязвимость была использована злоумышленниками?**
Нет. Корпорация Майкрософт знает об опубликованных примерах концептуального кода, но она не получала никакой информации, указывающей на то, что эта уязвимость была открыто использована для атак на пользователей к моменту первоначального выпуска этого бюллетеня безопасности.

**Помогает ли установка этого обновления безопасности защититься от атак с применением опубликованного открытого кода, который использует данную уязвимость?**
Да. Это обновление безопасности устраняет уязвимость, которую можно использовать с помощью опубликованного концептуального кода. Уязвимости, устраняемой данным обновлением, присвоен классификационный номер CVE-2006-3086.

#### Уязвимость функции объекта гиперссылки CVE-2006-3438

Уязвимость, связанная с удаленным запуском кода, существует в библиотеке объектов гиперссылок. Проблема возникает, когда библиотека объектов гиперссылок использует файл с искаженной функцией при обработке гиперссылок. Злоумышленник может воспользоваться уязвимостью, создав вредоносную ссылку, которая может привести к удаленному запуску кода, если пользователь нажмет ее на веб-узле или в сообщении электронной почты. Воспользовавшись уязвимостью, злоумышленник может захватить полный контроль над системой. Чтобы воспользоваться данной уязвимостью, необходимо участие пользователя.

#### Факторы, снижающие опасность уязвимости функции объекта гиперссылки — CVE-2006-3438:

-   Злоумышленник, успешно воспользовавшийся данной уязвимостью, может получить те же самые права, которые имеет локальный пользователь. Риск для пользователей, учетные записи которых имеют ограниченные права, меньше, чем для пользователей, работающих с правами администратора.
-   Уязвимость не может быть использована автоматически посредством электронной почты. Чтобы атака достигла цели, злоумышленник должен убедить пользователя щелкнуть ссылку в сообщении электронной почты или открыть файл Office и щелкнуть ссылку внутри него.

#### Методы обхода уязвимости функции объекта гиперссылки — CVE-2006-3438:

Корпорация Майкрософт проверила представленные ниже методы обхода проблемы. Хотя данные меры не устраняют саму уязвимость, они позволяют блокировать известные направления атак. Метод обхода может не блокировать все направления атаки. Если методы обхода снижают функциональность, в следующем разделе это отмечено особо.

-   **Измените список контроля доступа так, чтобы запретить доступ к библиотеке Hlink.dll для всех пользователей**
    Отключение раздела реестра Hlink.dll помогает защитить уязвимую систему от попыток воспользоваться этой уязвимостью. Изменение раздела реестра Hlink.dll:

    -   В меню **Пуск** выберите пункт **Выполнить**, введите **cacls "%windir%\\system32\\hlink.dll" /d everyone** и нажмите кнопку **ОК**.

    **Побочные эффекты:** Пользователи приложений Office не смогут редактировать или щелкать гиперссылки, встроенные в документы Office.

-   **Измените список контроля доступа так, чтобы отключить раздел реестра HLINK**
    Изменение вписка контроля доступа в отношении раздела реестра **HLINK** поможет защитить уязвимую систему от попыток использования уязвимости. Для изменения раздела реестра выполните следующие действия.

    **Примечание**. Неправильное использование редактора реестра может привести к серьезным проблемам, для устранения которых, возможно, потребуется переустановить операционную систему. Корпорация Microsoft не гарантирует решение проблем, возникших в результате неправильной работы с редактором реестра. Ответственность за использование редактора реестра несет пользователь. Сведения о порядке редактирования реестра см. в разделе справки «Изменение параметров и их значений» редактора реестра (Regedit.exe) или в разделах справки «Добавление и удаление данных в реестре» и «Редактирование данных реестра» программы Regedt32.exe.

    **Примечание**. Корпорация Майкрософт рекомендует перед редактированием реестра сделать его резервную копию.

    **Для системы Windows 2000**

    **Примечание.** Запишите разрешения, которые приведены в этом диалоговом окне, чтобы позже можно было восстановить их исходные значения

    1.  Нажмите кнопку **Пуск**, выберите команду **Выполнить**, введите **regedt32** и нажмите кнопку **ОК**.
    2.  Разверните разделы **HKEY\_CLASSES\_ROOT** и **CLSID**, а затем выберите пункт **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Выберите **Безопасность**, а затем щелкните **Разрешения**.
    4.  Снимите флажок **Разрешить наследование разрешений от родительского объекта к этому объекту**. Появится запрос с вариантами **Копировать**, **Удалить** и **Отмена**. Щелкните **Удалить**, а затем нажмите кнопку **OK**.
    5.  Появится сообщение о том, что никто не будет иметь доступ к данному разделу реестра. При появлении соответствующего запроса нажмите кнопку **Да**.

    **Для системы Windows XP с пакетом обновления 1 (SP1) или более поздних операционных систем**

    **Примечание.** Запишите разрешения, которые приведены в этом диалоговом окне, чтобы позже можно было восстановить их исходные значения

    1.  Нажмите кнопку **Пуск**, выберите команду **Выполнить**, введите **regedit** и нажмите кнопку **ОК**.
    2.  Разверните разделы **HKEY\_CLASSES\_ROOT** и **CLSID**, а затем выберите пункт **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Выберите **Правка**, а затем щелкните **Разрешения**.
    4.  Нажмите кнопку **Дополнительно**.
    5.  Снимите флажок **Наследовать от родительского объекта применимые к дочерним объектам разрешения, добавляя их к явно заданным в этом окне.** Появится запрос с вариантами **Копировать**, **Удалить** и **Отмена**. Щелкните **Удалить**, а затем нажмите кнопку **OK**.
    6.  Появится сообщение о том, что никто не будет иметь доступ к данному разделу реестра. Нажмите кнопку **Да**, а затем нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Разрешения для {E436EBB8-524F-11CE-9F53-0020AF0BA770}**.

    **Побочные эффекты:** Пользователи приложений Office не смогут редактировать или щелкать гиперссылки, встроенные в документы Office.

-   **Чтобы предотвратить возможные атаки через сообщения электронной почты в формате HTML, просматривайте их в формате обычного текста (для пользователей программы Outlook 2002 или более поздней версии либо Outlook Express 6 с пакетом обновления версии 1 (SP1) или более поздней версии)**.

    Пользователи Microsoft Outlook 2002, установившие пакет обновления 1 (SP1) для Office XP или более поздней версии, и пользователи Microsoft Outlook Express 6, установившие пакет обновления 1 (SP1) для Internet Explorer 6 или более поздней версии, могут включить эту настройку и просматривать сообщения электронной почты без цифровой подписи или незашифрованные сообщения только в формате обычного текста.

    Дополнительные сведения об этом параметре в программе Outlook Express 6 см. [статью 291387 базы знаний Майкрософт](http://support.microsoft.com/kb/291387).

    **Побочные эффекты:** Сообщение электронной почты в формате обычного текста не содержит рисунков, специальных шрифтов, анимации или других сложных элементов. Кроме того:

    -   изменения воздействуют на область предварительного просмотра и открытые сообщения;
    -   рисунки становятся вложениями, так что они не теряются;
    -   поскольку сообщение продолжает храниться в памяти в формате RTF или HTML, объектная модель (пользовательские приложения) может вести себя непредсказуемым образом.

-   **Не щелкайте ссылки в документах Microsoft Office, полученных из ненадежных источников.**

#### Часто задаваемые вопросы об уязвимости функции объекта гиперссылки — CVE-2006-3438:

**Какова область воздействия данной уязвимости?**
Уязвимость, связанная с удаленным запуском кода, существует в библиотеке объектов гиперссылок Проблема возникает, когда библиотека объектов гиперссылок использует файл с искаженной функцией при обработке гиперссылок. Злоумышленник может воспользоваться уязвимостью, создав вредоносную ссылку, которая может привести к удаленному запуску кода, если пользователь нажмет ее на веб-узле или в сообщении электронной почты. Воспользовавшись уязвимостью, злоумышленник может захватить полный контроль над системой. Чтобы воспользоваться данной уязвимостью, необходимо участие пользователя.

Если пользователь вошел в систему с правами администратора, то злоумышленник, которому удалось воспользоваться уязвимостью, может установить полный контроль над уязвимой системой. Таким образом, злоумышленник сможет устанавливать программы, просматривать, изменять и уничтожать данные или создавать новые учетные записи с неограниченными полномочиями. Риск для пользователей, учетные записи которых имеют ограниченные права, меньше, чем для пользователей, работающих с правами администратора.

**В чем причина уязвимости?**
Причиной уязвимости является отсутствие проверки буфера в библиотеке объектов гиперссылок.

**Что такое библиотека объектов гиперссылок ?**
Библиотека объектов гиперссылок - это набор программных интерфейсов приложений. Это интерфейсы, позволяющие разработчикам программного обеспечения работать с гиперссылками. Дополнительные сведения о гиперссылках можно найти в [документации по продукту](http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/hlink/overview/overview.asp).

**Что может сделать злоумышленник, воспользовавшись этой уязвимостью?**
Воспользовавшись уязвимостью, злоумышленник может получить полный контроль над системой.

**Каким образом злоумышленник может воспользоваться уязвимостью?**
Уязвимость не может быть использована автоматически посредством электронной почты. Чтобы атака достигла цели, злоумышленник должен убедить пользователя щелкнуть ссылку в сообщении электронной почты или открыть файл Office и щелкнуть ссылку внутри него.

**Какие системы в первую очередь подвергаются риску?**
В первую очередь риску воздействия подвергаются рабочие станции и серверы терминалов. Серверы могут быть подвержены большему риску, если администраторы позволяют пользователям входить в систему на сервере и запускать программы. Однако общепринятой практикой настоятельно рекомендуется не предоставлять пользователям таких полномочий.

**Как действует обновление?**
Данное обновление устраняет уязвимость посредством модификации метода, который библиотека объектов гиперссылок использует для проверки длины сообщения, прежде чем передать сообщение в выделенный буфер.

**Было ли объявлено об этой уязвимости до выпуска этого бюллетеня безопасности?**
Нет. Корпорация Майкрософт получила информацию об этой уязвимости из достоверных источников. Майкрософт не получала никакой информации, указывающей на то, что до выпуска этого бюллетеня безопасности было открыто объявлено о данной уязвимости.

**Получала ли корпорация Майкрософт к моменту выпуска этого бюллетеня безопасности какие-либо сообщения о том, что эта уязвимость была использована злоумышленниками?**
Нет. Корпорация Майкрософт не получала никакой информации, указывающей на то, что эта уязвимость была открыто использована для атак на пользователей, и ей не были представлены никакие доказательства публикации концепции кода до первоначального выпуска этого бюллетеня безопасности.

Сведения об обновлении безопасности
-----------------------------------

<span></span>
**Подвержены уязвимости:**

Чтобы получить сведения о нужной версии обновления безопасности, щелкните соответствующую ссылку.

#### Windows Server 2003 (все версии)

**Необходимые условия**
Для установки этого обновления безопасности требуется система Windows Server 2003 или Windows Server 2003 с пакетом обновления 1 (SP1).

**Примечание.** Обновления для систем безопасности систем Microsoft Windows Server 2003 и Microsoft Windows Server 2003 с пакетом обновления 1 (SP1) можно также применить к системе Microsoft Windows Server 2003 R2.

**Включение в будущие пакеты обновления:**
Обновление для устранения данной проблемы будет включено в будущий пакет обновления или в сборник обновлений.

**Сведения об установке**

Программа обновления поддерживает следующие параметры командной строки.

<table class="dataTable">
<caption>
Поддерживаемые параметры установки программы обновления безопасности
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Параметр
</th>
<th style="border:1px solid black;" >
Описание
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Отображает параметры командной строки.
</td>
</tr>
<tr>
<th colspan="2">
Режимы установки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Автоматический режим установки. Вмешательства пользователя не требуется, но отображается состояние установки. Если по окончании установки требуется перезагрузка, на экране появится диалоговое окно, предупреждающее о перезагрузке компьютера через 30 секунд.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Полностью автоматический (тихий) режим. Режим, аналогичный автоматическому, но без отображения состояния или сообщений об ошибках.
</td>
</tr>
<tr>
<th colspan="2">
Параметры перезагрузки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
После установки перезагрузка компьютера не выполняется.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Перезагружает компьютер после установки и принудительно закрывает все приложения без предварительного сохранения открытых файлов.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Выводит диалоговое окно, предупреждающее пользователя о том, что компьютер будет перезагружен через *x* секунд. (Значение по умолчанию — 30 секунд.) Используется с параметрами **/quiet** или **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Отображает диалоговое окно с запросом на перезагрузку.
</td>
</tr>
<tr>
<th colspan="2">
Специальные параметры
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Заменяет файлы OEM без вывода соответствующего запроса.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Не создает резервных копий файлов на случай удаления.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Завершает работу других программ перед выключением компьютера.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: путь**
</td>
<td style="border:1px solid black;">
Обеспечивает переадресацию файлов журнала установки.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:путь**
</td>
<td style="border:1px solid black;">
Интегрирует обновление в исходные файлы Windows. Путь доступа к этим файлам указан в параметре.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:путь\]**
</td>
<td style="border:1px solid black;">
Извлекает файлы без запуска программы установки.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Создает расширенные отчеты об ошибках.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Обеспечивает подробное протоколирование в журнале. Во время установки создает журнал %Windir%\\CabBuild.log. В этом журнале приводится информация о копируемых файлах. Использование этого параметра может замедлить процесс установки.
</td>
</tr>
</table>
 
**Примечание.** Несколько параметров можно использовать в одной командной строке. Для обеспечения обратной совместимости обновлениями безопасности поддерживаются параметры, которые использовались в программе установки более ранней версии. Дополнительные сведения о поддерживаемых параметрах установки можно найти в [статье 262841 базы знаний Майкрософт](http://support.microsoft.com/kb/262841). Для получения подробной информации о программе установки Update.exe посетите [веб-узел Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Сведения о развертывании**

Чтобы установить обновление безопасности без вмешательства пользователя, введите следующую команду:

**Windowsserver2003-kb920670-x86-enu /quiet**

**Примечание.** Использование параметра **/quiet** приведет к отключению всех сообщений. Сообщения о сбое также не будут выводиться. При использовании параметра **/quiet** администратор должен проверить успешность установки при помощи какого-либо из поддерживаемых методов. Кроме того, при использовании этого параметра администратор должен проверить файл KB920670.log на наличие сообщений о сбое.

Чтобы установить обновление безопасности на компьютере под управлением Windows Server 2003 без последующей перезагрузки, введите следующую команду:

**Windowsserver2003-kb920670-x86-enu /norestart**

Для получения более подробных сведений о развертывании данного обновления с помощью служб Software Update Services посетите [веб-узел Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Для получения дополнительной информации о развертывании данного обновления безопасности с помощью служб Windows Server Update Services посетите[веб-узел служб Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Это обновление будет также доступно [на узле Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Необходимость перезагрузки**

После установки обновления компьютер необходимо перезагрузить.

**Сведения об удалении**

Для удаления обновления воспользуйтесь компонентом «Установка и удаление программ» панели управления.

Кроме того, системные администраторы могут использовать для этой цели программу Spuninst.exe. Программа Spuninst.exe находится в папке %Windir%\\$NTUninstallKB920670$\\Spuninst.

<table class="dataTable">
<caption>
Поддерживаемые параметры Spuninst.exe
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Параметр
</th>
<th style="border:1px solid black;" >
Описание
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Отображает параметры командной строки.
</td>
</tr>
<tr>
<th colspan="2">
Режимы установки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Автоматический режим установки. Вмешательства пользователя не требуется, но отображается состояние установки. Если по окончании установки требуется перезагрузка, на экране появится диалоговое окно, предупреждающее о перезагрузке компьютера через 30 секунд.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Полностью автоматический (тихий) режим. Режим, аналогичный автоматическому, но без отображения состояния или сообщений об ошибках.
</td>
</tr>
<tr>
<th colspan="2">
Параметры перезагрузки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
После установки перезагрузка компьютера не выполняется.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Перезагружает компьютер после установки и принудительно закрывает все приложения без предварительного сохранения открытых файлов.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Выводит диалоговое окно, предупреждающее пользователя о том, что компьютер будет перезагружен через *x* секунд. (Значение по умолчанию — 30 секунд.) Используется с параметрами **/quiet** или **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Отображает диалоговое окно с запросом на перезагрузку.
</td>
</tr>
<tr>
<th colspan="2">
Специальные параметры
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Завершает работу других программ перед выключением компьютера.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:путь**
</td>
<td style="border:1px solid black;">
Обеспечивает переадресацию файлов журнала установки.
</td>
</tr>
</table>
 
**Сведения о файлах**

Английская версия обновления содержит версии файлов, приведенные в следующей таблице. Дата и время указаны в формате всемирного универсального времени (по Гринвичу). При просмотре сведений о файле в системе производится перевод соответствующих значений в местное время. Чтобы определить разницу между временем по Гринвичу и местным временем, воспользуйтесь вкладкой **Часовой пояс** компонента Дата и время панели управления.

Windows Server 2003 Web Edition, Windows Server 2003 Standard Edition, Windows Server 2003 Datacenter Edition, Windows Server 2003 Enterprise Edition, Windows Small Business Server 2003, Windows Server 2003 Web Edition с пакетом обновления 1 (SP1), Windows Server 2003 Standard Edition с пакетом обновления 1 (SP1), Windows Server 2003 Enterprise Edition с пакетом обновления 1 (SP1), Windows Server 2003 Datacenter Edition с пакетом обновления 1 (SP1), Windows Server 2003 R2 Web Edition, Windows Server 2003 R2 Standard Edition, Windows Server 2003 R2 Datacenter Edition, Windows Server 2003 R2 Enterprise Edition, Windows Small Business Server 2003 R2:

| Имя файла | Версия        | Date        | Время | Размер | Процессор | Папка  |
|-----------|---------------|-------------|-------|--------|-----------|--------|
| Hlink.dll | 5.2.3790.560  | 17-июл-2006 | 22:17 | 71 680 | x86       | RTMGDR |
| Hlink.dll | 5.2.3790.560  | 17-июл-2006 | 22:37 | 71 680 | x86       | RTMQFE |
| Hlink.dll | 5.2.3790.2748 | 17-июл-2006 | 22:40 | 72 704 | x86       | SP1GDR |
| Hlink.dll | 5.2.3790.2748 | 17-июл-2006 | 22:45 | 72 704 | x86       | SP1QFE |

| Имя файла  | Версия        | Date        | Время | Размер  | Процессор | Папка       |
|------------|---------------|-------------|-------|---------|-----------|-------------|
| Hlink.dll  | 5.2.3790.560  | 17-июл-2006 | 23:09 | 231 936 | IA-64     | RTMGDR      |
| Whlink.dll | 5.2.3790.560  | 17-июл-2006 | 23:09 | 71 680  | x86       | RTMGDR\\WOW |
| Hlink.dll  | 5.2.3790.560  | 17-июл-2006 | 23:09 | 231 936 | IA-64     | RTMQFE      |
| Whlink.dll | 5.2.3790.560  | 17-июл-2006 | 23:09 | 71 680  | x86       | RTMQFE\\WOW |
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:13 | 246 784 | IA-64     | SP1GDR      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:13 | 72 704  | x86       | SP1GDR\\WOW |
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 246 784 | IA-64     | SP1QFE      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 72 704  | x86       | SP1QFE\\WOW |

Windows Server 2003 Standard x64 Edition, Windows Server 2003 Enterprise x64 Edition, Windows Server 2003 Datacenter x64 Edition, Windows Server 2003 R2 Standard x64 Edition, Windows Server 2003 R2 Enterprise x64 Edition, а также Windows Server 2003 R2, Datacenter x64 Edition:

| Имя файла  | Версия        | Date        | Время | Размер  | Процессор | Папка       |
|------------|---------------|-------------|-------|---------|-----------|-------------|
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 156 160 | x64       | SP1GDR      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 72 704  | x86       | SP1GDR\\WOW |
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:08 | 156 160 | x64       | SP1QFE      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:08 | 72 704  | x86       | SP1QFE\\WOW |

**Примечание.** При установке данных обновлений программа установки проверяет, не выполнялось ли ранее с помощью исправлений Майкрософт обновление файлов, которые предстоит обновить.

Если один из файлов был обновлен ранее другим исправлением, установщик копирует на компьютер файлы RTMQFE, SP1QFE и SP2QFE. а в противном случае — файлы RTMGDR, SP1GDR или SP2GDR. Обновления безопасности могут не содержать всех этих вариантов. Дополнительную информацию о поведении такого рода см. в [статье 824994 базы знаний Майкрософт](http://support.microsoft.com/kb/824994).

Для получения дополнительной информации о программе установки Update.exe посетите [веб-узел Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Для получения подробных сведений о терминологии, встречающейся в этом бюллетене, например, *исправление*, обратитесь к [статье 824684 базы знаний Майкрософт](http://support.microsoft.com/kb/824684).

**Проверка успешного применения обновления**

-   **Анализатор безопасности Microsoft Baseline Security Analyzer**

    Для проверки успешного применения обновления безопасности можно воспользоваться средством Microsoft Baseline Security Analyzer (MBSA). MBSA предоставляет администраторам возможность сканирования локальных и удаленных систем для определения отсутствующих обновлений безопасности и выявления стандартных ошибок в конфигурациях систем безопасности. Для получения дополнительных сведений о программе MBSA обратитесь к [веб-узлу Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Проверка версий файлов**

    **Примечание.** На каждом конкретном компьютере эти действия определяются установленной версией операционной системы Microsoft Windows. В случае затруднений для выполнения процедуры обратитесь к документации по установленной версии продукта.

    1.  Нажмите кнопку **Пуск** и выберите пункт **Найти**.
    2.  На панели **Результаты поиска** в области **Помощник по поиску** выберите пункт **Файлы и папки**.
    3.  В области **Часть имени или имя файла целиком** введите имя файла из соответствующей справочной таблицы по файлам и нажмите кнопку **Найти**.
    4.  В списке файлов щелкните правой кнопкой мыши имя файла из соответствующей справочной таблицы по файлам, затем щелкните **Свойства**.
        **Примечание.** В зависимости от версии операционной системы или установленных программ некоторые файлы, перечисленные в справочной таблице по файлам, могут оказаться не установленным.
    5.  На вкладке **Версия** определите версию файла, устанавливаемого на компьютере, сравнив ее с версией, приведенной в соответствующей таблице сведений о файлах.
        **Примечание.** Атрибуты, отличные от версии файла, могут измениться во ходе установки. Проверка того, что обновление было применено, путем сравнения других атрибутов файла с данными из таблицы сведений о файлах не поддерживается. Кроме того, при определенных условиях файлы в ходе установки могут быть переименованы. Если сведения о файле или версии отсутствуют, обратитесь к другим доступным методам проверки установки обновления.

-   **Проверка параметров системного реестра**

    Файлы, установленные этим обновлением системы безопасности, также можно проверить, открыв следующие разделы реестра.

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Enterprise Edition для платформы Itanium и Windows Server 2003, Datacenter Edition для платформы Itanium:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP2\\KB920670\\Filelist

    Windows Server 2003 Web Edition; Windows Server 2003 Standard Edition; Windows Server 2003 Enterprise Edition; Windows Server 2003 Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003 Web Edition с пакетом обновления 1 (SP1); Windows Server 2003 Standard Edition с пакетом обновления 1 (SP1); Windows Server 2003 Enterprise Edition с пакетом обновления 1 (SP1); Windows Server 2003 Datacenter Edition с пакетом обновления 1 (SP1); Windows Server 2003 Enterprise Edition для платформы Itanium; Windows Server 2003 Datacenter Edition для платформы Itanium; Windows Server 2003 Enterprise Edition с пакетом обновления 1 (SP1) для платформы Itanium; Windows Server 2003 Datacenter Edition с пакетом обновления 1 (SP1) для платформы Itanium; Windows Server 2003 Standard x64 Edition; Windows Server 2003 Enterprise x64 Edition и Windows Server 2003 Datacenter x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP2\\KB920670\\Filelist

    **Примечание**. Этот раздел реестра может не содержать полный список установленных файлов. Кроме того, этот раздел реестра может быть создан неправильно, если администратор или изготовитель оборудования интегрирует или добавляет в исходные установочные файлы Windows обновление для системы безопасности 920670.

#### Windows XP (все версии)

**Необходимые условия**
Это обновление безопасности требует наличия на компьютере системы Microsoft Windows XP с пакетом обновления 1 (SP1) или более поздней версии. Дополнительные сведения см. в [статье 322389 базы знаний Майкрософт](http://support.microsoft.com/kb/322389).

**Включение в будущие пакеты обновления:**
Исправление этой уязвимости будет включено в будущий пакет обновления.

**Сведения об установке**

Программа обновления поддерживает следующие параметры командной строки.

<table class="dataTable">
<caption>
Поддерживаемые параметры установки программы обновления безопасности
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Параметр
</th>
<th style="border:1px solid black;" >
Описание
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Отображает параметры командной строки.
</td>
</tr>
<tr>
<th colspan="2">
Режимы установки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Автоматический режим установки. Вмешательства пользователя не требуется, но отображается состояние установки. Если по окончании установки требуется перезагрузка, на экране появится диалоговое окно, предупреждающее о перезагрузке компьютера через 30 секунд.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Полностью автоматический (тихий) режим. Режим, аналогичный автоматическому, но без отображения состояния или сообщений об ошибках.
</td>
</tr>
<tr>
<th colspan="2">
Параметры перезагрузки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
После установки перезагрузка компьютера не выполняется.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Перезагружает компьютер после установки и принудительно закрывает все приложения без предварительного сохранения открытых файлов.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Выводит диалоговое окно, предупреждающее пользователя о том, что компьютер будет перезагружен через *x* секунд. (Значение по умолчанию — 30 секунд.) Используется с параметрами **/quiet** или **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Отображает диалоговое окно с запросом на перезагрузку.
</td>
</tr>
<tr>
<th colspan="2">
Специальные параметры
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Заменяет файлы OEM без вывода соответствующего запроса.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Не создает резервных копий файлов на случай удаления.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Завершает работу других программ перед выключением компьютера.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:путь**
</td>
<td style="border:1px solid black;">
Обеспечивает переадресацию файлов журнала установки.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:путь**
</td>
<td style="border:1px solid black;">
Интегрирует обновление в исходные файлы Windows. Путь доступа к этим файлам указан в параметре.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:путь\]**
</td>
<td style="border:1px solid black;">
Извлекает файлы без запуска программы установки.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Создает расширенные отчеты об ошибках.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Обеспечивает подробное протоколирование в журнале. Во время установки создает журнал %Windir%\\CabBuild.log. В этом журнале приводится информация о копируемых файлах. Использование этого параметра может замедлить процесс установки.
</td>
</tr>
</table>
 
**Примечание.** Несколько параметров можно использовать в одной командной строке. Для обеспечения обратной совместимости обновлениями безопасности поддерживаются параметры, которые использовались в программе установки более ранней версии. Дополнительные сведения о поддерживаемых параметрах установки можно найти в [статье 262841 базы знаний Майкрософт](http://support.microsoft.com/kb/262841). Для получения подробной информации о программе установки Update.exe посетите [веб-узел Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Сведения о развертывании**

Чтобы установить обновление безопасности без вмешательства пользователя на компьютере под управлением Microsoft Windows XP, введите следующую команду:

**Windowsxp-kb920670-x86-enu /quiet**

**Примечание.** Использование параметра **/quiet** приведет к отключению всех сообщений. Сообщения о сбое также не будут выводиться. При использовании параметра **/quiet** администратор должен проверить успешность установки при помощи какого-либо из поддерживаемых методов. Кроме того, при использовании этого параметра администратор должен проверить файл KB920670.log на наличие сообщений о сбое.

Чтобы установить обновление безопасности на компьютере под управлением Windows XP без последующей перезагрузки, введите следующую команду:

**Windowsxp-kb920670-x86-enu /norestart**

Для получения более подробных сведений о развертывании данного обновления с помощью служб Software Update Services посетите [веб-узел Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Для получения дополнительной информации о развертывании данного обновления безопасности с помощью служб Windows Server Update Services посетите[веб-узел служб Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Это обновление будет также доступно [на узле Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Необходимость перезагрузки**

После установки обновления компьютер необходимо перезагрузить.

**Сведения об удалении**

Для удаления обновления безопасности воспользуйтесь компонентом «Установка и удаление программ» панели управления.

Кроме того, системные администраторы могут использовать для этой цели программу Spuninst.exe. Программа Spuninst.exe находится в папке %Windir%\\$NTUninstallKB920670$\\Spuninst.

<table class="dataTable">
<caption>
Поддерживаемые параметры Spuninst.exe
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Параметр
</th>
<th style="border:1px solid black;" >
Описание
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Отображает параметры командной строки.
</td>
</tr>
<tr>
<th colspan="2">
Режимы установки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Автоматический режим установки. Вмешательства пользователя не требуется, но отображается состояние установки. Если по окончании установки требуется перезагрузка, на экране появится диалоговое окно, предупреждающее о перезагрузке компьютера через 30 секунд.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Полностью автоматический (тихий) режим. Режим, аналогичный автоматическому, но без отображения состояния или сообщений об ошибках.
</td>
</tr>
<tr>
<th colspan="2">
Параметры перезагрузки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
После установки перезагрузка компьютера не выполняется.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Перезагружает компьютер после установки и принудительно закрывает все приложения без предварительного сохранения открытых файлов.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Выводит диалоговое окно, предупреждающее пользователя о том, что компьютер будет перезагружен через *x* секунд. (Значение по умолчанию — 30 секунд.) Используется с параметрами **/quiet** или **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Отображает диалоговое окно с запросом на перезагрузку.
</td>
</tr>
<tr>
<th colspan="2">
Специальные параметры
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Завершает работу других программ перед выключением компьютера.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:путь**
</td>
<td style="border:1px solid black;">
Обеспечивает переадресацию файлов журнала установки.
</td>
</tr>
</table>
 
**Сведения о файлах**

Английская версия обновления содержит версии файлов, приведенные в следующей таблице. Дата и время указаны в формате всемирного универсального времени (по Гринвичу). При просмотре сведений о файле в системе производится перевод соответствующих значений в местное время. Чтобы определить разницу между временем по Гринвичу и местным временем, воспользуйтесь вкладкой **Часовой пояс** компонента Дата и время панели управления.

Windows XP Home Edition с пакетом обновления 1 (SP1), Windows XP Professional с пакетом обновления 1 (SP1), Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition с пакетом обновления 2 (SP2), Windows XP Professional с пакетом обновления 2 (SP2), Windows XP Tablet PC Edition 2005 и Windows XP Media Center Edition 2005:

| Имя файла | Версия        | Date        | Время | Размер | Процессор | Папка  |
|-----------|---------------|-------------|-------|--------|-----------|--------|
| Hlink.dll | 5.2.3790.2748 | 21-июл-2006 | 08:30 | 72 704 | x86       | SP1QFE |
| Hlink.dll | 5.2.3790.2748 | 21-июл-2006 | 08:24 | 72 704 | x86       | SP2GDR |
| Hlink.dll | 5.2.3790.2748 | 21-июл-2006 | 08:26 | 72 704 | x86       | SP2QFE |

Windows XP Professional x64:

| Имя файла  | Версия        | Date        | Время | Размер  | Процессор | Папка       |
|------------|---------------|-------------|-------|---------|-----------|-------------|
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 156 160 | x64       | SP1GDR      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 72 704  | x86       | SP1GDR\\WOW |
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:08 | 156 160 | x64       | SP1QFE      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:08 | 72 704  | x86       | SP1QFE\\WOW |
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 156 160 | x64       | SP1GDR      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:11 | 72 704  | x86       | SP1GDR\\WOW |
| Hlink.dll  | 5.2.3790.2748 | 17-июл-2006 | 23:08 | 156 160 | x64       | SP1QFE      |
| Whlink.dll | 5.2.3790.2748 | 17-июл-2006 | 23:08 | 72 704  | x86       | SP1QFE\\WOW |

**Примечание.** При установке данных обновлений программа установки проверяет, не выполнялось ли ранее с помощью исправлений Майкрософт обновление файлов, которые предстоит обновить.

Если один из файлов был обновлен ранее другим исправлением, установщик копирует на компьютер файлы RTMQFE, SP1QFE и SP2QFE. а в противном случае — файлы RTMGDR, SP1GDR или SP2GDR. Обновления безопасности могут не содержать всех этих вариантов. Дополнительную информацию о поведении такого рода см. в [статье 824994 базы знаний Майкрософт](http://support.microsoft.com/kb/824994).

Для получения дополнительной информации о программе установки Update.exe посетите [веб-узел Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Для получения подробных сведений о терминологии, встречающейся в этом бюллетене, например, *исправление*, обратитесь к [статье 824684 базы знаний Майкрософт](http://support.microsoft.com/kb/824684).

**Проверка успешного применения обновления**

-   **Анализатор безопасности Microsoft Baseline Security Analyzer**

    Для проверки успешного применения обновления безопасности можно воспользоваться средством Microsoft Baseline Security Analyzer (MBSA). MBSA предоставляет администраторам возможность сканирования локальных и удаленных систем для определения отсутствующих обновлений безопасности и выявления стандартных ошибок в конфигурациях систем безопасности. Для получения дополнительных сведений о программе MBSA обратитесь к [веб-узлу Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Проверка версий файлов**

    **Примечание.** На каждом конкретном компьютере эти действия определяются установленной версией операционной системы Microsoft Windows. В случае затруднений для выполнения процедуры обратитесь к документации по установленной версии продукта.

    1.  Нажмите кнопку **Пуск** и выберите пункт **Найти**.
    2.  На панели **Результаты поиска** в области **Помощник по поиску** выберите пункт **Файлы и папки**.
    3.  В области **Часть имени или имя файла целиком** введите имя файла из соответствующей справочной таблицы по файлам и нажмите кнопку **Найти**.
    4.  В списке файлов щелкните правой кнопкой мыши имя файла из соответствующей справочной таблицы по файлам, затем щелкните **Свойства**.
        **Примечание.** В зависимости от версии операционной системы или установленных программ некоторые файлы, перечисленные в справочной таблице по файлам, могут оказаться не установленным.
    5.  На вкладке **Версия** определите версию файла, устанавливаемого на компьютере, сравнив ее с версией, приведенной в соответствующей таблице сведений о файлах.
        **Примечание.** Атрибуты, отличные от версии файла, могут измениться во ходе установки. Проверка того, что обновление было применено, путем сравнения других атрибутов файла с данными из таблицы сведений о файлах не поддерживается. Кроме того, при определенных условиях файлы в ходе установки могут быть переименованы. Если сведения о файле или версии отсутствуют, обратитесь к другим доступным методам проверки установки обновления.

-   **Проверка параметров системного реестра**

    Файлы, установленные этим обновлением системы безопасности, также можно проверить, открыв следующие разделы реестра.

    Для Windows XP Home Edition с пакетом обновления 1 (SP1), Windows XP Professional с пакетом обновления 1 (SP1), Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition с пакетом обновления 2 (SP2), Windows XP Professional с пакетом обновления 2 (SP2), Windows XP Tablet PC Edition 2005 и Windows XP Media Center Edition 2005:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP3\\KB920670\\Filelist

    Для Windows XP Professional x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP2\\KB920670\\Filelist

    **Примечание.** Эти разделы реестра могут не содержать полного списка установленных файлов. Кроме того, эти разделы реестра могут быть созданы неправильно, если администратор или изготовитель оборудования интегрирует или добавляет в исходные установочные файлы Windows обновление для системы безопасности 920670.

#### Windows 2000 (все версии)

**Необходимые условия**
При установке в системе Windows 2000 это обновление требует пакета обновления 4 (SP4). Данное обновление безопасности требует установки Small Business Server 2000 с пакетом обновления 1a (SP1a) или Small Business Server 2000 с системой Windows 2000 Server с пакетом обновления 4 (SP4).

Корпорация Майкрософт проверила на наличие уязвимости продукты указанных выше версий. Другие версии больше не поддерживаются либо не являются уязвимыми. Для получения сведений о жизненном цикле поддержки используемой версии продукта посетите [веб-узел Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

Сведения о получении пакета обновления последней версии см. в [статье 260910 базы знаний Майкрософт](http://support.microsoft.com/kb/260910).

**Включение в будущие пакеты обновления:**
Обновление безопасности для этой проблемы может войти в будущий сборник обновлений.

**Сведения об установке**

Программа обновления поддерживает следующие параметры командной строки.

<table class="dataTable">
<caption>
Поддерживаемые параметры установки программы обновления безопасности
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Параметр
</th>
<th style="border:1px solid black;" >
Описание
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Отображает параметры командной строки.
</td>
</tr>
<tr>
<th colspan="2">
Режимы установки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Автоматический режим установки. Вмешательства пользователя не требуется, но отображается состояние установки. Если по окончании установки требуется перезагрузка, на экране появится диалоговое окно, предупреждающее о перезагрузке компьютера через 30 секунд.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Полностью автоматический (тихий) режим. Режим, аналогичный автоматическому, но без отображения состояния или сообщений об ошибках.
</td>
</tr>
<tr>
<th colspan="2">
Параметры перезагрузки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
После установки перезагрузка компьютера не выполняется.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Перезагружает компьютер после установки и принудительно закрывает все приложения без предварительного сохранения открытых файлов.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Выводит диалоговое окно, предупреждающее пользователя о том, что компьютер будет перезагружен через *x* секунд. (Значение по умолчанию — 30 секунд.) Используется с параметрами **/quiet** или **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Отображает диалоговое окно с запросом на перезагрузку.
</td>
</tr>
<tr>
<th colspan="2">
Специальные параметры
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Заменяет файлы OEM без вывода соответствующего запроса.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Не создает резервных копий файлов на случай удаления.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Завершает работу других программ перед выключением компьютера.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:путь**
</td>
<td style="border:1px solid black;">
Обеспечивает переадресацию файлов журнала установки.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:путь**
</td>
<td style="border:1px solid black;">
Интегрирует обновление в исходные файлы Windows. Путь доступа к этим файлам указан в параметре.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:путь\]**
</td>
<td style="border:1px solid black;">
Извлекает файлы без запуска программы установки.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Создает расширенные отчеты об ошибках.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Обеспечивает подробное протоколирование в журнале. Во время установки создает журнал %Windir%\\CabBuild.log. В этом журнале приводится информация о копируемых файлах. Использование этого параметра может замедлить процесс установки.
</td>
</tr>
</table>
 
**Примечание.** Несколько параметров можно использовать в одной командной строке. Для обеспечения обратной совместимости обновлениями безопасности поддерживаются параметры, которые использовались в программе установки более ранней версии. Дополнительные сведения о поддерживаемых параметрах установки можно найти в [статье 262841 базы знаний Майкрософт](http://support.microsoft.com/kb/262841). Для получения подробной информации о программе установки Update.exe посетите [веб-узел Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Для получения подробных сведений о терминологии, встречающейся в этом бюллетене, например, *исправление*, обратитесь к [статье 824684 базы знаний Майкрософт](http://support.microsoft.com/kb/824684).

**Сведения о развертывании**

Чтобы установить обновление безопасности без вмешательства пользователя на компьютере под управлением Windows 2000 с пакетом обновления 4 (SP4), введите следующую команду:

**Windows2000-kb920670-x86-enu /quiet**

**Примечание.** Использование параметра **/quiet** приведет к отключению всех сообщений. Сообщения о сбое также не будут выводиться. При использовании параметра **/quiet** администратор должен проверить успешность установки при помощи какого-либо из поддерживаемых методов. Кроме того, при использовании этого параметра администратор должен проверить файл KB920670.log на наличие сообщений о сбое.

Чтобы установить обновление безопасности на компьютере под управлением Windows 2000 с пакетом обновления 4 (SP4) без последующей перезагрузки, введите следующую команду:

**Windows2000-kb920670-x86-enu /norestart**

Сведения о развертывании данного обновления с помощью служб Software Update Services см. на [веб-узле Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Для получения дополнительной информации о развертывании данного обновления безопасности с помощью служб Windows Server Update Services посетите[веб-узел служб Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Это обновление будет также доступно [на узле Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Необходимость перезагрузки**

Это обновление не требует перезагрузки компьютера. Программа установки автоматически останавливает необходимые службы, устанавливает обновление и снова запускает их. Если по какой-либо причине требуемые службы не могут быть остановлены или требуемые файлы используются другими приложениями, то после установки данного обновления компьютер необходимо перезагрузить. В этом случае появляется соответствующее сообщение.

Чтобы уменьшить вероятность необходимой перезагрузки, перед установкой обновления безопасности остановите все уязвимые службы и закройте все приложения, которые могут использовать уязвимые файлы к моменту установки обновления безопасности. Для получения дополнительной информации о причинах необходимости перезагрузки ознакомьтесь со [статьей 887012 базы знаний Майкрософт](http://support.microsoft.com/kb/887012).

**Сведения об удалении**

Для удаления обновления воспользуйтесь компонентом «Установка и удаление программ» панели управления.

Кроме того, системные администраторы могут использовать для этой цели программу Spuninst.exe. Программа Spuninst.exe находится в папке %Windir%\\$NTUninstallKB920670$\\Spuninst.

<table class="dataTable">
<caption>
Поддерживаемые параметры Spuninst.exe
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Параметр
</th>
<th style="border:1px solid black;" >
Описание
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Отображает параметры командной строки.
</td>
</tr>
<tr>
<th colspan="2">
Режимы установки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Автоматический режим установки. Вмешательства пользователя не требуется, но отображается состояние установки. Если по окончании установки требуется перезагрузка, на экране появится диалоговое окно, предупреждающее о перезагрузке компьютера через 30 секунд.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Полностью автоматический (тихий) режим. Режим, аналогичный автоматическому, но без отображения состояния или сообщений об ошибках.
</td>
</tr>
<tr>
<th colspan="2">
Параметры перезагрузки
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
После установки перезагрузка компьютера не выполняется.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Перезагружает компьютер после установки и принудительно закрывает все приложения без предварительного сохранения открытых файлов.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Выводит диалоговое окно, предупреждающее пользователя о том, что компьютер будет перезагружен через *x* секунд. (Значение по умолчанию — 30 секунд.) Используется с параметрами **/quiet** или **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Отображает диалоговое окно с запросом на перезагрузку.
</td>
</tr>
<tr>
<th colspan="2">
Специальные параметры
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Завершает работу других программ перед выключением компьютера.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:путь**
</td>
<td style="border:1px solid black;">
Обеспечивает переадресацию файлов журнала установки.
</td>
</tr>
</table>
 
**Сведения о файлах**

Английская версия обновления содержит версии файлов, приведенные в следующей таблице. Дата и время указаны в формате всемирного универсального времени (по Гринвичу). При просмотре сведений о файле в системе производится перевод соответствующих значений в местное время. Чтобы определить разницу между временем по Гринвичу и местным временем, воспользуйтесь вкладкой **Часовой пояс** компонента Дата и время панели управления.

Windows 2000 с пакетом обновления 4 (SP4) и Small Business Server 2000:

| Имя файла | Версия        | Date        | Время | Размер |
|-----------|---------------|-------------|-------|--------|
| Hlink.dll | 5.2.3790.2748 | 22-июл-2006 | 03:38 | 72 704 |

**Проверка успешного применения обновления**

-   **Анализатор безопасности Microsoft Baseline Security Analyzer**

    Для проверки успешного применения обновления безопасности можно воспользоваться средством Microsoft Baseline Security Analyzer (MBSA). MBSA предоставляет администраторам возможность сканирования локальных и удаленных систем для определения отсутствующих обновлений безопасности и выявления стандартных ошибок в конфигурациях систем безопасности. Для получения дополнительных сведений о программе MBSA обратитесь к [веб-узлу Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134).

-   **Проверка версий файлов**

    **Примечание.** На каждом конкретном компьютере эти действия определяются установленной версией операционной системы Microsoft Windows. В случае затруднений для выполнения процедуры обратитесь к документации по установленной версии продукта.

    1.  Нажмите кнопку **Пуск** и выберите пункт **Найти**.
    2.  На панели **Результаты поиска** в области **Помощник по поиску** выберите пункт **Файлы и папки**.
    3.  В области **Часть имени или имя файла целиком** введите имя файла из соответствующей справочной таблицы по файлам и нажмите кнопку **Найти**.
    4.  В списке файлов щелкните правой кнопкой мыши имя файла из соответствующей справочной таблицы по файлам, затем щелкните **Свойства**.
        **Примечание.** В зависимости от версии операционной системы или установленных программ некоторые файлы, перечисленные в справочной таблице по файлам, могут оказаться не установленным.
    5.  На вкладке **Версия** определите версию файла, устанавливаемого на компьютере, сравнив ее с версией, приведенной в соответствующей таблице сведений о файлах.
        **Примечание.** Атрибуты, отличные от версии файла, могут измениться во ходе установки. Проверка того, что обновление было применено, путем сравнения других атрибутов файла с данными из таблицы сведений о файлах не поддерживается. Кроме того, при определенных условиях файлы в ходе установки могут быть переименованы. Если сведения о файле или версии отсутствуют, обратитесь к другим доступным методам проверки установки обновления.

-   **Проверка параметров системного реестра**

    Проверьте также установленные обновлением файлы в следующем разделе реестра:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB920670\\Filelist

    **Примечание**. Этот раздел реестра может не содержать полный список установленных файлов. Кроме того, этот раздел реестра может быть создан неправильно, если администратор или изготовитель оборудования интегрирует или добавляет в исходные установочные файлы Windows обновления для системы безопасности 920670.

### Прочие сведения

**Благодарности**

Корпорация Майкрософт [благодарит](http://go.microsoft.com/fwlink/?linkid=21127) за проведенную совместно работу по защите пользователей:

-   Педрама Амини (Pedram Amini) из [группы по разработкам в области безопасности компании TippingPoint](http://www.tippingpoint.com/security) за сообщение об уязвимости переполнения буфера объектов гиперссылок — [CVE-2006-3086](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3086).
-   Стива Тая (Steve Tai) из компании [CSC Australia Pty Limited](http://au.country.csc.com/en/) за сообщение об уязвимости функции объекта гиперссылки — [CVE-2006-3438](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3438).
-   **Другие обновления безопасности:**

Другие обновления безопасности можно загрузить по следующим ссылкам:

-   Обновления безопасности доступны на веб-узле [центра загрузки Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). Самый простой способ найти обновление — выполнить поиск по ключевому слову «security\_patch».
-   Для получения обновлений для пользовательских систем обращайтесь на [веб-узел Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747).

**Поддержка:**

-   Обращайтесь в [службу поддержки продуктов корпорации Майкрософт](http://go.microsoft.com/fwlink/?linkid=21131) по телефону 1-866-PCSAFETY (для жителей США и Канады). Звонки, связанные с обновлениями безопасности, обслуживаются бесплатно.
-   Пользователям в других странах для получения поддержки следует обращаться в местные представительства корпорации Майкрософт. Звонки, связанные с обновлениями безопасности, обслуживаются бесплатно. Для получения дополнительных сведений о службе поддержки корпорации Майкрософт посетите [веб-узел международной поддержки](http://go.microsoft.com/fwlink/?linkid=21155).

**Источники сведений о безопасности:**

-   Дополнительные сведения о безопасности продуктов корпорации Майкрософт см. на веб-узле [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132).
-   [Центр TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Службы Microsoft Software Update](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Службы Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   Программа [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   Веб-узел [Windows Update.](http://go.microsoft.com/fwlink/?linkid=21130)
-   Веб-узел [Центра обновлений Майкрософт](http://update.microsoft.com/microsoftupdate)
-   Каталог Windows Update: Дополнительные сведения о каталоге Windows Update см. в [статье 323166 базы знаний Майкрософт](http://support.microsoft.com/kb/323166).
-   Веб-узел [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Службы Software Update Services**

Службы Microsoft Software Update Services (SUS) позволяют администратору быстро и надежно устанавливать последние критические обновления и обновления безопасности на серверах, работающих под управлением Windows 2000 и Windows Server 2003, а также на настольных компьютерах, работающих под управлением Windows 2000 Professional и Windows XP Professional.

Для получения более подробных сведений о развертывании обновлений безопасности с помощью служб Software Update Services посетите [веб-узел Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Службы Windows Server Update Services**

Службы Windows Server Update Services (WSUS) позволяют администраторам быстро и надежно развертывать последние критические обновления и обновления безопасности для операционных систем Windows 2000 и более поздних версий, Office XP и более поздних версий, Exchange Server 2003 и SQL Server 2000 на системах Windows 2000, а также более поздних версиях операционных систем.

Для получения дополнительной информации о развертывании обновлений безопасности с помощью служб Windows Server Update Services посетите[веб-узел служб Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

Сервер Systems Management Server (SMS) корпорации Майкрософт предоставляет полностью настраиваемое решение для управления обновлениями в масштабах предприятия. С помощью сервера SMS администраторы могут определять необходимость установки обновлений безопасности на системах Windows и выполнять управляемое развертывание этих обновлений по всему предприятию с минимальными нарушениями работы конечных пользователей. Дополнительные сведения о том, как администраторы могут использовать сервер SMS 2003 для развертывания обновлений, см. на [веб-узле SMS 2003 Security Patch Management](http://go.microsoft.com/fwlink/?linkid=22939). Пользователи сервера SMS 2.0 могут также применять пакет [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340), с помощью которого упрощается развертывание обновлений системы безопасности. Дополнительные сведения о сервере SMS см. на [веб-узле SMS.](http://go.microsoft.com/fwlink/?linkid=21158)

**Примечание.** Для предоставления широкой поддержки при определении необходимости применения и развертывания обновлений, описанных в бюллетенях по безопасности, сервером SMS используются средства Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool и Enterprise Update Scanning Tool. С помощью этих средств не всегда удается определить необходимость некоторых обновлений программного обеспечения. В этих случаях для определения компьютеров, на которых требуется установка обновлений, администраторы могут воспользоваться учетными функциями SMS. Дополнительные сведения об этой процедуре см. на [веб-узле](http://go.microsoft.com/fwlink/?linkid=33341). При установке некоторых обновлений безопасности для продолжения работы на компьютере после его перезагрузки потребуется наличие соответствующих полномочий администратора. Администраторы могут устанавливать эти обновления с помощью средства Elevated Rights Deployment Tool (входит в состав пакетов [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) и [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)).

**Отказ от гарантий**

Сведения в статьях базы знаний Майкрософт предоставляются без каких-либо гарантий. Корпорация Майкрософт не предоставляет каких-либо гарантий, явных или подразумеваемых, включая любые гарантии товарности или пригодности для использования в определенных целях. Корпорация Майкрософт и ее поставщики ни при каких обстоятельствах не несут ответственности за возможный ущерб, включая косвенный, случайный, прямой, опосредованный и специальный ущерб, а также упущенную выгоду, даже если корпорация Майкрософт или ее поставщики заранее были извещены о возможности такого ущерба. Если действующее законодательство не допускает отказа от ответственности за косвенный или случайный ущерб, то описанные выше ограничения не действуют.

**Редакции**

-   Версия 1.0 (8 августа 2006 г.) Бюллетень опубликован.
-   Версия 1.1 (13 сентября 2006 г.): Обновлен подраздел «Проверка параметров системного реестра» для системы Windows 2003 в разделе «Сведения об обновлении для системы безопасности».

*Built at 2014-04-18T01:50:00Z-07:00*
