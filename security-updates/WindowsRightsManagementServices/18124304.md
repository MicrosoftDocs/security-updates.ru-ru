---
TOCTitle: Оптимизация производительности
Title: Оптимизация производительности
ms:assetid: '24dc9ca4-652b-41a6-9a99-95fdeca9120b'
ms:contentKeyID: 18124304
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc720220(v=WS.10)'
---

Оптимизация производительности
==============================

В материалах этого раздела приведены сведения об оптимизации производительности развертывания службы управления правами.

Оптимизация эффективности служб каталогов
-----------------------------------------

Можно наблюдать счетчики производительности служб каталогов, имеющиеся в службе управления правами. При необходимости можно оптимизировать производительность, изменяя параметры реестра, управляющие атрибутами кэша Active Directory.

Параметры реестра управляют следующими атрибутами кэша Active Directory.

-   Максимальное число участников для кэширования
-   Период допустимости для данных, хранящихся в кэше для участников
-   Максимальное число групп для кэширования
-   Период действия для данных, хранящихся в кэше для групп
-   Максимальное число записей о членстве в группах
-   Период допустимости для данных, хранящихся в кэше для членства в группах

Чем продолжительнее период допустимости для кэшированных данных или чем больше записей существует в кэше, тем быстрее служба управления правами сможет отвечать на запросы, требующие получения данных служб каталогов. Если данные хранятся в кэше Active Directory, прием-передача данных Active Directory для выполнения просмотра не требуется. Это сокращает время ответа для запроса.

Фактором компромисса для хранения большего объема данных в кэше Active Directory является больший расход ресурсов системной памяти. Другой аспект, который следует учитывать при настройке параметров реестра, заключается в том, что чем продолжительнее период допустимости, указанный для элемента, тем вероятнее возможность получения отдельных недопустимых результатов из кэша Active Directory. Это может произойти в том случае, если данные в Active Directory изменены, а в кэше Active Directory изменения еще не выполнены. Если изменения Active Directory происходят часто, можно указать короткий период допустимости для кэшированных данных, который бы отражал частоту выполнения изменений.

Счетчики производительности служб каталогов описаны в разделе "[Служба управления правами: Счетчики производительности DirectoryServices](https://technet.microsoft.com/37afea1d-f320-4040-96d8-57c0b45e6d46)” данного документа. Указания по их использованию можно найти в разделе “[Использование счетчиков производительности](https://technet.microsoft.com/096c3b17-c082-46c4-939c-4373af0c9dec)” данного документа. Наблюдаемые счетчики отображают "попадания" по отношению к "промахам". Служба управления правами должна выполнять просмотр Active Directory для поиска каждого промаха.

Дополнительные сведения о параметрах реестра и указания по их изменению можно найти в разделе "[Изменение параметров кэша Active Directory](https://technet.microsoft.com/8789a7a5-2065-4fae-9104-e0a70f1f2fb6)" данного документа.

Оптимизация параметров пула подключений Active Directory
--------------------------------------------------------

Чтобы повысить эффективность работы системы, можно добавить или изменить разделы реестра, которые управляют параметрами пула подключений упрощенного протокола доступа к каталогам (протокола LDAP) для Active Directory. Настройка разделов реестра описана в разделе "[Изменение параметров реестра для пула подключений](https://technet.microsoft.com/c61d91db-a1ad-4ca5-a492-015da629afbc)" данного документа.

Служба управления правами поддерживает оптимизацию подключений LDAP. Она устанавливает одно подключение для каждого глобального каталога Active Directory, и каждое подключение может обслуживать несколько потоков. Чтобы обеспечить надежность, она поддерживает пул подключений для обслуживания запросов. Во избежание возникновения большой нагрузки в отдельном глобальном каталоге служба управления правами использует алгоритм для распределения запросов, осуществляя балансировку нагрузки между глобальными каталогами, которые указаны в списке глобальных каталогов для выполнения запросов. Она также автоматически обрабатывает ошибки LDAP и при необходимости перенаправляет запросы в другой глобальный каталог.

Служба управления правами создает список глобальных каталогов для запросов с помощью алгоритма обнаружения топологии. Можно указать минимальное и максимальное число доступных глобальных каталогов, местоположение которых должно быть определено алгоритмом обнаружения топологии до запуска служб управления правами. Алгоритм обнаружения топологии сначала находит глобальные каталоги, существующие на текущем узле. Если требуются дополнительные глобальные каталоги, он выполняет их поиск на других узлах. Можно также указать максимальное число подключений, которые могут стать недоступными перед тем, как служба управления правами прекратит принимать запросы. Если один или несколько глобальных каталогов в списке запросов впоследствии становятся недоступными, алгоритм обнаружения топологии начинает поиск заменяющих глобальных каталогов для добавления их в список запросов.

Можно также указать в списке глобальные каталоги, которые должны использоваться службой управления правами. В этом случае алгоритм обнаружения топологии не выполняет поиск глобальных каталогов, добавляемых в список запросов.

Кроме того, можно настроить параметры, определяющие то, каким образом служба управления правами должна выполнять балансировку нагрузки между глобальными каталогами. Можно указать, насколько важны по отношению друг к другу следующие аспекты, когда принимается решение, посылать ли конкретный запрос в конкретный глобальный каталог.

-   **Циклическое обслуживание (WtRoundRobin)**. Этот параметр определяет относительную значимость балансировки нагрузки, в которой используется логическая схема циклического обслуживания. Параметр значимости по умолчанию равен 1. Это означает, что при выборе глобального каталога этот аспект имеет минимальную значимость для сервера.
-   **Число потоков во время подключения (WtThreadCount)**. Этот параметр определяет относительную значимость числа потоков, которые выделяются для подключения. Весовой параметр по умолчанию равен 100. Это означает, что в 100 раз важнее иметь малое число потоков глобального каталога для выбора подключения, чем применять балансировку нагрузки с использованием логической схемы циклического обслуживания.
-   **Медленное подключение (WtSlow)**. Этот параметр определяет относительную значимость медленного подключения. Параметр значимости по умолчанию равен 1000. Это означает, что в 10 раз важнее для подключения к глобальному каталогу выбрать более скоростное подключение, чем использовать малое число потоков.
