---
TOCTitle: Кэш Active Directory службы управления правами
Title: Кэш Active Directory службы управления правами
ms:assetid: 'c721a2eb-2fe9-4346-b426-3cc169b97265'
ms:contentKeyID: 18124529
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc747662(v=WS.10)'
---

Кэш Active Directory службы управления правами
==============================================

Каждый корневой сервер или кластер сертификации и сервер лицензирования службы управления правами имеет локальный кэш Active Directory, который содержит результаты запросов на членство в группе к глобальному каталогу Active Directory. Кроме кэша, который имеется на каждом сервере, существует общий кэш для каждого кластера, который хранится в базе данных служб каталогов. Назначение этих кэшей - снижение числа запросов, передаваемых в глобальный каталог, а также сокращение времени ответа для запросов на лицензирование.

Когда пользователь запрашивает лицензию на использование, отвечающий сервер должен оценить, имеет ли этот пользователь достаточные права в лицензии на публикацию. В самой простой ситуации пользователь, запрашивающий лицензию, явно указан в лицензии на публикацию. Однако во многих сценариях автор предоставляет права группе, а не отдельным пользователям.

Если лицензия на публикацию не содержит явного указания на запрашивающего пользователя, а вместо этого предоставляет права для группы, сервер должен оценить членства в группе пользователя, чтобы определить, является ли он членом группы, которой были выданы права. Для этого сервер посылает запрос LDAP в глобальный каталог.

Серверы управления правами кэшируют все результаты запросов "группа-членство" в локальном кэше Active Directory и базе данных службы каталогов кластера. Серверы могут затем получать данные о членстве в группе из этих кэшей, что уменьшает число запросов, которые они должны предоставить в глобальный каталог. По умолчанию запрашивается ближайший сервер. Однако в ключе реестра GC можно указать серверы глобального каталога для запросов. Дополнительные сведения об этом параметре можно найти в разделе "Изменение параметров реестра для пула подключений" документа "Работа с сервером службы управления правами" данного комплекта.

Чтобы оценить членства в группе пользователя, сервер сначала проверяет кэш, чтобы определить, нет ли в нем данных о членстве пользователя в группе. В противном случае сервер выполнит проверку базы данных служб каталогов для этого кластера. Если данные о членстве в группе отсутствуют в этой базе данных, сервер сделает запрос в глобальный каталог.

Для пользователей и групп кэшируются следующие атрибуты Active Directory.

-   mail
-   ProxyAddresses (только адреса электронной почты SMTP)
-   objectSID
-   sidHistory
-   memberOf (GUID группы, в которую входит пользователь или группа)

Для элементов в локальном кэше Active Directory устанавливаются отметки времени. Параметры реестра задают срок действия для элементов, находящихся в кэше, а также общее число элементов, которые можно кэшировать. Эти параметры могут влиять на производительность серверов. Дополнительные сведения можно найти в разделе "Изменение параметров кэша Active Directory" документа "Работа с сервером службы управления правами" данного комплекта.
