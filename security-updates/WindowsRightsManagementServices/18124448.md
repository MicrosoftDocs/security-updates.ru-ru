---
TOCTitle: Оценка требований к масштабированию
Title: Оценка требований к масштабированию
ms:assetid: '89f0138c-946d-47d7-a286-041d4d9606a8'
ms:contentKeyID: 18124448
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc747663(v=WS.10)'
---

Оценка требований к масштабированию
===================================

Чтобы решить, развертывать один сервер или несколько, определите, сколько пользователей будут использовать систему управления правами и сколько файлов будет защищено.

Так получаются средние условия для использования. Затем запланируйте требования к пиковым нагрузкам, которые могут превышать средние требования в три раза.

Учтите также стандарты отказоустойчивости и доступности служб компании.

Чтобы определить требования к производительности, служба управления правами была протестирована с помощью сервера с двумя процессорами Pentium 4 (2.4 ГГц) и 1 ГБ ОЗУ. В этой конфигурации сервер управления правами предоставляет приблизительно 100 лицензий в секунду.

Можно использовать следующие цифры во время планирования загрузки производственных мощностей, чтобы определить требования к использованию системы службы управления правами.

###  

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Транзакция</th>
<th style="border:1px solid black;" >Вхождение</th>
<th style="border:1px solid black;" >Использование полосы пропускания клиент-сервер (кБ)</th>
<th style="border:1px solid black;" >Использование полосы пропускания сервер-клиент (кБ)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Запрос лицензии</td>
<td style="border:1px solid black;">Повторяется для каждого пользователя и каждой части содержимого</td>
<td style="border:1px solid black;">64</td>
<td style="border:1px solid black;">18</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Сертификация учетной записи управления правами</td>
<td style="border:1px solid black;">Только трафик инициализации службы управления правами</td>
<td style="border:1px solid black;">12</td>
<td style="border:1px solid black;">16</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Регистрация клиента</td>
<td style="border:1px solid black;">Только трафик инициализации службы управления правами</td>
<td style="border:1px solid black;">17</td>
<td style="border:1px solid black;">16</td>
</tr>
</tbody>
</table>
  
Кроме того, на пропускную способность сети может влиять трафик запросов Active Directory. Однако обычно он не влияет на пропускную способность, если серверы управления правами развертываются в непосредственной близости от серверов глобальных каталогов. Исключение возможно в том случае, если в результате сбоя всех серверов глобальных каталогов на веб-узле произошло переключение на другой веб-узел через подключение, которое не поддерживает такую загрузку.
  
В следующей таблице приведены основные данные по использованию полосы пропускания для транзакций службы управления правами, которые можно использовать для оценки влияния на трафик запросов Active Directory в сети организации.
  
###  

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Транзакция</th>
<th style="border:1px solid black;" >Использование полосы пропускания от службы управления правами до глобального каталога (байты)</th>
<th style="border:1px solid black;" >Использование полосы пропускания от глобального каталога до службы управления правами (байты)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Подключение службы управления правами (ldap_bind)</td>
<td style="border:1px solid black;">1600</td>
<td style="border:1px solid black;">200</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Оценка членства группы службы управления правами (ldap_search)</td>
<td style="border:1px solid black;">200</td>
<td style="border:1px solid black;">100</td>
</tr>
</tbody>
</table>
  
Используя эти справочные таблицы, убедитесь, что вы используете исходные цифры своей установки. Например, если пользователь относится к 15 группам, то потребуется 200 байт для поискового запроса от службы управления правами и 1500 байт (100 байт x 15) - для ответа от глобального каталога.
  
Планирование загрузки службы необходимо производить в соответствии с ожидаемой нагрузкой, связанной с запросами на лицензии для содержимого, так как эти запросы составляют основной объем операций, выполняемых службой управления правами. Скорость на входе или выходе, а также пропускная способность дисковода не являются критическими факторами для работы службы управления правами, так как запросы на лицензию содержат небольшое количество данных и могут полностью кэшироваться.
  
Загрузка ЦП - это наиболее важная переменная при определении пропускной способности сервера, поэтому важно выбрать соответствующие процессоры. Требования к памяти серверов управления правами повышаются по мере роста нагрузки на сервер и приближения ее к максимальной производительности сервера. В этом случае служба IIS помещает входящие запросы в очередь до их обработки сервером. В зависимости от ограничения для очереди, настроенного в службе IIS, входящие запросы при достижении указанной максимальной длины очереди больше не ставятся в очередь и отклоняются.
  
Требования к памяти для службы управления правами (рабочий комплект) для схемы нагрузки должны полностью соответствовать ограничениям размера физической памяти. Общий размер памяти в большей степени зависит от потребностей в кэшировании расширения группы, чем от других факторов. Для каждого сервера, на котором работает служба управления правами, рекомендуется использовать хотя бы 1 ГБ ОЗУ.
  
Каждый сервер управления правами может обработать определенное число клиентских запросов за определенное время (приблизительно от 30 до 50 лицензий в секунду). Поэтому добавление серверов позволяет линейно снизить общую загрузку кластера по выдаче лицензий, а также обеспечивает повышенную надежность. Поэтому при масштабировании необходимо учитывать не только каждый отдельный сервер, но и число развертываемых серверов. Следующие примеры конфигураций показывают, как по этим оценкам можно рассчитать требования к масштабированию для установки службы управления правами.
  
-   Конфигурация для небольшой загрузки  
    В некоторых организациях предъявляются очень низкие требования к загрузке службы управления правами. Например, в организации, насчитывающей около 5 000 пользователей, из которых 10 процентов регулярно используют службу управления правами для защиты содержимого, следует исходить из того, что каждый средний пользователь защищает 3 сообщения электронной почты в час. С учетом этих требований серверам управления правами потребуется предоставлять 1 500 лицензий в час, что составляет 0,42 лицензии в секунду. Это и есть средняя загрузка. Если умножить эту цифру на 3, то получится значение пиковой загрузки (1,25 лицензии в секунду).  
    Из этих вычислений следует, что нагрузка очень небольшая. Поэтому для этой организации достаточно будет использовать один сервер управления правами.  
-   Конфигурация для средней загрузки  
    Во многих организациях имеются очень большие группы пользователей, но при этом предъявляются умеренные требования к загрузке. Например, в организации, насчитывающей около 40 000 пользователей, из которых 50 процентов регулярно используют службу управления правами для защиты содержимого, следует исходить из того, что каждый средний пользователь защищает 7 сообщений электронной почты и 1 документ или другой файл в час. С учетом этих требований серверам управления правами потребуется предоставлять 160 000 лицензий в час, что составляет 44,4 лицензии в секунду. Это и есть средняя загрузка. Если умножить эту цифру на 3, то получится значение пиковой загрузки (133,3 лицензии в секунду).  
    Из этих вычислений видно, что загрузка может быть средняя, и 3 сервера управления правами будет достаточно для обеспечения потребностей пользователей, а 6 серверов управления правами обеспечат текущие потребности пользователей и потенциал для роста.  
-   Конфигурация для большой загрузки  
    В более крупных организациях часто имеются очень большие группы пользователей и при этом предъявляются значительные требования к загрузке. Например, в организации, насчитывающей около 150 000 пользователей, из которых 70 процентов регулярно используют службу управления правами для защиты содержимого, следует исходить из того, что каждый средний пользователь защищает 15 сообщений электронной почты и 3 документов или 3 других файла в час. С учетом этих требований серверам управления правами потребуется предоставлять 1 890 000 лицензий в час, что составляет 525 лицензий в секунду. Это и есть средняя загрузка. Если умножить эту цифру на 3, то получится значение пиковой загрузки (1575 лицензии в секунду).  
    Из этих вычислений видно, что загрузка может быть очень высокая, и 32 сервера управления правами будет достаточно для обеспечения потребностей пользователей, а 51 сервер управления правами обеспечит текущие потребности пользователей и потенциал для роста.
  
Если при расчетах выяснилось, что в секунду предоставляется от 30 до 50 лицензий, то, как правило, потребуется использовать дополнительный сервер управления правами.
