---
TOCTitle: Файл сведений для WSUS с пакетом обновления 1
Title: Файл сведений для WSUS с пакетом обновления 1
ms:assetid: '937ecfe9-e8e0-41ac-85f7-4b65956f3d1e'
ms:contentKeyID: 18149101
ms:mtpsurl: 'https://technet.microsoft.com/ru-ru/library/Cc708486(v=WS.10)'
---

Файл сведений для WSUS с пакетом обновления 1
=============================================

Этот документ описывает известные проблемы, касающиеся службы обновления Windows Server Update Services (WSUS) с пакетом обновления 1. Сразу после сведений о службе WSUS с пакетом обновления 1 можно найти всю информацию, ранее входившую в первоначальный файл сведений для WSUS. Эта информация содержит рекомендации и требования по установке службы WSUS. Чтобы загрузить службу WSUS с пакетом обновления 1, см. [Центр загрузки корпорации Майкрософт](http://go.microsoft.com/fwlink/?linkid=67516).

Новые возможности службы WSUS с пакетом обновления 1
----------------------------------------------------

WSUS с пакетом обновления 1 – это выпуск пакета обновления, повышающий безопасность, надежность, масштабируемость, совместимость и производительность службы WSUS. Новые функции и усовершенствования:

-   Поддержка клиента Windows Vista: Сервер службы WSUS с пакетом обновления 1 может обновлять компьютеры под управлением Windows Vista.
-   Расширенная поддержка языка клиента: Поддержка для всех языков Office и Windows Vista.
-   Новая версия WMSDE: Экземпляр WMSDE обновляется с помощью WSUS с пакетом обновления 1 до WMSDE с пакетом обновления 4 (окончательная первоначальная версия (RTM) службы WSUS использует WMSDE с пакетом обновления 3).
-   Повышение производительности: WSUS с пакетом обновления 1 предусматривает различные меры повышения производительности для ускорения реакции пользовательского интерфейса.
-   Все исправления: WSUS с пакетом обновления 1 содержит все изменения и исправления, выпущенные после выхода окончательной первоначальной версии (RTM) WSUS.
-   Поддержка для SQL Server 2005.

Перед началом обновления с использованием WSUS с пакетом обновления 1
---------------------------------------------------------------------

Для обновления с использованием WSUS с пакетом обновления 1 характерны следующие проблемы. Учитывайте, что проблемы и требования, описанные в пункте “Перед началом работы” первоначальной версии данного раздела, в этом разделе не рассматриваются и остаются действительными. Например, по-прежнему действительны требования к установке, описанные в первоначальной версии раздела “Перед началом работы”.

**Примечание**   После применения пакета обновления 1 (SP1) к WSUS 2.0 этот пакет обновления невозможно удалить. Удаление пакета обновления 1 приведет к удалению всего продукта.

**Внимание!**   Этот документ содержит инструкции по изменению реестра. Перед изменением реестра обязательно создайте его резервную копию. Обязательно узнайте, как восстанавливать реестр в случае неполадок. Дополнительные сведения о резервировании, восстановлении и изменении реестра см. в следующей статье базы знаний Майкрософт:

[Описание реестра Microsoft Windows](http://support.microsoft.com/kb/256986) (http://support.microsoft.com/kb/256986/)

#### Проблема 1: Убедитесь в наличии достаточного места на диске для резервирования базы данных

При обновлении с окончательной первоначальной версии (RTM) WSUS программа установки WSUS с пакетом обновления 1 автоматически создает резервную копию базы данных WSUS. Следует убедиться в том, что в файловой системе сервера WSUS имеется достаточно места на диске для сохранения резервной копии базы данных WSUS, в противном случае установить WSUS с пакетом обновления 1 не удастся.

**Определение наличия достаточного места на диске**
1.  Откройте проводник и перейдите к папке, в которой хранится база данных WSUS. По умолчанию WSUS устанавливает базу данных сюда:

    
        ```
2.  Нажмите и удерживайте клавишу **CTRL**, выделите **SUSDB.MDF** и **SUSDB\_log.LDF**, затем щелкните правой кнопкой мыши и выберите **Свойства**.

3.  В диалоговом окне **Файлы** проверьте значение в поле **Размер файла**. Для установки WSUS с пакетом обновления 1 свободное место на диске должно быть не меньше этого значения.

4.  В меню **Пуск** выберите **Мой компьютер**. Убедитесь, что на диске, куда устанавливается WSUS, имеется необходимое свободное место.

Если по каким-либо причинам установить WSUS с пакетом обновления 1 не удается, восстановите резервную базу данных вручную. Инструкции по восстановлению базы данных WSUS см. в разделе [Руководство по использованию службы WSUS](http://technet2.microsoft.com/windowsserver/en/library/05f2e884-ae62-4c90-9681-6c9f2f3c9fd91033.mspx).

#### Проблема 2: WSUS с пакетом обновления 1 обновляет только окончательную первоначальную версию (RTM) WSUS

Использовать WSUS с пакетом обновления 1 можно только для обновления окончательной первоначальной версии (RTM) WSUS. В настоящее время обновление WSUS с версии-кандидата (RC) не поддерживается. Если на компьютере установлена версия-кандидат (RC) WSUS или какая-либо старая сборка WSUS, следует сначала удалить эту сборку, а затем запустить WSUS с пакетом обновления 1.

#### Проблема 3: Во время обновления до WSUS с пакетом обновления 1 на сервере останавливается служба IIS

В процессе обновления установщик WSUS с пакетом обновления 1 останавливает IIS (Internet Information Services) на вашем сервере. Это означает, что все веб-узлы, размещенные на вашем сервере при установке IIS, во время обновления будут недоступны. По завершении этого обновления IIS запустится автоматически.

#### Проблема 4: Во время обновления не следует запускать приложения, вызывающие API-интерфейсы WSUS

Вызовы интерфейсов программирования приложений (API) для службы WSUS будут конфликтовать с установщиком WSUS с пакетом обновления 1, приводя к сбою обновления (система предложит перезагрузить сервер для завершения обновления).

#### Проблема 5: Для обновлении до WSUS с пакетом обновления 1, возможно, потребуется отключить антивирусную программу

При обновлении службы WSUS до версии WSUS с пакетом обновления 1 может потребоваться отключить антивирусную программу, чтобы успешно выполнить обновление или применить пакет обновления. После отключения антивирусной программы перезагрузите компьютер Windows Server, прежде чем применить обновление или пакет обновления. Эта процедура предотвращает блокирование файлов, к которым необходим доступ в процессе обновления. После завершения установки, снова включите свою антивирусную программу. Инструкции по отключению и повторному включению антивирусной программы и версии см. на веб-узле поставщика своей антивирусной программы.

| ![](/security-updates/images/Cc708486.Caution(WS.10).gif)Внимание!                                                                                                                                                                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| При использовании такого приема компьютер или сеть могут стать более уязвимыми для атак злоумышленников или вредоносных программ, например вирусов. Мы не рекомендуем такой способ действий, но предоставляем информацию, чтобы пользователи могли реализовать этот прием на свое усмотрение. Используйте этот прием под свою ответственность. |

| ![](/security-updates/images/Cc708486.note(WS.10).gif)Примечание                                                                                                                                                                                                          |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Антивирусная программа предназначена для защиты компьютера от вирусов. Не следует загружать или открывать файлы от источников, которым вы не доверяете, посещать веб-узлы, которым вы не доверяете, или открывать вложения электронной почты, пока антивирусная программа отключена. |

#### Проблема 6: Если используется прокси-сервер, обновление до пакета обновления 1 может сбросить имя пользователя и пароль в конфигурации прокси

Если используется прокси-сервер, в некоторых случаях обновление до пакета обновления 1 может сбросить имя пользователя и пароль в конфигурации прокси. Из-за этого синхронизация обновлений с серверов Microsoft Server может генерировать сообщение об ошибке “недействительный параметр”. Для решения этой проблемы повторно укажите имя пользователя и пароль в конфигурации прокси и повторно синхронизируйте свой сервер.

#### Проблема 7: Инструкции по восстановлению при неудачном обновлении для возврата WSUS-сервера в согласованное состояние и повторения обновления.

Если обновление до версии WSUS с пакетом обновления 1 не удается, установка WSUS может прекратиться в несогласованном или непригодном к использованию состоянии. Чтобы повторить обновление до WSUS с пакетом обновления 1, нужно привести свою установку WSUS в согласованное состояние. Для этого можно использовать резервную базу данных, созданную в начале процесса обновления, чтобы вернуть свой WSUS-сервер в предустановочное состояние.

Чтобы повторить обновление до WSUS с пакетом обновления 1 в случае неудачного обновления, выполните следующие действия:

**Повторение обновления до WSUS с пакетом обновления 1**
1.  Определите местоположение резервной базы данных, просмотрев содержимое файла журнала WSUSSetup\_%отметка\_времени%.log. Этот файл находится в следующей папке:

    -   %programfiles%\\Update Services\\LogFiles

2.  Восстановите резервную базу данных на компьютере WSUS с помощью следующей команды:

    -   osql.exe -S &lt;DatabaseInstance&gt; -E -Q "USE master ALTER DATABASE SUSDB SET SINGLE\_USER WITH ROLLBACK IMMEDIATE RESTORE DATABASE SUSDB FROM DISK=N'&lt;PathToDatabaseBackup&gt;' WITH REPLACE ALTER DATABASE SUSDB SET MULTI\_USER"
    -   Не забудьте заменить &lt;DatabaseInstance&gt; и &lt;PathToDatabaseBackup&gt; на значения своей установки.
    -   Для элемента &lt;DatabaseInstance&gt; используйте значение из следующего раздела реестра:
    -   HKLM\\Software\\Microsoft\\Update Services\\Server\\Setup\\SqlServerName
    -   Для элемента &lt;PathToDatabaseBackup&gt; используйте значение, определенное в пункте 1.

3.  Удалите WSUS, но сохраните базу данных WSUS, файлы журнала и файлы пакета обновления, если будет предложено удалить их. (Убедитесь, что в окне **Удаление служб обновления Microsoft Windows Server** все флажки сняты.)

4.  Заново установите окончательную первоначальную версию (RTM) WSUS (первоначальную версию, а не WSUS с пакетом обновления 1). Когда будет предложено, используйте существующую базу данных. Это обеспечит возврат вашей системы WSUS в согласованное состояние.

5.  Установите WSUS с пакетом обновления 1.

**Примечание**    Резервную копию базы данных, созданную ранее (см. пункт 1), нельзя использовать в чистой установке WSUS с пакетом обновления 1. Схема базы данных изменилась, поэтому без обновления до WSUS с пакетом обновления 1 эта база данных будет несовместимой.

#### Проблема 8: Неудачное обновление до WSUS с пакетом обновления 1 возможно в некоторых случаях миграции базы данных WMSDE

Решение проблемы зависит от конечного пункта миграции: локальный или удаленный SQL Server.

#### База данных WMSDE мигрировала на локальный сервер SQL 2000

Следует изменить значение одного раздела реестра, чтобы пакет установки WSUS с пакетом обновления 1 распознал отсутствие базы данных WMSDE для обновления.

Если база данных WMSDE была перенесена на локальный сервер SQL 2000, то перед попыткой обновления до WSUS с пакетом обновления 1 внесите в реестр следующее изменение:

-   Поменяйте значение следующего раздела реестра с "1" на "0":
    -   HKLM\\Software\\Microsoft\\Update Services\\Server\\Setup\\WmsdeInstalled  

#### База данных WMSDE мигрировала на удаленный сервер SQL 2000

Следует изменить значения двух разделов реестра, чтобы пакет установки WSUS с пакетом обновления 1 распознал отсутствие базы данных WMSDE для обновления. Обновление следует инициировать на сервере заднего плана, а затем на сервере переднего плана.  

Если база данных WMSDE была перенесена на удаленный SQL Server, то перед попыткой обновления до WSUS с пакетом обновления 1 внесите в реестр следующие изменения:

1.  Поменяйте значение следующего раздела реестра с "1" на "0":
    -   HKLM\\Software\\Microsoft\\Update Services\\Server\\Setup\\WmsdeInstalled 
2.  Поменяйте значение следующего раздела реестра с "0x80" на "0x20":
    -   HKLM\\Software\\Microsoft\\Update Services\\Server\\Setup\\InstallType 

После изменения этих значений разделов реестра инициируйте обновление сначала на серверах заднего плана, а затем на серверах переднего плана.

#### Проблема 9: WSUS с пакетом обновления 1 не обновляет WSUS-серверы, которые настраиваются с развертыванием удаленных SQL Server

Следует запустить пакет установки WSUS с пакетом обновления 1 на серверах как переднего, так и заднего плана.

**Обновление до WSUS с пакетом обновления 1 при использовании удаленного SQL Server**
1.  Запустите пакет установки на серверах переднего плана без коммутаторов и выберите обновление.

2.  Запустите пакет установки на серверах заднего плана без коммутаторов и выберите обновление.

#### Проблема 10: Изменение имени компьютера перед обновлением до WSUS с пакетом обновления 1 может привести к неудачному обновлению

Если после установки окончательной первоначальной версии (RTM) WSUS и перед обновлением до WSUS с пакетом обновления 1 имя компьютера изменялось, обновление до WSUS с пакетом обновления 1 может дать сбой.

Используйте следующий сценарий для удаления и повторного добавления групп "Администраторы" для ASPNET и WSUS. Затем снова запустите обновление.

        ```
| ![](/security-updates/images/Cc708486.note(WS.10).gif)Примечание                                     |
|-----------------------------------------------------------------------------------------------------------------|
| Возможно, потребуется заменить &lt;ContentDirectory&gt; в последней строке на путь к текущему хранилищу данных. |

Оригинальное содержимое файла сведений WSUS
-------------------------------------------

Далее приводится оригинальное содержимое файла сведений WSUS. Версия WSUS с пакетом обновления 1 *не* решает проблем, описанных ниже. Эта информация включена сюда для удобства пользователей.

Перед началом
-------------

#### Проблема 1: Служба IIS должна быть установлена

Для службы обновления Microsoft® Windows Server™ Update Services (WSUS) необходимо, чтобы служба Internet Information Services (IIS) была установлена. Однако на Microsoft Windows Server 2003 и Microsoft Windows® 2000 Server служба IIS по умолчанию не установлена, поэтому программа установки WSUS прекратит работу и выдаст сообщение о том, что служба IIS не установлена.

Установка службы IIS:

1.  Откройте панель управления.
2.  Дважды щелкните **Установка и удаление программ**.
3.  Щелкните **Добавление и удаление компонентов Windows**.
4.  В списке **Компоненты** выберите **Сервер приложений**.
5.  Щелкните **Сведения**.
6.  Установите флажок **ASP.NET**. Включите **Поддержка доступа по протоколу COM+**, тогда параметр "Службы IIS" будет выбран автоматически.
7.  Выберите **Службы IIS** и щелкните **Сведения**, чтобы просмотреть список дополнительных компонентов IIS.
8.  Выберите все дополнительные компоненты, которые нужно установить. Дополнительный компонент "Служба WWW" содержит важные подкомпоненты, например "Страницы ASP" и "Удаленное администрирование" (HTML). Чтобы просмотреть и выбрать эти подкомпоненты, щелкните "Служба WWW" и затем "Сведения". Нажмите кнопку "ОК", прежде чем вернуться в мастер компонентов Windows.
9.  Нажмите **Далее** и дождитесь завершения мастера компонентов Windows.
10. После установки службы IIS, запустите программу установки WSUS.

#### Проблема 2: Для установки WSUS на серверах под управлением Windows 2000 Server в службе IIS должен присутствовать хотя бы один веб-узел

Программе установки WSUS, возможно, не удастся создать веб-узел, если на момент запуска этой программы в службе IIS не было ни одного узла. Это возможно, например, если в службе IIS был только один веб-узел Software Update Services (SUS) 1.0, и перед установкой WSUS он был удален.

В этом случае с помощью оснастки "Диспетчер IIS" нужно создать новый веб-узел. После этого во время установки WSUS можно выбрать этот узел или указать новый.

Если вы уже пытались установить WSUS, и установка была прервана из-за отсутствия веб-узлов, откройте оснастку "Диспетчер IIS" и удалите узел "Веб-узел \#1". Затем выполните действия, описанные выше, и снова запустите программу установки.

#### Проблема 3: Установка необходимых компонентов

#### Требования к программному обеспечению

В следующей таблице представлено необходимое ПО для каждой поддерживаемой операционной системы. Перед запуском программы установки WSUS убедитесь, что WSUS-серверы отвечают требованиям данного списка. Если какое-либо из этих обновлений требует перезагрузки компьютера в ходе установки, следует выполнить перезагрузку до завершения установки WSUS.

###  

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Операционная система</th>
<th style="border:1px solid black;" >Требования</th>
<th style="border:1px solid black;" >Загрузка</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Все операционные системы</td>
<td style="border:1px solid black;">Microsoft Internet Information Services (IIS) 5.0</td>
<td style="border:1px solid black;">Установка из операционной системы.
См. &quot;Проблема 1: Служба IIS должна быть установлена&quot;.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Все операционные системы</td>
<td style="border:1px solid black;">Background Intelligent Transfer Service (BITS) 2.0</td>
<td style="border:1px solid black;">Для ОС Windows Server 2003 см. разделы &quot;Обновление для Background Intelligent Transfer Service (BITS) 2.0&quot; и &quot;WinHTTP 5.1 Windows Server 2003 (KB842773)&quot; в Центре загрузки (<a href="http://go.microsoft.com/fwlink/?linkid=47251">http://go.microsoft.com/fwlink/?LinkId=47251</a>).
Для ОС Windows Server 2000 см. разделы &quot;Обновление для Background Intelligent Transfer Service (BITS) 2.0&quot; и &quot;WinHTTP 5.1 Windows 2000 (KB842773)&quot; в Центре загрузки (<a href="http://go.microsoft.com/fwlink/?linkid=46794">http://go.microsoft.com/fwlink/?LinkId=46794</a>).</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows Server 2003</td>
<td style="border:1px solid black;">Microsoft .NET Framework 1.1 SP 1 для Windows Server 2003</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=47358">Microsoft .NET Framework 1.1 SP 1 для Windows Server 2003</a>
Другой способ: перейдите в <a href="http://go.microsoft.com/fwlink/?linkid=47370">Центр обновления Windows</a> и проверьте разделы &quot;Важные обновления&quot; и &quot;Пакеты обновления&quot;; установите Microsoft .NET Framework 1.1 SP 1 для Windows Server 2003.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows Server 2003</td>
<td style="border:1px solid black;">ПО для баз данных, полностью совместимое с Microsoft SQL</td>
<td style="border:1px solid black;">Н/Д</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows 2000 Server</td>
<td style="border:1px solid black;">ПО для баз данных, полностью совместимое с Microsoft SQL</td>
<td style="border:1px solid black;">Если вы не используете Microsoft SQL Server 2000, можно установить Microsoft SQL Server 2000 Desktop Engine (MSDE 2000). Это потребует дополнительных действий. Дополнительные сведения см. ниже в пункте &quot;Установка MSDE на сервере Windows 2000&quot;.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows 2000 Server</td>
<td style="border:1px solid black;">Microsoft Internet Explorer 6.0 SP 1</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=47359">Internet Explorer 6 SP 1</a></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Windows 2000 Server</td>
<td style="border:1px solid black;">Дистрибутивный пакет Microsoft .NET Framework версии 1.1</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=47369">Дистрибутивный пакет Microsoft .NET Framework версии 1.1</a></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows 2000 Server</td>
<td style="border:1px solid black;">Microsoft .NET Framework 1.1 SP 1</td>
<td style="border:1px solid black;"><a href="http://go.microsoft.com/fwlink/?linkid=47368">Microsoft .NET Framework 1.1 SP 1</a>
Другой способ: перейдите в <a href="http://go.microsoft.com/fwlink/?linkid=47370">Центр обновления Windows</a> и проверьте разделы &quot;Важные обновления&quot; и &quot;Пакеты обновления&quot;; установите Microsoft .NET Framework 1.1 SP 1 для Windows Server 2000.</td>
</tr>
</tbody>
</table>
 

Если необходимо, в дополнение к этим требованиям служба WSUS может установить или настроить ASP.NET версии 1.1 на вашем сервере. (ASP.NET настраивается программой установки WSUS.)

#### Установка MSDE 2000 на сервере Windows 2000

Если для службы WSUS используется Windows 2000 и нет доступа к Microsoft SQL Server 2000, перед запуском программы установки WSUS следует установить Microsoft SQL Server 2000 Desktop Engine (MSDE). Если MSDE уже установлен на WSUS-сервере, устанавливать его экземпляр специально для службы WSUS не нужно. Можно просто указать имя существующего экземпляра в процессе установки WSUS.

Установка MSDE на сервере Windows 2000 Server выполняется в четыре этапа. Во-первых, загрузите и раскройте архив MSDE в папку на своем WSUS-сервере. Во-вторых, используя командную строку и ее параметры, запустите программу установки MSDE, назначьте пароль sa и укажите имя экземпляра "WSUS". В-третьих, после завершения установки MSDE, убедитесь, что данный экземпляр службы WSUS работает как служба NT. В-четвертых, добавьте в MSDE обновление для системы безопасности, чтобы защитить свой WSUS-сервер.

#### Шаг 1: Загрузка и раскрытие архива MSDE

Загрузите и раскройте архив MSDE в папку на своем WSUS-сервере. См. [Microsoft SQL Server 2000 Desktop Engine (MSDE 2000) Release A](http://go.microsoft.com/fwlink/?linkid=47366).

#### Шаг 2: Установка MSDE

Используя командную строку и ее параметры, запустите программу установки MSDE, назначьте пароль sa и укажите имя экземпляра "WSUS". После завершения установки MSDE, убедитесь, что данный экземпляр "WSUS" работает как служба NT.

Чтобы установить MSDE, назначьте пароль sa и укажите имя экземпляра:

1.  В окне командной строки перейдите в папку установки MSDE, выбранную ранее, см. “Шаг 1: Загрузка и раскрытие архива MSDE.”
2.  Введите следующие данные: **setup sapwd="***пароль***" instancename=WSUS**
    где *пароль* – это надежный пароль для учетной записи sa (системного администратора) на данном экземпляре MSDE, а **instancename** – это имя экземпляра базы данных. Другой способ: для своей базы данных WSUS можно использовать имя экземпляра по умолчанию (вместо "WSUS"). Если выбрать этот способ, в параметр командной строки не нужно вводить **instancename=WSUS**. Эта команда запускает программу установки MSDE, назначает пароль sa, и в качестве имени присваивает этому экземпляру MSDE указанное значение.

#### Шаг 3: Проверка установленного экземпляра MSDE "WSUS"

1.  Нажмите кнопку **Пуск** и выберите пункт **Выполнить**.
2.  В окне **Открыть** введите **services.msc** и нажмите кнопку **OK**.

Прокрутите вниз список служб и убедитесь, что служба под именем MSSQL$WSUS (если использовалось имя экземпляра "WSUS") или MSSQLSERVER (если использовалось имя экземпляра по умолчанию) существует.

#### Шаг 4: Запуск экземпляра MSDE.

После установки MSDE этот экземпляр потребуется запустить. Если использовалось имя экземпляра "WSUS", запустится "MSSQL$WSUS." Если использовалось имя экземпляра по умолчанию, запустится MSSQLSERVER. Пока эта служба не запущена, служба WSUS не может использовать экземпляр базы данных.

#### Шаг 5: Обновление MSDE

Следует загрузить и установить обновление для системы безопасности, описанное в бюллетене [MS03-031: Накопительное обновление для системы безопасности сервера SQL Server](http://go.microsoft.com/fwlink/?linkid=47364).

Для загрузки исправления к системе безопасности см. [SQL Server 2000 (32-bit) Security Patch MS03-031](http://go.microsoft.com/fwlink/?linkid=47363).

#### Проблема 4: Минимальный размер необходимого дискового пространства

Ниже приводятся минимальные требования к свободному пространству на диске для установки службы WSUS:

-   1 гигабайт (ГБ) на системном разделе
-   2 ГБ для тома, на котором будут храниться файлы базы данных
-   6 ГБ, исходя из планируемого количества содержимого

#### Проблема 5: Перед установкой последней версии WSUS нужно удалить более ранние версии с помощью функции "Установка и удаление программ"

Если планируется установить службу WSUS на сервер, на котором уже установлена служба обновления Windows бета-версии 1 или 2, следует сначала удалить более раннюю версию с помощью функции "Установка и удаление программ" в панели управления.

#### Проблема 6: Для службы WSUS требуется включить параметр "Вложенные триггеры" в SQL Server

Этот параметр по умолчанию включен; однако он может быть отключен администратором SQL Server.

Если базу данных SQL Server планируется использовать как хранилище данных WSUS, администратор SQL Server должен убедиться, что параметр "Вложенные триггеры" на сервере включен, до того как администратор WSUS установит службу WSUS и укажет базу данных во время установки.

Программа установки WSUS включает параметр РЕКУРСИВНЫЕ\_ТРИГГЕРЫ, являющийся параметром конкретной базы данных; однако она не включает параметр "Вложенные триггеры", являющийся глобальным параметром сервера.

Чтобы проверить, включены ли вложенные триггеры, используйте следующие данные:

**sp\_configure 'nested triggers'**

Чтобы включить параметр "Вложенные триггеры" в SQL Server, выполните следующие действия из пакетного файла на компьютере под управлением SQL Server:

**sp\_configure 'nested triggers', 1**

**GO**

**RECONFIGURE**

**GO**

#### Проблема 7: Параметры командной строки программы установки WSUS

Для WSUS предусмотрена возможность автоматической установки. Дополнительные сведения и параметры командной строки см. в документе "Приложение А: Автоматическая установка" в разделе [Развертывание службы Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=41777).

Известные проблемы
------------------

#### Проблема 1: Мастер блокировки IIS

Если служба Internet Information Services (IIS) используется на компьютере под управлением Windows 2000 Server, установите последнюю версию Мастера блокировки IIS (с функцией URLScan) со страницы "Средство блокировки IIS" на веб-узле Microsoft TechNet. Корпорация Майкрософт настоятельно рекомендует установить это средство для сохранения безопасности ваших серверов IIS. Мастер блокировки IIS позволяет отключить ненужные функции службы IIS, повышая тем самым уровень безопасности.

| ![](/security-updates/images/Cc708486.note(WS.10).gif)Примечание                                                                                                                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Программа установки WSUS не устанавливает этих компонентов. Их потребуется установить вручную. На компьютерах под управлением Windows Server 2003 мастер блокировки IIS устанавливать не нужно, поскольку эта функция уже встроена. |

#### Проблема 2: Отсутствие поддержки изменения конфигурации WSUS непосредственно в базе данных

Служба WSUS сохраняет свои данные конфигурации в базе данных (либо MSDE, либо SQL Server). Тем не менее, изменение этих данных конфигурации через прямой доступ в базу данных не поддерживается. Администраторам не следует пытаться изменять конфигурацию WSUS таким способом. Поддерживаемым способом изменения конфигурации WSUS является использование консоли WSUS или вызов API-интерфейсов WSUS.

#### Проблема 3: Для доступа к узлу администрирования WSUS необходимо включить активные сценарии

Чтобы использовать Internet Explorer для доступа к узлу администрирования WSUS, следует на рабочей станции администратора настроить Internet Explorer на разрешение активных сценариев.

#### Проблема 4: Перезапуск службы IIS во время установки WSUS

Программа установки WSUS перезапустит IIS без уведомления. Это может повлиять на существующие веб-узлы внутри организации.

#### Проблема 5: Изменение доступа к виртуальным каталогам через точки управления WSUS или SMS

По умолчанию виртуальный каталог содержимого для WSUS настроен на анонимный доступ. Если изменить эту настройку на доступ с обязательной проверкой подлинности, клиенты будут получать сообщения об ошибках проверки подлинности и не будут иметь доступа к загрузке обновлений. Эта же проблема возникает, когда Winhttp.dll использует неверный контекст в условиях неявной проверки подлинности, так что проверить подлинность не удается. Чтобы избежать этой проблемы, убедитесь, что точки управления WSUS-сервера и SMS настроены с анонимным доступом к виртуальным каталогам IIS.

#### Проблема 6: При установке WSUS на компьютеры с ОС Windows Small Business Server 2003 следует изменить настройки доступа к виртуальным корневым папкам WSUS веб-узла по умолчанию, чтобы включить самообновление клиентов WSUS с сервера

Данный WSUS-сервер устанавливает две виртуальные корневые папки, SelfUpdate и ClientWebService, и несколько файлов в корневом каталоге документов веб-узла по умолчанию (на порте 80). Это позволяет клиентам самообновляться через данный веб-узел по умолчанию. По умолчанию на Windows Small Business Server 2003 веб-узел по умолчанию отказывает в доступе любым IP-адресам или локальным узлам, кроме тех, которые размещены на этом сервере. Это означает, что виртуальные корневые папки SelfUpdate и ClientWebService будут недоступны, и клиенты не будут самообновляться. Чтобы предоставить доступ клиентам для самообновления, выполните следующие действия с виртуальными корневыми папками SelfUpdate и ClientWebService веб-узла по умолчанию.

1.  Щелкните виртуальную корневую папку **Свойства**, откройте вкладку **Безопасность каталога**, выберите **Ограничение доступа по IP-адресу или доменному имени** нажмите **Изменить**.
2.  Выберите **Открыть доступ** и нажмите кнопку **OK**. Закройте все страницы свойств.

#### Проблема 7: Установка WSUS на Small Business Server - проблемы интеграции

-   Если для доступа к Интернету Windows Small Business Server 2003 использует прокси-сервер ISA, в пользовательском интерфейсе **Параметры** потребуется вручную ввести следующие данные: параметры прокси-сервера, имя прокси-сервера и порт.
-   Если ISA использует проверку подлинности Windows, учетные данные прокси-сервера следует вводить в формате "ДОМЕН\\пользователь" (пользователь относится к группе "Пользователи Интернета").

#### Проблема 8: Если компьютер переводится из одной группы компьютеров в другую, может потребоваться до одного часа, чтобы этот компьютер появился в новой группе на консоли администрирования

Если компьютер назначается в конечную группу впервые, данные на этом компьютере изменяются под влиянием данных группы. Эти данные обновляются периодически или ежечасно. Поэтому при переводе компьютера из одной группы компьютеров в другую, может потребоваться до одного часа, чтобы клиент обновил эти данные и они появились как измененные в консоли администрирования WSUS.

#### Проблема 9: Если служба WSUS установлена на рядовой сервер, и этот рядовой сервер необходимо повысить до уровня контроллера домена, следует сначала удалить WSUS

Если служба WSUS установлена на рядовой сервер, и этот рядовой сервер необходимо повысить до уровня контроллера домена, потребуется выполнить следующие действия:

1.  Удалите WSUS.
2.  Повысьте сервер до уровня контроллера домена.
3.  Заново установите WSUS.

#### Проблема 10: Если необходимо понизить WSUS-сервер с уровня контроллера домена до рядового сервера, следует сначала удалить WSUS

Если WSUS-сервер используется на контроллере домена, и необходимо понизить контроллер домена до уровня рядового сервера, потребуется выполнить следующие действия:

1.  Удалите WSUS и сохраните базу данных.
2.  Создайте учетную запись пользователя ASPNET.
3.  В командной строке введите **aspnet\_regiis -i**.
4.  Заново установите WSUS и используйте сохраненную базу данных.

#### Проблема 11: Если .NET Framework 1.0 или 2.0 устанавливается после установки WSUS, консоль администрирования WSUS не появляется

Это вызывается тем, что с IIS регистрируется .NET Framework 1.0, а для WSUS-сервера требуется .NET Framework 1.1. Чтобы решить эту проблему, откройте aspnet\_regiis.exe и запустите указанные ниже команды, в которых *website id* – это значение, содержащееся в следующем разделе реестра:

HKLM\\Software\\Microsoft\\WindowsUpdateServices\\Server\\Setup\\IISTargetWebsiteIndex

-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\ReportingWebService
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\ClientWebService
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\SimpleAuthWebService
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\WSUSAdmin
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\AdministrationWebService
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\ServrSyncWebService
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\DssAuthWebService
-   %windir%\\Microsoft.NET\\Framework\\v1.1.4322\\\\aspnet\_regiis.exe -s W3SVC\\&lt;*website id*&gt;\\ROOT\\Content

#### Проблема 12: Ограничения в использовании удаленного SQL Server

WSUS предоставляет ограниченную поддержку для использования программного обеспечения базы данных на каком-либо компьютере, отделенном от компьютера с остальной частью приложения WSUS.

-   Windows 2000 Server невозможно использовать на внешнем компьютере в удаленной паре SQL.
-   Сервер, настроенный как контроллер домена, невозможно использовать в качестве сервера переднего или заднего плана в удаленной паре SQL.
-   WMSDE или MSDE невозможно использовать для программного обеспечения базы данных на внутреннем компьютере.
-   Не удается установить удаленный SQL Server (для использования в качестве базы данных WSUS), если службы терминалов установлены на удаленном сервере и работают в режиме приложений. При установке SQL Server на сервер служб терминалов, необходимо выполнить следующие действия:
    1.  Перед запуском программы установки, откройте окно командной строки и введите: "change user /install"
    2.  Запустите программу установки SQL Server.
    3.  После выполнения программы установки, в командной строке введите: "change user /execute"
-   Чтобы настроить базу данных WSUS на удаленном сервере SQL Server, следует быть членом локальной группы безопасности "Администраторы" как на внешнем, так и на внутреннем компьютере.
-   Дополнительные сведения о проблемах с использованием удаленного SQL Server см. в документе "Приложение В: Удаленный SQL Server" в разделе [Развертывание службы Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=41777).

#### Проблема 13: Нижестоящий сервер с копиями может иметь меньше утверждений, чем родительский вышестоящий сервер

Нижестоящий сервер с копиями может иметь меньше утверждений, чем родительский вышестоящий сервер. Это вызвано тем, что утверждения установки не передаются на нижестоящий сервер, пока не закончится загрузка содержимого на вышестоящий сервер.

#### Проблема 14: После первого сбоя синхронизации необходимо повторить попытку

Если не удается выполнить синхронизацию, перед устранением неполадок прежде всего попытайтесь синхронизировать сервер еще раз. Если последующие попытки синхронизации тоже не удаются, используйте сведения об устранении неполадок в руководстве по использованию службы WSUS.

#### Проблема 15: При попытке доступа к консоли администрирования WSUS появляется сообщение об ошибке "System.IO.FileNotFoundException"

Если появляется следующее сообщение об ошибке, может потребоваться настройка разрешений в учетных записях сетевой службы или ASP.NET:

System.IO.FileNotFoundException: Не найден файл или сборка под именем *xxxxxx*.dll или один из зависимых компонентов

Где *xxxx* – это произвольное имя.

Чтобы решить эту проблему в ОС Windows Server 2003, предоставьте учетной записи сетевой службы доступ для чтения-записи к папке %systemroot%\\Temp. В Windows 2000 Server, предоставьте учетной записи службы ASP.NET доступ для чтения-записи к папке %systemroot%\\Temp.

#### Проблема 16: Обновление MS03-031 (KB815495) для системы безопасности SQL

Это обновление может отображаться на WSUS-сервере как установленное, хотя на самом деле выполнить установку на клиенте не удалось. В результате этот пакет может предлагаться клиенту повторно. Эту проблему можно обойти, отменив утверждение этого обновления на данном сервере.

#### Проблема 17: Настройки службы IIS утрачиваются в ходе обновления окончательной первоначальной версии (RTM).

Если окончательная первоначальная версия (RTM) WSUS устанавливается на сервер с предыдущей версией WSUS (например, RC), WSUS RTM удалит старую версию и затем установит новую. Это означает, что виртуальные корневые папки и файлы IIS, связанные с WSUS, будут удалены.

Если служба WSUS была установлена на веб-узел по умолчанию, будут потеряны все связанные с WSUS настройки, выполненные в виртуальных корневых папках WSUS. Например, если в целях защиты виртуальные корневые папки службы WSUS были настроены на протокол SSL, после установки окончательной первоначальной версии (RTM) WSUS потребуется настроить их снова. Примечание: консоль WSUS уведомит о том, что протокол SSL не включен.

Если служба WSUS была установлена на веб-узел, не являющийся веб-узлом по умолчанию, все дополнительные настройки на веб-узле WSUS утрачиваются.

#### Проблема 18: Использование заголовков узла

Если для веб-узла по умолчанию (веб-узла WSUS) в службе IIS нужно назначить значения заголовка узла, потребуется добавить “Все неназначенные” или какой-либо назначенный IP-адрес в список IP-адресов, не указывая значение заголовка узла для веб-узла по умолчанию. Это добавление следует выполнить и для веб-узла не по умолчанию

**Внимание!** Это может прервать выполнение функций Microsoft SharePoint и Exchange.

#### Проблема 19: URL-адрес консоли WSUS необходимо добавить в список зон веб-содержимого "Надежные узлы" и "Местная интрасеть" на компьютерах с включенным усилением защиты Internet Explorer

Если на компьютере включено усиление защиты Internet Explorer (известное также как компонент конфигурации усиленной безопасности Internet Explorer в Microsoft Windows Server 2003), а консоль WSUS не добавлена к зонам веб-содержимого "Надежные узлы" и "Местная интрасеть", то при каждом открытии страницы в консоли WSUS будут запрашиваться учетные данные пользователя.

Чтобы добавить консоль WSUS к зонам веб-содержимого **Местная интрасеть** и **Надежные узлы**:

1.  Откройте **Свойства обозревателя** (например, нажмите кнопку **Пуск**, выберите **Панель управления** и щелкните **Свойства обозревателя**).
2.  На вкладке **Безопасность** щелкните **Местная интрасеть**, нажмите **Узлы**, нажмите **Дополнительно**, добавьте URL-адрес (http://*WSUSServername*/WSUSAdmin) и затем нажмите кнопку **OK**.
3.  Щелкните **Надежные узлы**, нажмите **Узлы**, добавьте URL-адрес консоли WSUS, нажмите кнопку **OK** и затем еще раз **OK**, чтобы закрыть **Свойства обозревателя**.

#### Copyright

Информация данного документа отражает текущее представление корпорации Майкрософт о проблемах, обсуждаемых на момент публикации. Поскольку корпорация Майкрософт должна соответствовать условиям меняющегося рынка, не следует интерпретировать это как часть обязательств Майкрософт, и Майкрософт не может гарантировать точность информации, представленной на дату публикации.

Назначение данного документа исключительно информационное. КОРПОРАЦИЯ МАЙКРОСОФТ НЕ ПРЕДОСТАВЛЯЕТ НИКАКИХ ГАРАНТИЙ, ВЫРАЖЕННЫХ, ПОДРАЗУМЕВАЕМЫХ ИЛИ ПРЕДУСМОТРЕННЫХ ЗАКОНОМ ОТНОСИТЕЛЬНО ИНФОРМАЦИИ ЭТОГО ДОКУМЕНТА.

Ответственность за соблюдение всех применимых в данном случае законов об авторском праве лежит на пользователе. В рамках, предусмотренных законами об авторских правах, никакая часть настоящего документа не может быть воспроизведена, сохранена или представлена в какой-либо системе хранения данных или передана в какой бы то ни было форме, какими бы то ни было средствами (электронными, механическими, фотокопировальными, записывающими или иными) и в каких бы то ни было целях без специального письменного разрешения корпорации Майкрософт.

Корпорация Майкрософт может являться правообладателем патентов и заявок, поданных на получение патента, товарных знаков и прочих объектов авторского права, которые могут иметь отношение к содержанию данного документа. Предоставление вам данного документа не означает передачи какой-либо лицензии на использование данных патентов, товарных знаков и объектов авторского права, за исключением использования, явно оговоренного в лицензионном соглашении корпорации Майкрософт.

Если не указано иное, компании, организации, продукты, доменные имена, адреса электронной почты, эмблемы, люди, места и события, используемые в качестве примеров в этом документе, являются вымышленными и не имеют отношения к существующим компаниям, организациям, продуктам, доменным именам, адресам электронной почты, эмблемам, людям, местам и событиям.

© Корпорация Майкрософт (Microsoft Corporation), 2006. Все права защищены.

Microsoft, SQL Server, Windows и Windows Server являются охраняемыми товарными знаками корпорации Майкрософт в США и/или других странах.

Названия реальных компаний и изделий являются товарными знаками соответствующих владельцев.
